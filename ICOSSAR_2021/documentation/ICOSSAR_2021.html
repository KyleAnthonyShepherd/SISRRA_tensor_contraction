<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 8.1.0" />
    <title>ICOSSAR_2021 API documentation</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2264%22%20height%3D%2264%22%20viewBox%3D%2244.5%202.5%2015%2015%22%3E%3Cpath%20d%3D%22M49.351%2021.041c-.233-.721-.546-2.408-.772-4.076-.042-.09-.067-.187-.046-.288-.166-1.347-.277-2.625-.241-3.351-1.378-1.008-2.271-2.586-2.271-4.362%200-.976.272-1.935.788-2.774.057-.094.122-.18.184-.268-.033-.167-.052-.339-.052-.516%200-1.477%201.202-2.679%202.679-2.679.791%200%201.496.352%201.987.9a6.3%206.3%200%200%201%201.001.029c.492-.564%201.207-.929%202.012-.929%201.477%200%202.679%201.202%202.679%202.679a2.65%202.65%200%200%201-.269%201.148c.383.747.595%201.572.595%202.41%200%202.311-1.507%204.29-3.635%205.107.037.699.147%202.27.423%203.294l.137.461c.156%202.136-4.612%205.166-5.199%203.215zm.127-4.919a4.78%204.78%200%200%200%20.775-.584c-.172-.115-.505-.254-.88-.378zm.331%202.302l.828-.502c-.202-.143-.576-.328-.984-.49zm.45%202.157l.701-.403c-.214-.115-.536-.249-.891-.376l.19.779zM49.13%204.141c0%20.152.123.276.276.276s.275-.124.275-.276-.123-.276-.276-.276-.275.124-.275.276zm.735-.389a1.15%201.15%200%200%201%20.314.783%201.16%201.16%200%200%201-1.162%201.162c-.457%200-.842-.27-1.032-.653-.026.117-.042.238-.042.362a1.68%201.68%200%200%200%201.679%201.679%201.68%201.68%200%200%200%201.679-1.679c0-.843-.626-1.535-1.436-1.654zm3.076%201.654a1.68%201.68%200%200%200%201.679%201.679%201.68%201.68%200%200%200%201.679-1.679c0-.037-.009-.072-.011-.109-.21.3-.541.508-.935.508a1.16%201.16%200%200%201-1.162-1.162%201.14%201.14%200%200%201%20.474-.912c-.015%200-.03-.005-.045-.005-.926.001-1.679.754-1.679%201.68zm1.861-1.265c0%20.152.123.276.276.276s.275-.124.275-.276-.123-.276-.276-.276-.275.124-.275.276zm1.823%204.823c0-.52-.103-1.035-.288-1.52-.466.394-1.06.64-1.717.64-1.144%200-2.116-.725-2.499-1.738-.383%201.012-1.355%201.738-2.499%201.738-.867%200-1.631-.421-2.121-1.062-.307.605-.478%201.267-.478%201.942%200%202.486%202.153%204.51%204.801%204.51s4.801-2.023%204.801-4.51zm-3.032%209.156l-.146-.492c-.276-1.02-.395-2.457-.444-3.268a6.11%206.11%200%200%201-1.18.115%206.01%206.01%200%200%201-2.536-.562l.006.175c.802.215%201.848.612%202.021%201.25.079.295-.021.601-.274.837l-.598.501c.667.304%201.243.698%201.311%201.179.02.144.022.507-.393.787l-.564.365c1.285.521%201.361.96%201.381%201.126.018.142.011.496-.427.746l-.854.489c.064-1.19%201.985-2.585%202.697-3.248zM49.34%209.925c0-.667%201-.667%201%200%200%20.653.818%201.205%201.787%201.205s1.787-.552%201.787-1.205c0-.667%201-.667%201%200%200%201.216-1.25%202.205-2.787%202.205s-2.787-.989-2.787-2.205zm-.887-7.633c-.093.077-.205.114-.317.114a.5.5%200%200%201-.318-.886L49.183.397a.5.5%200%200%201%20.703.068.5.5%200%200%201-.069.703zm7.661-.065c-.086%200-.173-.022-.253-.068l-1.523-.893c-.575-.337-.069-1.2.506-.863l1.523.892a.5.5%200%200%201%20.179.685c-.094.158-.261.247-.432.247z%22%20fill%3D%22%233bb300%22/%3E%3C/svg%3E"/>


<style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
<style>/*! pygments syntax highlighting */pre{line-height:125%;}td.linenos pre{color:#000000; background-color:#f0f0f0; padding-left:5px; padding-right:5px;}span.linenos{color:#000000; background-color:#f0f0f0; padding-left:5px; padding-right:5px;}td.linenos pre.special{color:#000000; background-color:#ffffc0; padding-left:5px; padding-right:5px;}span.linenos.special{color:#000000; background-color:#ffffc0; padding-left:5px; padding-right:5px;}.pdoc .hll{background-color:#ffffcc}.pdoc{background:#f8f8f8;}.pdoc .c{color:#408080; font-style:italic}.pdoc .err{border:1px solid #FF0000}.pdoc .k{color:#008000; font-weight:bold}.pdoc .o{color:#666666}.pdoc .ch{color:#408080; font-style:italic}.pdoc .cm{color:#408080; font-style:italic}.pdoc .cp{color:#BC7A00}.pdoc .cpf{color:#408080; font-style:italic}.pdoc .c1{color:#408080; font-style:italic}.pdoc .cs{color:#408080; font-style:italic}.pdoc .gd{color:#A00000}.pdoc .ge{font-style:italic}.pdoc .gr{color:#FF0000}.pdoc .gh{color:#000080; font-weight:bold}.pdoc .gi{color:#00A000}.pdoc .go{color:#888888}.pdoc .gp{color:#000080; font-weight:bold}.pdoc .gs{font-weight:bold}.pdoc .gu{color:#800080; font-weight:bold}.pdoc .gt{color:#0044DD}.pdoc .kc{color:#008000; font-weight:bold}.pdoc .kd{color:#008000; font-weight:bold}.pdoc .kn{color:#008000; font-weight:bold}.pdoc .kp{color:#008000}.pdoc .kr{color:#008000; font-weight:bold}.pdoc .kt{color:#B00040}.pdoc .m{color:#666666}.pdoc .s{color:#BA2121}.pdoc .na{color:#7D9029}.pdoc .nb{color:#008000}.pdoc .nc{color:#0000FF; font-weight:bold}.pdoc .no{color:#880000}.pdoc .nd{color:#AA22FF}.pdoc .ni{color:#999999; font-weight:bold}.pdoc .ne{color:#D2413A; font-weight:bold}.pdoc .nf{color:#0000FF}.pdoc .nl{color:#A0A000}.pdoc .nn{color:#0000FF; font-weight:bold}.pdoc .nt{color:#008000; font-weight:bold}.pdoc .nv{color:#19177C}.pdoc .ow{color:#AA22FF; font-weight:bold}.pdoc .w{color:#bbbbbb}.pdoc .mb{color:#666666}.pdoc .mf{color:#666666}.pdoc .mh{color:#666666}.pdoc .mi{color:#666666}.pdoc .mo{color:#666666}.pdoc .sa{color:#BA2121}.pdoc .sb{color:#BA2121}.pdoc .sc{color:#BA2121}.pdoc .dl{color:#BA2121}.pdoc .sd{color:#BA2121; font-style:italic}.pdoc .s2{color:#BA2121}.pdoc .se{color:#BB6622; font-weight:bold}.pdoc .sh{color:#BA2121}.pdoc .si{color:#BB6688; font-weight:bold}.pdoc .sx{color:#008000}.pdoc .sr{color:#BB6688}.pdoc .s1{color:#BA2121}.pdoc .ss{color:#19177C}.pdoc .bp{color:#008000}.pdoc .fm{color:#0000FF}.pdoc .vc{color:#19177C}.pdoc .vg{color:#19177C}.pdoc .vi{color:#19177C}.pdoc .vm{color:#19177C}.pdoc .il{color:#666666}</style>
<style>/*! pdoc */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f7f7f7;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}body{background-color:var(--pdoc-background);}html, body{width:100%;height:100%;}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}.git-button{display:none !important;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}#navtoggle{display:none;}}#togglestate{display:none;}nav.pdoc{--pad:1.75rem;--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc li{display:block;margin:0;padding:.2rem 0 .2rem var(--indent);transition:all 100ms;}nav.pdoc > div > ul > li{padding-left:0;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}html, main{scroll-behavior:smooth;}.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{background-color:var(--code);border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.pdoc details{--shift:-40px;text-align:right;margin-top:var(--shift);margin-bottom:calc(0px - var(--shift));clear:both;filter:opacity(1);}.pdoc details:not([open]){height:0;overflow:visible;}.pdoc details > summary{font-size:.75rem;cursor:pointer;color:var(--muted);border-width:0;padding:0 .7em;display:inline-block;display:inline list-item;user-select:none;}.pdoc details > summary:focus{outline:0;}.pdoc details > div{margin-top:calc(0px - var(--shift) / 2);text-align:left;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc > section:first-of-type > .docstring{margin-bottom:3rem;}.pdoc .docstring pre{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc .headerlink{position:absolute;width:0;margin-left:-1.5rem;line-height:1.4rem;font-size:1.5rem;font-weight:normal;transition:all 100ms ease-in-out;opacity:0;}.pdoc .attr > .headerlink{margin-left:-2.5rem;}.pdoc *:hover > .headerlink,.pdoc *:target > .attr > .headerlink{opacity:1;}.pdoc .attr{display:block;color:var(--text);margin:1rem 0 .5rem;padding:.4rem 5rem .4rem 1rem;background-color:var(--accent);}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{white-space:pre-wrap;}.pdoc .annotation{color:var(--annotation);}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
</head>
<body>        <nav class="pdoc">
            <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
            <input id="togglestate" type="checkbox">
            <div>
                        <a class="pdoc-button module-list-button" href="index.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                            &nbsp;
                            Module Index
                        </a>


                        <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                               pattern=".+" required>

                    <h2>Contents</h2>
                    <ul>
  <li><a href="#author">Author</a></li>
</ul>


                    <h2>Submodules</h2>
                    <ul>
                            <li><a href="ICOSSAR_2021/tree_width.html">ICOSSAR_2021.tree_width</a></li>
                            <li><a href="ICOSSAR_2021/ATRnumbaTrie.html">ICOSSAR_2021.ATRnumbaTrie</a></li>
                            <li><a href="ICOSSAR_2021/ContractionOrdering.html">ICOSSAR_2021.ContractionOrdering</a></li>
                            <li><a href="ICOSSAR_2021/ICOSSAR_2021_analysis.html">ICOSSAR_2021.ICOSSAR_2021_analysis</a></li>
                            <li><a href="ICOSSAR_2021/cubic_graph_utilities.html">ICOSSAR_2021.cubic_graph_utilities</a></li>
                            <li><a href="ICOSSAR_2021/general_utilities.html">ICOSSAR_2021.general_utilities</a></li>
                            <li><a href="ICOSSAR_2021/generate_figures.html">ICOSSAR_2021.generate_figures</a></li>
                            <li><a href="ICOSSAR_2021/reliability.html">ICOSSAR_2021.reliability</a></li>
                            <li><a href="ICOSSAR_2021/script.html">ICOSSAR_2021.script</a></li>
                            <li><a href="ICOSSAR_2021/setup.html">ICOSSAR_2021.setup</a></li>
                            <li><a href="ICOSSAR_2021/tensor_network_contraction.html">ICOSSAR_2021.tensor_network_contraction</a></li>
                    </ul>

                    <h2>API Documentation</h2>
                        <ul class="memberlist">
            <li>
                    <a class="module" href="#tree_width">tree_width</a>
            </li>
            <li>
                    <a class="module" href="#ATRnumbaTrie">ATRnumbaTrie</a>
            </li>
            <li>
                    <a class="module" href="#ContractionOrdering">ContractionOrdering</a>
            </li>
            <li>
                    <a class="module" href="#ICOSSAR_2021_analysis">ICOSSAR_2021_analysis</a>
            </li>
            <li>
                    <a class="module" href="#cubic_graph_utilities">cubic_graph_utilities</a>
            </li>
            <li>
                    <a class="module" href="#general_utilities">general_utilities</a>
            </li>
            <li>
                    <a class="module" href="#generate_figures">generate_figures</a>
            </li>
            <li>
                    <a class="module" href="#reliability">reliability</a>
            </li>
            <li>
                    <a class="module" href="#script">script</a>
            </li>
            <li>
                    <a class="module" href="#setup">setup</a>
            </li>
            <li>
                    <a class="module" href="#tensor_network_contraction">tensor_network_contraction</a>
            </li>
    </ul>



                    <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev">
                        built with <span class="visually-hidden">pdoc</span><img
                            alt="pdoc logo"
                            src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
                    </a>
            </div>
        </nav>
    <main class="pdoc">
            <section>
                    <h1 class="modulename">
ICOSSAR_2021    </h1>

                        <div class="docstring"><p>This package contains the code I used to generate the ICOSSAR paper</p>

<h6 id="author">Author</h6>

<p>Kyle Shepherd, at Rice University</p>

<p>kas20@rice.edu</p>
</div>

                        <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">This package contains the code I used to generate the ICOSSAR paper</span>

<span class="sd">Author</span>
<span class="sd">------</span>
<span class="sd">Kyle Shepherd, at Rice University</span>

<span class="sd">kas20@rice.edu</span>
<span class="sd">&#39;&#39;&#39;</span>


<span class="kn">from</span> <span class="nn">setuptools</span> <span class="kn">import</span> <span class="n">find_packages</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pkgutil</span>

<span class="n">folder</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
<span class="n">__all__</span> <span class="o">=</span> <span class="n">find_packages</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span>
<span class="n">modules</span><span class="o">=</span><span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">pkgutil</span><span class="o">.</span><span class="n">iter_modules</span><span class="p">([</span><span class="n">folder</span><span class="p">])]</span>
<span class="n">__all__</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">modules</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="o">*</span>
<span class="k">except</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>

        </details>

            </section>
                <section id="tree_width">
                                <div class="attr module"><a class="headerlink" href="#tree_width">#&nbsp;&nbsp</a>
<span class="name"><a href="ICOSSAR_2021/tree_width.html">ICOSSAR_2021.tree_width</a></span></div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">setuptools</span> <span class="kn">import</span> <span class="n">find_packages</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pkgutil</span>

<span class="n">folder</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
<span class="n">__all__</span> <span class="o">=</span> <span class="n">find_packages</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span>
<span class="n">modules</span><span class="o">=</span><span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">pkgutil</span><span class="o">.</span><span class="n">iter_modules</span><span class="p">([</span><span class="n">folder</span><span class="p">])]</span>
<span class="n">__all__</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">modules</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="o">*</span>
<span class="k">except</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>

        </details>

    

                </section>
                <section id="ATRnumbaTrie">
                                <div class="attr module"><a class="headerlink" href="#ATRnumbaTrie">#&nbsp;&nbsp</a>
<span class="name"><a href="ICOSSAR_2021/ATRnumbaTrie.html">ICOSSAR_2021.ATRnumbaTrie</a></span></div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">This module calculates the all terminal reliability of undirected graphs</span>

<span class="sd">Functions</span>
<span class="sd">---------</span>
<span class="sd">**ATR(EdgeList,EP,verbose=False,TrieHashThreshold=10) :**  </span>
<span class="sd">    Calculates the All Terminal Reliability of a undirected graph defined by EdgeList.</span>

<span class="sd">Notes</span>
<span class="sd">-----</span>
<span class="sd">When these functions are first executed, numba performs jit compilation. This causes the first execution to take several seconds to run, but the compilation is cached and future runs with different inputs do not need to recompile.</span>

<span class="sd">Currently just for All Terminal Reliability. K-Terminal Reliability can be implemented in the future.</span>

<span class="sd">Examples</span>
<span class="sd">--------</span>
<span class="sd">&gt;&gt;&gt; import ATRnumbaTrie</span>
<span class="sd">&gt;&gt;&gt; n=5</span>
<span class="sd">&gt;&gt;&gt; EdgeList=[]</span>
<span class="sd">&gt;&gt;&gt; for k1 in range(0,n-1):</span>
<span class="sd">&gt;&gt;&gt;     for k2 in range(k1+1,n):</span>
<span class="sd">&gt;&gt;&gt;         EdgeList.append((k1,k2))</span>

<span class="sd">&gt;&gt;&gt; EdgeList=numpy.array(EdgeList)</span>
<span class="sd">&gt;&gt;&gt; EP=numpy.ones(EdgeList.shape[0])*.5</span>
<span class="sd">&gt;&gt;&gt; REL,SetixTotal,SetixMax=ATR(EdgeList,EP)</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">import</span> <span class="nn">sys</span>

<span class="kn">import</span> <span class="nn">math</span>

<span class="kn">import</span> <span class="nn">numpy</span>

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span>

<span class="c1"># JUST ASSUME ATR, and ASSUME FLOAT</span>

<span class="c1"># bi directional edges</span>
<span class="nd">@jit</span><span class="p">(</span><span class="n">nopython</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">cache</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">ATR</span><span class="p">(</span><span class="n">EdgeList</span><span class="p">,</span><span class="n">EP</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">TrieHashThreshold</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    The numba optimized function that calculates all terminal reliability (ATR) for an undirected graph defined by a list of edges.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    EdgeList : jx2 numpy array, int</span>
<span class="sd">        EdgeList[i,0] and EdgeList[i,0] are the labels of the head node and tail node of edge i. j is the number of edges in the graph. Labels must be consecutive from 0 to n-1, where n is the number of nodes in the graph. The algorithm factors the graph from edge 0 to edge j. An optimized edge ordering should be fed into this function.</span>

<span class="sd">    EP : 1D numpy array of size n, float</span>
<span class="sd">        EP[i] is the probability of edge i existing, probability of edge i not failing.</span>

<span class="sd">    verbose : bool</span>
<span class="sd">        Controls verbosity to console when the function is called</span>

<span class="sd">    TrieHashThreshold : int</span>
<span class="sd">        If the edge node set is equal to or exceeds this value, a hash table is used instead of a trie memory structure. The hash table is slower (due to collision checking), but takes up less memory.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    FinalProb : float</span>
<span class="sd">        The all terminal reliability of the graph.</span>

<span class="sd">    SetixTotal : int</span>
<span class="sd">        Total number of subgraphs considered in the algorithm</span>

<span class="sd">    SetixMax : int</span>
<span class="sd">        Maximum number of subgraphs considered in the algorithm at any one factoring step</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Currently just All Terminal Reliability. K-Terminal Reliability could be implemented.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; n=5</span>
<span class="sd">    &gt;&gt;&gt; EdgeList=[]</span>
<span class="sd">    &gt;&gt;&gt; for k1 in range(0,n-1):</span>
<span class="sd">    &gt;&gt;&gt;     for k2 in range(k1+1,n):</span>
<span class="sd">    &gt;&gt;&gt;         EdgeList.append((k1,k2))</span>

<span class="sd">    &gt;&gt;&gt; EdgeList=numpy.array(EdgeList)</span>
<span class="sd">    &gt;&gt;&gt; EP=numpy.ones(EdgeList.shape[0])*.5</span>
<span class="sd">    &gt;&gt;&gt; REL,SetixTotal,SetixMax=ATR(EdgeList,EP)</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="c1"># get number of nodes</span>
    <span class="c1"># assuming EdgeList is preprocessed</span>
    <span class="n">NN</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">EdgeList</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>

    <span class="n">Gworkspace</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">NN</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">NN</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span><span class="o">*-</span><span class="mi">1</span>
    <span class="n">Gcount</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">NN</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>

    <span class="c1"># set up graph connectivity</span>
    <span class="k">for</span> <span class="n">Edge</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">EdgeList</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">e0</span><span class="o">=</span><span class="n">EdgeList</span><span class="p">[</span><span class="n">Edge</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">e1</span><span class="o">=</span><span class="n">EdgeList</span><span class="p">[</span><span class="n">Edge</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">Gworkspace</span><span class="p">[</span><span class="n">e0</span><span class="p">,</span><span class="n">Gcount</span><span class="p">[</span><span class="n">e0</span><span class="p">]]</span><span class="o">=</span><span class="n">e1</span>
        <span class="n">Gcount</span><span class="p">[</span><span class="n">e0</span><span class="p">]</span><span class="o">=</span><span class="n">Gcount</span><span class="p">[</span><span class="n">e0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>
        <span class="n">Gworkspace</span><span class="p">[</span><span class="n">e1</span><span class="p">,</span><span class="n">Gcount</span><span class="p">[</span><span class="n">e1</span><span class="p">]]</span><span class="o">=</span><span class="n">e0</span>
        <span class="n">Gcount</span><span class="p">[</span><span class="n">e1</span><span class="p">]</span><span class="o">=</span><span class="n">Gcount</span><span class="p">[</span><span class="n">e1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>

    <span class="n">ExistingNodes</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">NN</span><span class="p">)</span>

    <span class="c1"># Trie data structure</span>
    <span class="n">Setlen</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">Setix</span><span class="o">=</span><span class="mi">1</span>
    <span class="n">SetixTotal</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">SetixMax</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">Setix0</span><span class="o">=</span><span class="mi">2</span>
    <span class="n">InitSize</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">Trie</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">InitSize</span><span class="p">,</span><span class="n">Setlen</span><span class="o">+</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span><span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
    <span class="n">SetStorage0</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">InitSize</span><span class="p">,(</span><span class="n">Setlen</span><span class="p">)</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span><span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span>
    <span class="n">SetP0</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">InitSize</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

    <span class="c1"># Hash data structure</span>
    <span class="n">HashTable</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">InitSize</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
    <span class="n">LLix</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">InitSize</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span><span class="o">*-</span><span class="mi">1</span>

    <span class="c1"># define first set</span>
    <span class="n">SetStorage0</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">SetP0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>

    <span class="c1"># Node to ID vect</span>
    <span class="c1"># Used for Trie tracking</span>
    <span class="n">NodeTTrieIx</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">NN</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span><span class="o">*-</span><span class="mi">1</span>
    <span class="n">NodeTTrieIx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>

    <span class="c1"># Path Edge Set</span>
    <span class="n">PathEdgeSet</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NN</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
    <span class="n">PathEdgeSet</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>

    <span class="c1"># Main loop</span>
    <span class="k">for</span> <span class="n">Edge</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">EdgeList</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">Edge</span><span class="p">)</span>
        <span class="n">ee</span><span class="o">=</span><span class="n">EdgeList</span><span class="p">[</span><span class="n">Edge</span><span class="p">,:]</span>

        <span class="c1"># connectivity check start node</span>
        <span class="n">StartNode</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NN</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">Gcount</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">StartNode</span><span class="o">=</span><span class="n">ix</span>
                <span class="c1"># ExistingNodeSum=ExistingNodeSum-1</span>

        <span class="c1"># make graph with edge e removed</span>
        <span class="n">cc</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Gcount</span><span class="p">[</span><span class="n">ee</span><span class="p">[</span><span class="mi">0</span><span class="p">]]):</span>
            <span class="k">if</span> <span class="n">Gworkspace</span><span class="p">[</span><span class="n">ee</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ix</span><span class="p">]</span><span class="o">!=</span><span class="n">ee</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">Gworkspace</span><span class="p">[</span><span class="n">ee</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">cc</span><span class="p">]</span><span class="o">=</span><span class="n">Gworkspace</span><span class="p">[</span><span class="n">ee</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ix</span><span class="p">]</span>
                <span class="n">cc</span><span class="o">=</span><span class="n">cc</span><span class="o">+</span><span class="mi">1</span>
        <span class="n">cc</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Gcount</span><span class="p">[</span><span class="n">ee</span><span class="p">[</span><span class="mi">1</span><span class="p">]]):</span>
            <span class="k">if</span> <span class="n">Gworkspace</span><span class="p">[</span><span class="n">ee</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">ix</span><span class="p">]</span><span class="o">!=</span><span class="n">ee</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">Gworkspace</span><span class="p">[</span><span class="n">ee</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">cc</span><span class="p">]</span><span class="o">=</span><span class="n">Gworkspace</span><span class="p">[</span><span class="n">ee</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">ix</span><span class="p">]</span>
                <span class="n">cc</span><span class="o">=</span><span class="n">cc</span><span class="o">+</span><span class="mi">1</span>

        <span class="n">ExistingNodeSum</span><span class="o">=</span><span class="n">NN</span>
        <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">NN</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">Gcount</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">ExistingNodeSum</span><span class="o">=</span><span class="n">ExistingNodeSum</span><span class="o">-</span><span class="mi">1</span>

        <span class="n">Gcount</span><span class="p">[</span><span class="n">ee</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">=</span><span class="n">Gcount</span><span class="p">[</span><span class="n">ee</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">-</span><span class="mi">1</span>
        <span class="n">Gcount</span><span class="p">[</span><span class="n">ee</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">=</span><span class="n">Gcount</span><span class="p">[</span><span class="n">ee</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">-</span><span class="mi">1</span>

        <span class="n">Gactive</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">Gworkspace</span><span class="p">)</span>
        <span class="n">GcountC</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">Gcount</span><span class="p">)</span>

        <span class="c1">#update edge set</span>
        <span class="c1"># keep track of added and removed nodes from the set</span>
        <span class="n">NewNode</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">PathEdgeSet</span><span class="p">[</span><span class="n">ee</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">PathEdgeSet</span><span class="p">[</span><span class="n">ee</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">=</span><span class="mi">1</span>
            <span class="n">NewNode</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">NewNode</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>
            <span class="n">NewNode</span><span class="p">[</span><span class="n">NewNode</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">=</span><span class="n">ee</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">PathEdgeSet</span><span class="p">[</span><span class="n">ee</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">PathEdgeSet</span><span class="p">[</span><span class="n">ee</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">=</span><span class="mi">1</span>
            <span class="n">NewNode</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">NewNode</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>
            <span class="n">NewNode</span><span class="p">[</span><span class="n">NewNode</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">=</span><span class="n">ee</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1"># RemovedNode=-1</span>
        <span class="n">RemovedNode</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NN</span><span class="p">)</span>
        <span class="c1"># ExistingNodeSum=NN</span>
        <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">NN</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">Gcount</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">PathEdgeSet</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
                <span class="n">RemovedNode</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
                <span class="c1"># ExistingNodeSum=ExistingNodeSum-1</span>

        <span class="c1"># update Node to ID vect</span>
        <span class="n">NodeTTrieIx</span><span class="p">[:]</span><span class="o">=-</span><span class="mi">1</span>
        <span class="n">Setlen</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">cc</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">StartNode</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NN</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">PathEdgeSet</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">NodeTTrieIx</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">=</span><span class="n">cc</span>
                <span class="n">cc</span><span class="o">=</span><span class="n">cc</span><span class="o">+</span><span class="mi">1</span>
                <span class="n">Setlen</span><span class="o">=</span><span class="n">Setlen</span><span class="o">+</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">StartNode</span><span class="o">=</span><span class="n">ix</span>

        <span class="c1"># create set handling array</span>
        <span class="n">Setworkspace</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Setlen</span><span class="o">+</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Setlen</span><span class="o">+</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
        <span class="n">Setworklen</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Setlen</span><span class="o">+</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
        <span class="n">Setmarked</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span>

        <span class="c1"># print(Setlen)</span>
        <span class="c1"># print(PathEdgeSet)</span>
        <span class="c1"># print(ee)</span>
        <span class="c1"># print(numpy.where(PathEdgeSet&gt;0))</span>
        <span class="c1"># input()</span>
        <span class="n">NewSet</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Setlen</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>

        <span class="c1"># create set storage arrays</span>
        <span class="n">Setix</span><span class="o">=</span><span class="mi">1</span>
        <span class="c1"># Tlen=1</span>
        <span class="c1"># TrieSize=(Setix0*2+1)</span>
        <span class="c1"># Trie=numpy.zeros((TrieSize,Setlen+1),dtype=numpy.int64)</span>
        <span class="n">SetStorage</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Setix0</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">,(</span><span class="n">Setlen</span><span class="p">)</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span><span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span>
        <span class="n">SetP</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Setix0</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

        <span class="c1"># SetThresh=0</span>
        <span class="k">if</span> <span class="n">Setlen</span><span class="o">&gt;</span><span class="n">TrieHashThreshold</span><span class="p">:</span>
            <span class="n">Tlen</span><span class="o">=</span><span class="mi">1</span>
            <span class="n">TrieSize</span><span class="o">=</span><span class="mi">1</span>
            <span class="n">Trie</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">TrieSize</span><span class="p">,</span><span class="n">Setlen</span><span class="o">+</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span><span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
            <span class="c1"># Hash storage arrays</span>
            <span class="n">HashTable</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Setix0</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mf">1.3</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span><span class="o">*-</span><span class="mi">1</span>
            <span class="n">LLix</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">Setix0</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span><span class="o">*-</span><span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Tlen</span><span class="o">=</span><span class="mi">1</span>
            <span class="n">TrieSize</span><span class="o">=</span><span class="p">(</span><span class="n">Setix0</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">Trie</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">TrieSize</span><span class="p">,</span><span class="n">Setlen</span><span class="o">+</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span><span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
            <span class="c1"># Hash storage arrays</span>
            <span class="n">HashTable</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span><span class="o">*-</span><span class="mi">1</span>
            <span class="n">LLix</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span><span class="o">*-</span><span class="mi">1</span>


        <span class="c1"># create connectivity check arrays</span>
        <span class="n">VisitedNodes</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NN</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
        <span class="n">NextNodes</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NN</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>

        <span class="c1"># get edge prob</span>
        <span class="n">EdgeProb</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">EP</span><span class="p">[</span><span class="n">Edge</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">Setlen</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">FinalProb</span><span class="o">=</span><span class="mi">0</span>
            <span class="c1"># print(SetStorage0[:Setix0,:])</span>
            <span class="c1"># print(SetP0[:Setix0])</span>
            <span class="k">for</span> <span class="n">zz</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Setix0</span><span class="p">):</span>
                <span class="n">Curset</span><span class="o">=</span><span class="n">SetStorage0</span><span class="p">[</span><span class="n">zz</span><span class="p">,:]</span>
                <span class="k">if</span> <span class="n">Curset</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">FinalProb</span><span class="o">=</span><span class="n">FinalProb</span><span class="o">+</span><span class="n">SetP0</span><span class="p">[</span><span class="n">zz</span><span class="p">]</span><span class="o">*</span><span class="n">EdgeProb</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">FinalProb</span><span class="o">=</span><span class="n">FinalProb</span><span class="o">+</span><span class="n">SetP0</span><span class="p">[</span><span class="n">zz</span><span class="p">]</span>
            <span class="c1"># print(&#39;FinalProb&#39;)</span>
            <span class="c1"># print(FinalProb)</span>
            <span class="c1"># print(&#39;Obtained All Terminal Reliability&#39;)</span>
            <span class="k">return</span> <span class="n">FinalProb</span><span class="p">,</span><span class="n">SetixTotal</span><span class="p">,</span><span class="n">SetixMax</span>

        <span class="c1"># Graph loop</span>
        <span class="k">for</span> <span class="n">zz</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Setix0</span><span class="p">):</span>
            <span class="c1"># print(SetStorage0)</span>
            <span class="n">Curset</span><span class="o">=</span><span class="n">SetStorage0</span><span class="p">[</span><span class="n">zz</span><span class="p">,:]</span>
            <span class="n">setProb</span><span class="o">=</span><span class="n">SetP0</span><span class="p">[</span><span class="n">zz</span><span class="p">]</span>
            <span class="c1"># Setworkspace[:]=0</span>
            <span class="n">Setworklen</span><span class="p">[:]</span><span class="o">=</span><span class="mi">0</span>
            <span class="n">Setmarked</span><span class="p">[:]</span><span class="o">=-</span><span class="mi">1</span>
            <span class="n">SetmarkedC</span><span class="o">=</span><span class="mi">0</span>
            <span class="c1"># Setmarked[0]=1</span>
            <span class="n">SetNum</span><span class="o">=</span><span class="mi">0</span>

            <span class="c1"># Gactive[:]=numpy.copy(Gworkspace)</span>
            <span class="c1"># Gactive[:]=Gworkspace[:]</span>
            <span class="n">GcountC</span><span class="p">[:]</span><span class="o">=</span><span class="n">Gcount</span><span class="p">[:]</span>

            <span class="c1"># read the set</span>
            <span class="c1"># print(&#39;set&#39;)</span>
            <span class="c1"># print(set)</span>
            <span class="n">Cnode</span><span class="o">=-</span><span class="mi">1</span>
            <span class="n">Mark0</span><span class="o">=</span><span class="kc">False</span>
            <span class="n">Mark1</span><span class="o">=</span><span class="kc">False</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Curset</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="n">ss</span><span class="o">=</span><span class="n">Curset</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">ss</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
                    <span class="n">Cnode</span><span class="o">=-</span><span class="mi">1</span>
                    <span class="k">if</span> <span class="n">Setworklen</span><span class="p">[</span><span class="n">SetNum</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                        <span class="c1"># advance to next set</span>
                        <span class="k">if</span> <span class="n">Mark0</span><span class="p">:</span>
                            <span class="n">Setmarked</span><span class="p">[</span><span class="n">SetmarkedC</span><span class="p">]</span><span class="o">=</span><span class="n">SetNum</span>
                            <span class="n">SetmarkedC</span><span class="o">=</span><span class="n">SetmarkedC</span><span class="o">+</span><span class="mi">1</span>
                        <span class="k">if</span> <span class="n">Mark1</span><span class="p">:</span>
                            <span class="n">Setmarked</span><span class="p">[</span><span class="n">SetmarkedC</span><span class="p">]</span><span class="o">=</span><span class="n">SetNum</span>
                            <span class="n">SetmarkedC</span><span class="o">=</span><span class="n">SetmarkedC</span><span class="o">+</span><span class="mi">1</span>

                        <span class="n">Setworkspace</span><span class="p">[</span><span class="n">SetNum</span><span class="p">,:</span><span class="n">Setworklen</span><span class="p">[</span><span class="n">SetNum</span><span class="p">]]</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
                        <span class="n">SetNum</span><span class="o">=</span><span class="n">SetNum</span><span class="o">+</span><span class="mi">1</span>
                    <span class="n">Mark0</span><span class="o">=</span><span class="kc">False</span>
                    <span class="n">Mark1</span><span class="o">=</span><span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># if first node seen in set</span>
                    <span class="k">if</span> <span class="n">Cnode</span><span class="o">==-</span><span class="mi">1</span><span class="p">:</span>
                        <span class="n">Cnode</span><span class="o">=</span><span class="n">ss</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># Add edge connecting nodes</span>
                        <span class="n">Gactive</span><span class="p">[</span><span class="n">Cnode</span><span class="p">,</span><span class="n">GcountC</span><span class="p">[</span><span class="n">Cnode</span><span class="p">]]</span><span class="o">=</span><span class="n">ss</span>
                        <span class="n">GcountC</span><span class="p">[</span><span class="n">Cnode</span><span class="p">]</span><span class="o">=</span><span class="n">Gcount</span><span class="p">[</span><span class="n">Cnode</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>
                        <span class="n">Gactive</span><span class="p">[</span><span class="n">ss</span><span class="p">,</span><span class="n">GcountC</span><span class="p">[</span><span class="n">ss</span><span class="p">]]</span><span class="o">=</span><span class="n">Cnode</span>
                        <span class="n">GcountC</span><span class="p">[</span><span class="n">ss</span><span class="p">]</span><span class="o">=</span><span class="n">GcountC</span><span class="p">[</span><span class="n">ss</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>

                    <span class="c1"># add to set workspace</span>
                    <span class="k">if</span> <span class="n">RemovedNode</span><span class="p">[</span><span class="n">ss</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="c1"># only if not a removed node</span>
                        <span class="n">Setworkspace</span><span class="p">[</span><span class="n">SetNum</span><span class="p">,</span><span class="n">Setworklen</span><span class="p">[</span><span class="n">SetNum</span><span class="p">]]</span><span class="o">=</span><span class="n">ss</span>
                        <span class="n">Setworklen</span><span class="p">[</span><span class="n">SetNum</span><span class="p">]</span><span class="o">=</span><span class="n">Setworklen</span><span class="p">[</span><span class="n">SetNum</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>
                        <span class="c1"># determine what sets to merge, due to contracted edge</span>
                    <span class="k">if</span> <span class="n">ss</span><span class="o">==</span><span class="n">ee</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                        <span class="c1"># Setmarked[0]=SetNum</span>
                        <span class="n">Mark0</span><span class="o">=</span><span class="kc">True</span>
                    <span class="k">if</span> <span class="n">ss</span><span class="o">==</span><span class="n">ee</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="c1"># Setmarked[1]=SetNum</span>
                        <span class="n">Mark1</span><span class="o">=</span><span class="kc">True</span>

            <span class="c1"># add new sets</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">NewNode</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="n">Setworkspace</span><span class="p">[</span><span class="n">SetNum</span><span class="p">,</span><span class="n">Setworklen</span><span class="p">[</span><span class="n">SetNum</span><span class="p">]]</span><span class="o">=</span><span class="n">NewNode</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">Setworklen</span><span class="p">[</span><span class="n">SetNum</span><span class="p">]</span><span class="o">=</span><span class="n">Setworklen</span><span class="p">[</span><span class="n">SetNum</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>
                <span class="c1"># Setmarked[1-k]=SetNum # Check this later</span>
                <span class="n">Setmarked</span><span class="p">[</span><span class="n">SetmarkedC</span><span class="p">]</span><span class="o">=</span><span class="n">SetNum</span>
                <span class="n">SetmarkedC</span><span class="o">=</span><span class="n">SetmarkedC</span><span class="o">+</span><span class="mi">1</span>
                <span class="n">SetNum</span><span class="o">=</span><span class="n">SetNum</span><span class="o">+</span><span class="mi">1</span>


            <span class="c1"># if edge is a loop, no disconnection chance</span>
            <span class="k">if</span> <span class="n">Setmarked</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">Setmarked</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="c1">## build new set for storage</span>
                <span class="n">ix</span><span class="o">=</span><span class="mi">0</span>
                <span class="n">NewSet</span><span class="p">[:]</span><span class="o">=-</span><span class="mi">1</span>
                <span class="c1"># get set order</span>
                <span class="n">SetSort</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">Setworkspace</span><span class="p">[:</span><span class="n">SetNum</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">SetNum</span><span class="p">):</span>
                    <span class="n">ID</span><span class="o">=</span><span class="n">SetSort</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                    <span class="n">NewSet</span><span class="p">[</span><span class="n">ix</span><span class="p">:</span><span class="n">ix</span><span class="o">+</span><span class="n">Setworklen</span><span class="p">[</span><span class="n">ID</span><span class="p">]]</span><span class="o">=</span><span class="n">Setworkspace</span><span class="p">[</span><span class="n">ID</span><span class="p">,:</span><span class="n">Setworklen</span><span class="p">[</span><span class="n">ID</span><span class="p">]]</span>
                    <span class="n">ix</span><span class="o">=</span><span class="n">ix</span><span class="o">+</span><span class="n">Setworklen</span><span class="p">[</span><span class="n">ID</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>


                <span class="k">if</span> <span class="n">Setlen</span><span class="o">&gt;</span><span class="n">TrieHashThreshold</span><span class="p">:</span>
                    <span class="c1"># GET HASH</span>
                    <span class="n">acc</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">2870177450012600261</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">vv</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Setlen</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">2</span><span class="p">)):</span>
                        <span class="n">acc</span><span class="o">=</span><span class="n">acc</span><span class="o">+</span><span class="n">numpy</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="n">NewSet</span><span class="p">[</span><span class="n">vv</span><span class="p">])</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">)</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">14029467366897019727</span><span class="p">)</span>
                        <span class="n">acc</span><span class="o">=</span><span class="p">((</span><span class="n">acc</span> <span class="o">&lt;&lt;</span> <span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">31</span><span class="p">))</span> <span class="o">|</span> <span class="p">(</span><span class="n">acc</span> <span class="o">&gt;&gt;</span> <span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">33</span><span class="p">)))</span>
                        <span class="n">acc</span><span class="o">=</span><span class="n">acc</span><span class="o">*</span><span class="mi">11400714785074694791</span>
                    <span class="n">acc</span> <span class="o">=</span> <span class="n">acc</span><span class="o">+</span><span class="p">(</span><span class="n">Setlen</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">^</span> <span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">2870177450012600261</span><span class="p">)</span> <span class="o">^</span> <span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">3527539</span><span class="p">))</span>
                    <span class="n">acc</span><span class="o">=</span><span class="n">acc</span><span class="o">%</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Setix0</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mf">1.3</span><span class="p">))</span>

                    <span class="k">if</span> <span class="n">HashTable</span><span class="p">[</span><span class="n">acc</span><span class="p">]</span><span class="o">==-</span><span class="mi">1</span><span class="p">:</span>
                        <span class="n">SetStorage</span><span class="p">[</span><span class="n">Setix</span><span class="p">,:]</span><span class="o">=</span><span class="n">NewSet</span>
                        <span class="n">SetP</span><span class="p">[</span><span class="n">Setix</span><span class="p">]</span><span class="o">=</span><span class="n">setProb</span>
                        <span class="n">HashTable</span><span class="p">[</span><span class="n">acc</span><span class="p">]</span><span class="o">=</span><span class="n">Setix</span>
                        <span class="n">Setix</span><span class="o">=</span><span class="n">Setix</span><span class="o">+</span><span class="mi">1</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">II0</span><span class="o">=</span><span class="n">HashTable</span><span class="p">[</span><span class="n">acc</span><span class="p">]</span>
                        <span class="k">while</span> <span class="n">II0</span><span class="o">!=-</span><span class="mi">1</span><span class="p">:</span>
                            <span class="n">II</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">II0</span><span class="p">)</span>
                            <span class="k">if</span> <span class="n">numpy</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">NewSet</span><span class="o">==</span><span class="n">SetStorage</span><span class="p">[</span><span class="n">II</span><span class="p">,:]):</span>
                                <span class="n">SetP</span><span class="p">[</span><span class="n">II</span><span class="p">]</span><span class="o">=</span><span class="n">SetP</span><span class="p">[</span><span class="n">II</span><span class="p">]</span><span class="o">+</span><span class="n">setProb</span>
                                <span class="k">break</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">II0</span><span class="o">=</span><span class="n">LLix</span><span class="p">[</span><span class="n">II</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">II0</span><span class="o">==-</span><span class="mi">1</span><span class="p">:</span>
                            <span class="n">SetStorage</span><span class="p">[</span><span class="n">Setix</span><span class="p">,:]</span><span class="o">=</span><span class="n">NewSet</span>
                            <span class="n">SetP</span><span class="p">[</span><span class="n">Setix</span><span class="p">]</span><span class="o">=</span><span class="n">setProb</span>
                            <span class="n">LLix</span><span class="p">[</span><span class="n">II</span><span class="p">]</span><span class="o">=</span><span class="n">Setix</span>
                            <span class="n">Setix</span><span class="o">=</span><span class="n">Setix</span><span class="o">+</span><span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Insert into Trie</span>
                    <span class="c1"># print(NewSet)</span>
                    <span class="n">Tix</span><span class="o">=</span><span class="mi">0</span>
                    <span class="k">for</span> <span class="n">vv</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Setlen</span><span class="o">*</span><span class="mi">2</span><span class="p">):</span>
                        <span class="n">ss</span><span class="o">=</span><span class="n">NewSet</span><span class="p">[</span><span class="n">vv</span><span class="p">]</span>
                        <span class="n">II</span><span class="o">=</span><span class="n">Trie</span><span class="p">[</span><span class="n">Tix</span><span class="p">,</span><span class="n">NodeTTrieIx</span><span class="p">[</span><span class="n">ss</span><span class="p">]]</span>
                        <span class="k">if</span> <span class="n">II</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                            <span class="n">SetStorage</span><span class="p">[</span><span class="n">Setix</span><span class="p">,:]</span><span class="o">=</span><span class="n">NewSet</span>
                            <span class="n">SetP</span><span class="p">[</span><span class="n">Setix</span><span class="p">]</span><span class="o">=</span><span class="n">setProb</span>
                            <span class="n">Trie</span><span class="p">[</span><span class="n">Tix</span><span class="p">,</span><span class="n">NodeTTrieIx</span><span class="p">[</span><span class="n">ss</span><span class="p">]]</span><span class="o">=-</span><span class="n">Setix</span>
                            <span class="n">Setix</span><span class="o">=</span><span class="n">Setix</span><span class="o">+</span><span class="mi">1</span>
                            <span class="k">break</span>

                        <span class="k">if</span> <span class="n">II</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">vv</span><span class="o">==</span><span class="n">Setlen</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                                <span class="n">SetP</span><span class="p">[</span><span class="o">-</span><span class="n">II</span><span class="p">]</span><span class="o">=</span><span class="n">SetP</span><span class="p">[</span><span class="o">-</span><span class="n">II</span><span class="p">]</span><span class="o">+</span><span class="n">setProb</span>
                                <span class="k">break</span>
                            <span class="n">InSet</span><span class="o">=</span><span class="n">SetStorage</span><span class="p">[</span><span class="o">-</span><span class="n">II</span><span class="p">,:]</span>
                            <span class="n">Trie</span><span class="p">[</span><span class="n">Tix</span><span class="p">,</span><span class="n">NodeTTrieIx</span><span class="p">[</span><span class="n">ss</span><span class="p">]]</span><span class="o">=</span><span class="n">Tlen</span>
                            <span class="n">Trie</span><span class="p">[</span><span class="n">Tlen</span><span class="p">,</span><span class="n">NodeTTrieIx</span><span class="p">[</span><span class="n">InSet</span><span class="p">[</span><span class="n">vv</span><span class="o">+</span><span class="mi">1</span><span class="p">]]]</span><span class="o">=</span><span class="n">II</span>
                            <span class="n">Tix</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">Tlen</span><span class="p">)</span>
                            <span class="n">Tlen</span><span class="o">=</span><span class="n">Tlen</span><span class="o">+</span><span class="mi">1</span>
                            <span class="c1"># lazy increase size of Trie</span>
                            <span class="k">if</span> <span class="n">Tlen</span><span class="o">&gt;=</span><span class="n">TrieSize</span><span class="p">:</span>
                                <span class="n">Trie</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Trie</span><span class="p">,</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">TrieSize</span><span class="p">,</span><span class="n">Setlen</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                                <span class="n">TrieSize</span><span class="o">=</span><span class="n">TrieSize</span><span class="o">*</span><span class="mi">2</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">Tix</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">II</span><span class="p">)</span>
                <span class="k">continue</span>

            <span class="c1"># if set to be contracted is empty due to deleted node</span>
            <span class="k">if</span> <span class="n">Setmarked</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==-</span><span class="mi">1</span> <span class="ow">or</span> <span class="n">Setmarked</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==-</span><span class="mi">1</span><span class="p">:</span>
                <span class="c1">## build new set for storage</span>
                <span class="n">ix</span><span class="o">=</span><span class="mi">0</span>
                <span class="n">NewSet</span><span class="p">[:]</span><span class="o">=-</span><span class="mi">1</span>
                <span class="c1"># get set order</span>
                <span class="n">SetSort</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">Setworkspace</span><span class="p">[:</span><span class="n">SetNum</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
                <span class="c1"># print(Setworkspace)</span>
                <span class="c1"># print(Setworklen)</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">SetNum</span><span class="p">):</span>
                    <span class="n">ID</span><span class="o">=</span><span class="n">SetSort</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                    <span class="c1"># print(ID)</span>
                    <span class="c1"># print(NewSet)</span>
                    <span class="n">NewSet</span><span class="p">[</span><span class="n">ix</span><span class="p">:</span><span class="n">ix</span><span class="o">+</span><span class="n">Setworklen</span><span class="p">[</span><span class="n">ID</span><span class="p">]]</span><span class="o">=</span><span class="n">Setworkspace</span><span class="p">[</span><span class="n">ID</span><span class="p">,:</span><span class="n">Setworklen</span><span class="p">[</span><span class="n">ID</span><span class="p">]]</span>
                    <span class="n">ix</span><span class="o">=</span><span class="n">ix</span><span class="o">+</span><span class="n">Setworklen</span><span class="p">[</span><span class="n">ID</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>


                <span class="k">if</span> <span class="n">Setlen</span><span class="o">&gt;</span><span class="n">TrieHashThreshold</span><span class="p">:</span>
                    <span class="c1"># GET HASH</span>
                    <span class="n">acc</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">2870177450012600261</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">vv</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Setlen</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">2</span><span class="p">)):</span>
                        <span class="n">acc</span><span class="o">=</span><span class="n">acc</span><span class="o">+</span><span class="n">numpy</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="n">NewSet</span><span class="p">[</span><span class="n">vv</span><span class="p">])</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">)</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">14029467366897019727</span><span class="p">)</span>
                        <span class="n">acc</span><span class="o">=</span><span class="p">((</span><span class="n">acc</span> <span class="o">&lt;&lt;</span> <span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">31</span><span class="p">))</span> <span class="o">|</span> <span class="p">(</span><span class="n">acc</span> <span class="o">&gt;&gt;</span> <span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">33</span><span class="p">)))</span>
                        <span class="n">acc</span><span class="o">=</span><span class="n">acc</span><span class="o">*</span><span class="mi">11400714785074694791</span>
                    <span class="n">acc</span> <span class="o">=</span> <span class="n">acc</span><span class="o">+</span><span class="p">(</span><span class="n">Setlen</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">^</span> <span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">2870177450012600261</span><span class="p">)</span> <span class="o">^</span> <span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">3527539</span><span class="p">))</span>
                    <span class="n">acc</span><span class="o">=</span><span class="n">acc</span><span class="o">%</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Setix0</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mf">1.3</span><span class="p">))</span>

                    <span class="k">if</span> <span class="n">HashTable</span><span class="p">[</span><span class="n">acc</span><span class="p">]</span><span class="o">==-</span><span class="mi">1</span><span class="p">:</span>
                        <span class="n">SetStorage</span><span class="p">[</span><span class="n">Setix</span><span class="p">,:]</span><span class="o">=</span><span class="n">NewSet</span>
                        <span class="n">SetP</span><span class="p">[</span><span class="n">Setix</span><span class="p">]</span><span class="o">=</span><span class="n">setProb</span><span class="o">*</span><span class="n">EdgeProb</span>
                        <span class="n">HashTable</span><span class="p">[</span><span class="n">acc</span><span class="p">]</span><span class="o">=</span><span class="n">Setix</span>
                        <span class="n">Setix</span><span class="o">=</span><span class="n">Setix</span><span class="o">+</span><span class="mi">1</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">II0</span><span class="o">=</span><span class="n">HashTable</span><span class="p">[</span><span class="n">acc</span><span class="p">]</span>
                        <span class="k">while</span> <span class="n">II0</span><span class="o">!=-</span><span class="mi">1</span><span class="p">:</span>
                            <span class="n">II</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">II0</span><span class="p">)</span>
                            <span class="k">if</span> <span class="n">numpy</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">NewSet</span><span class="o">==</span><span class="n">SetStorage</span><span class="p">[</span><span class="n">II</span><span class="p">,:]):</span>
                                <span class="n">SetP</span><span class="p">[</span><span class="n">II</span><span class="p">]</span><span class="o">=</span><span class="n">SetP</span><span class="p">[</span><span class="n">II</span><span class="p">]</span><span class="o">+</span><span class="n">setProb</span><span class="o">*</span><span class="n">EdgeProb</span>
                                <span class="k">break</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">II0</span><span class="o">=</span><span class="n">LLix</span><span class="p">[</span><span class="n">II</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">II0</span><span class="o">==-</span><span class="mi">1</span><span class="p">:</span>
                            <span class="n">SetStorage</span><span class="p">[</span><span class="n">Setix</span><span class="p">,:]</span><span class="o">=</span><span class="n">NewSet</span>
                            <span class="n">SetP</span><span class="p">[</span><span class="n">Setix</span><span class="p">]</span><span class="o">=</span><span class="n">setProb</span><span class="o">*</span><span class="n">EdgeProb</span>
                            <span class="n">LLix</span><span class="p">[</span><span class="n">II</span><span class="p">]</span><span class="o">=</span><span class="n">Setix</span>
                            <span class="n">Setix</span><span class="o">=</span><span class="n">Setix</span><span class="o">+</span><span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Insert into Trie</span>
                    <span class="c1"># print(NewSet)</span>
                    <span class="n">Tix</span><span class="o">=</span><span class="mi">0</span>
                    <span class="k">for</span> <span class="n">vv</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Setlen</span><span class="o">*</span><span class="mi">2</span><span class="p">):</span>
                        <span class="n">ss</span><span class="o">=</span><span class="n">NewSet</span><span class="p">[</span><span class="n">vv</span><span class="p">]</span>
                        <span class="n">II</span><span class="o">=</span><span class="n">Trie</span><span class="p">[</span><span class="n">Tix</span><span class="p">,</span><span class="n">NodeTTrieIx</span><span class="p">[</span><span class="n">ss</span><span class="p">]]</span>
                        <span class="k">if</span> <span class="n">II</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                            <span class="n">SetStorage</span><span class="p">[</span><span class="n">Setix</span><span class="p">,:]</span><span class="o">=</span><span class="n">NewSet</span>
                            <span class="n">SetP</span><span class="p">[</span><span class="n">Setix</span><span class="p">]</span><span class="o">=</span><span class="n">setProb</span><span class="o">*</span><span class="n">EdgeProb</span>
                            <span class="n">Trie</span><span class="p">[</span><span class="n">Tix</span><span class="p">,</span><span class="n">NodeTTrieIx</span><span class="p">[</span><span class="n">ss</span><span class="p">]]</span><span class="o">=-</span><span class="n">Setix</span>
                            <span class="n">Setix</span><span class="o">=</span><span class="n">Setix</span><span class="o">+</span><span class="mi">1</span>
                            <span class="k">break</span>

                        <span class="k">if</span> <span class="n">II</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">vv</span><span class="o">==</span><span class="n">Setlen</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                                <span class="n">SetP</span><span class="p">[</span><span class="o">-</span><span class="n">II</span><span class="p">]</span><span class="o">=</span><span class="n">SetP</span><span class="p">[</span><span class="o">-</span><span class="n">II</span><span class="p">]</span><span class="o">+</span><span class="n">setProb</span><span class="o">*</span><span class="n">EdgeProb</span>
                                <span class="k">break</span>
                            <span class="n">InSet</span><span class="o">=</span><span class="n">SetStorage</span><span class="p">[</span><span class="o">-</span><span class="n">II</span><span class="p">,:]</span>
                            <span class="n">Trie</span><span class="p">[</span><span class="n">Tix</span><span class="p">,</span><span class="n">NodeTTrieIx</span><span class="p">[</span><span class="n">ss</span><span class="p">]]</span><span class="o">=</span><span class="n">Tlen</span>
                            <span class="n">Trie</span><span class="p">[</span><span class="n">Tlen</span><span class="p">,</span><span class="n">NodeTTrieIx</span><span class="p">[</span><span class="n">InSet</span><span class="p">[</span><span class="n">vv</span><span class="o">+</span><span class="mi">1</span><span class="p">]]]</span><span class="o">=</span><span class="n">II</span>
                            <span class="n">Tix</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">Tlen</span><span class="p">)</span>
                            <span class="n">Tlen</span><span class="o">=</span><span class="n">Tlen</span><span class="o">+</span><span class="mi">1</span>
                            <span class="c1"># lazy increase size of Trie</span>
                            <span class="k">if</span> <span class="n">Tlen</span><span class="o">&gt;=</span><span class="n">TrieSize</span><span class="p">:</span>
                                <span class="n">Trie</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Trie</span><span class="p">,</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">TrieSize</span><span class="p">,</span><span class="n">Setlen</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                                <span class="n">TrieSize</span><span class="o">=</span><span class="n">TrieSize</span><span class="o">*</span><span class="mi">2</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">Tix</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">II</span><span class="p">)</span>
                <span class="k">continue</span>


            <span class="n">VisitedNodes</span><span class="p">[:]</span><span class="o">=</span><span class="mi">0</span>
            <span class="n">VisitedNodes</span><span class="p">[</span><span class="n">EdgeList</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span><span class="o">=</span><span class="mi">1</span>
            <span class="n">NextNodes</span><span class="p">[:]</span><span class="o">=-</span><span class="mi">1</span>
            <span class="n">NextNodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">EdgeList</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">NNix</span><span class="o">=</span><span class="mi">1</span>

            <span class="k">for</span> <span class="n">con</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">NN</span><span class="p">):</span>
                <span class="n">ConNode</span><span class="o">=</span><span class="n">NextNodes</span><span class="p">[</span><span class="n">con</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">ConNode</span><span class="o">==-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">GcountC</span><span class="p">[</span><span class="n">ConNode</span><span class="p">]):</span>
                    <span class="n">AdjNode</span><span class="o">=</span><span class="n">Gactive</span><span class="p">[</span><span class="n">ConNode</span><span class="p">,</span><span class="n">e</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">VisitedNodes</span><span class="p">[</span><span class="n">AdjNode</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                        <span class="n">VisitedNodes</span><span class="p">[</span><span class="n">AdjNode</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
                        <span class="n">NextNodes</span><span class="p">[</span><span class="n">NNix</span><span class="p">]</span><span class="o">=</span><span class="n">AdjNode</span>
                        <span class="n">NNix</span><span class="o">=</span><span class="n">NNix</span><span class="o">+</span><span class="mi">1</span>

            <span class="k">if</span> <span class="n">NNix</span><span class="o">==</span><span class="n">ExistingNodeSum</span><span class="p">:</span>
                <span class="n">Connected</span><span class="o">=</span><span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">Connected</span><span class="o">=</span><span class="kc">False</span>

            <span class="c1"># print(EdgeList[Edge,:])</span>
            <span class="c1"># print(Curset)</span>
            <span class="c1"># print(Connected)</span>
            <span class="c1"># print(VisitedNodes)</span>
            <span class="c1"># input()</span>

            <span class="c1">########################### connectivity check</span>
            <span class="c1"># VisitedNodes[:]=0</span>
            <span class="c1"># VisitedNodes[:StartNode+1]=1</span>
            <span class="c1"># NextNodes[:]=-1</span>
            <span class="c1"># NextNodes[StartNode]=StartNode</span>
            <span class="c1"># NNix=StartNode+1</span>
            <span class="c1">#</span>
            <span class="c1"># for con in range(StartNode,NN):</span>
            <span class="c1">#     ConNode=NextNodes[con]</span>
            <span class="c1">#     if ConNode==-1:</span>
            <span class="c1">#         break</span>
            <span class="c1">#     for e in range(0,GcountC[ConNode]):</span>
            <span class="c1">#         AdjNode=Gactive[ConNode,e]</span>
            <span class="c1">#         if VisitedNodes[AdjNode]==0:</span>
            <span class="c1">#             VisitedNodes[AdjNode]=1</span>
            <span class="c1">#             NextNodes[NNix]=AdjNode</span>
            <span class="c1">#             NNix=NNix+1</span>
            <span class="c1">#</span>
            <span class="c1"># if NNix-StartNode==ExistingNodeSum:</span>
            <span class="c1">#     Connected=True</span>
            <span class="c1"># else:</span>
            <span class="c1">#     Connected=False</span>
            <span class="c1">########################### connectivity check END</span>

            <span class="c1"># print(&#39;Connected&#39;,Connected)</span>
            <span class="c1"># print(VisitedNodes)</span>
            <span class="k">if</span> <span class="n">Connected</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
                <span class="c1"># consider not contracted set case</span>
                <span class="c1">## build new set for storage</span>

                <span class="n">ix</span><span class="o">=</span><span class="mi">0</span>
                <span class="n">NewSet</span><span class="p">[:]</span><span class="o">=-</span><span class="mi">1</span>
                <span class="c1"># get set order</span>
                <span class="n">SetSort</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">Setworkspace</span><span class="p">[:</span><span class="n">SetNum</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">SetNum</span><span class="p">):</span>
                    <span class="n">ID</span><span class="o">=</span><span class="n">SetSort</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                    <span class="n">NewSet</span><span class="p">[</span><span class="n">ix</span><span class="p">:</span><span class="n">ix</span><span class="o">+</span><span class="n">Setworklen</span><span class="p">[</span><span class="n">ID</span><span class="p">]]</span><span class="o">=</span><span class="n">Setworkspace</span><span class="p">[</span><span class="n">ID</span><span class="p">,:</span><span class="n">Setworklen</span><span class="p">[</span><span class="n">ID</span><span class="p">]]</span>
                    <span class="n">ix</span><span class="o">=</span><span class="n">ix</span><span class="o">+</span><span class="n">Setworklen</span><span class="p">[</span><span class="n">ID</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>

                <span class="k">if</span> <span class="n">Setlen</span><span class="o">&gt;</span><span class="n">TrieHashThreshold</span><span class="p">:</span>
                    <span class="c1"># GET HASH</span>
                    <span class="n">acc</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">2870177450012600261</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">vv</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Setlen</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">2</span><span class="p">)):</span>
                        <span class="n">acc</span><span class="o">=</span><span class="n">acc</span><span class="o">+</span><span class="n">numpy</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="n">NewSet</span><span class="p">[</span><span class="n">vv</span><span class="p">])</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">)</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">14029467366897019727</span><span class="p">)</span>
                        <span class="n">acc</span><span class="o">=</span><span class="p">((</span><span class="n">acc</span> <span class="o">&lt;&lt;</span> <span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">31</span><span class="p">))</span> <span class="o">|</span> <span class="p">(</span><span class="n">acc</span> <span class="o">&gt;&gt;</span> <span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">33</span><span class="p">)))</span>
                        <span class="n">acc</span><span class="o">=</span><span class="n">acc</span><span class="o">*</span><span class="mi">11400714785074694791</span>
                    <span class="n">acc</span> <span class="o">=</span> <span class="n">acc</span><span class="o">+</span><span class="p">(</span><span class="n">Setlen</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">^</span> <span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">2870177450012600261</span><span class="p">)</span> <span class="o">^</span> <span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">3527539</span><span class="p">))</span>
                    <span class="n">acc</span><span class="o">=</span><span class="n">acc</span><span class="o">%</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Setix0</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mf">1.3</span><span class="p">))</span>

                    <span class="k">if</span> <span class="n">HashTable</span><span class="p">[</span><span class="n">acc</span><span class="p">]</span><span class="o">==-</span><span class="mi">1</span><span class="p">:</span>
                        <span class="n">SetStorage</span><span class="p">[</span><span class="n">Setix</span><span class="p">,:]</span><span class="o">=</span><span class="n">NewSet</span>
                        <span class="n">SetP</span><span class="p">[</span><span class="n">Setix</span><span class="p">]</span><span class="o">=</span><span class="n">setProb</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">EdgeProb</span><span class="p">)</span>
                        <span class="n">HashTable</span><span class="p">[</span><span class="n">acc</span><span class="p">]</span><span class="o">=</span><span class="n">Setix</span>
                        <span class="n">Setix</span><span class="o">=</span><span class="n">Setix</span><span class="o">+</span><span class="mi">1</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">II0</span><span class="o">=</span><span class="n">HashTable</span><span class="p">[</span><span class="n">acc</span><span class="p">]</span>
                        <span class="k">while</span> <span class="n">II0</span><span class="o">!=-</span><span class="mi">1</span><span class="p">:</span>
                            <span class="n">II</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">II0</span><span class="p">)</span>
                            <span class="k">if</span> <span class="n">numpy</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">NewSet</span><span class="o">==</span><span class="n">SetStorage</span><span class="p">[</span><span class="n">II</span><span class="p">,:]):</span>
                                <span class="n">SetP</span><span class="p">[</span><span class="n">II</span><span class="p">]</span><span class="o">=</span><span class="n">SetP</span><span class="p">[</span><span class="n">II</span><span class="p">]</span><span class="o">+</span><span class="n">setProb</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">EdgeProb</span><span class="p">)</span>
                                <span class="k">break</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">II0</span><span class="o">=</span><span class="n">LLix</span><span class="p">[</span><span class="n">II</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">II0</span><span class="o">==-</span><span class="mi">1</span><span class="p">:</span>
                            <span class="n">SetStorage</span><span class="p">[</span><span class="n">Setix</span><span class="p">,:]</span><span class="o">=</span><span class="n">NewSet</span>
                            <span class="n">SetP</span><span class="p">[</span><span class="n">Setix</span><span class="p">]</span><span class="o">=</span><span class="n">setProb</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">EdgeProb</span><span class="p">)</span>
                            <span class="n">LLix</span><span class="p">[</span><span class="n">II</span><span class="p">]</span><span class="o">=</span><span class="n">Setix</span>
                            <span class="n">Setix</span><span class="o">=</span><span class="n">Setix</span><span class="o">+</span><span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Insert into Trie</span>
                    <span class="c1"># print(NewSet)</span>
                    <span class="n">Tix</span><span class="o">=</span><span class="mi">0</span>
                    <span class="k">for</span> <span class="n">vv</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Setlen</span><span class="o">*</span><span class="mi">2</span><span class="p">):</span>
                        <span class="n">ss</span><span class="o">=</span><span class="n">NewSet</span><span class="p">[</span><span class="n">vv</span><span class="p">]</span>
                        <span class="n">II</span><span class="o">=</span><span class="n">Trie</span><span class="p">[</span><span class="n">Tix</span><span class="p">,</span><span class="n">NodeTTrieIx</span><span class="p">[</span><span class="n">ss</span><span class="p">]]</span>
                        <span class="c1"># print(ss,II)</span>
                        <span class="k">if</span> <span class="n">II</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                            <span class="n">SetStorage</span><span class="p">[</span><span class="n">Setix</span><span class="p">,:]</span><span class="o">=</span><span class="n">NewSet</span>
                            <span class="n">SetP</span><span class="p">[</span><span class="n">Setix</span><span class="p">]</span><span class="o">=</span><span class="n">setProb</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">EdgeProb</span><span class="p">)</span>
                            <span class="n">Trie</span><span class="p">[</span><span class="n">Tix</span><span class="p">,</span><span class="n">NodeTTrieIx</span><span class="p">[</span><span class="n">ss</span><span class="p">]]</span><span class="o">=-</span><span class="n">Setix</span>
                            <span class="n">Setix</span><span class="o">=</span><span class="n">Setix</span><span class="o">+</span><span class="mi">1</span>
                            <span class="k">break</span>

                        <span class="k">if</span> <span class="n">II</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">vv</span><span class="o">==</span><span class="n">Setlen</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                                <span class="n">SetP</span><span class="p">[</span><span class="o">-</span><span class="n">II</span><span class="p">]</span><span class="o">=</span><span class="n">SetP</span><span class="p">[</span><span class="o">-</span><span class="n">II</span><span class="p">]</span><span class="o">+</span><span class="n">setProb</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">EdgeProb</span><span class="p">)</span>
                                <span class="k">break</span>
                            <span class="n">InSet</span><span class="o">=</span><span class="n">SetStorage</span><span class="p">[</span><span class="o">-</span><span class="n">II</span><span class="p">,:]</span>
                            <span class="n">Trie</span><span class="p">[</span><span class="n">Tix</span><span class="p">,</span><span class="n">NodeTTrieIx</span><span class="p">[</span><span class="n">ss</span><span class="p">]]</span><span class="o">=</span><span class="n">Tlen</span>
                            <span class="n">Trie</span><span class="p">[</span><span class="n">Tlen</span><span class="p">,</span><span class="n">NodeTTrieIx</span><span class="p">[</span><span class="n">InSet</span><span class="p">[</span><span class="n">vv</span><span class="o">+</span><span class="mi">1</span><span class="p">]]]</span><span class="o">=</span><span class="n">II</span>
                            <span class="n">Tix</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">Tlen</span><span class="p">)</span>
                            <span class="n">Tlen</span><span class="o">=</span><span class="n">Tlen</span><span class="o">+</span><span class="mi">1</span>
                            <span class="c1"># lazy increase size of Trie</span>
                            <span class="k">if</span> <span class="n">Tlen</span><span class="o">&gt;=</span><span class="n">TrieSize</span><span class="p">:</span>
                                <span class="n">Trie</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Trie</span><span class="p">,</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">TrieSize</span><span class="p">,</span><span class="n">Setlen</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                                <span class="n">TrieSize</span><span class="o">=</span><span class="n">TrieSize</span><span class="o">*</span><span class="mi">2</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">Tix</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">II</span><span class="p">)</span>
                    <span class="c1"># print(&#39;Trie&#39;)</span>
                    <span class="c1"># print(NodeTTrieIx)</span>
                    <span class="c1"># print(Trie)</span>

            <span class="c1"># only need to consider contracted set case</span>
            <span class="c1">## build new set for storage</span>
            <span class="c1"># merge sets</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Setworklen</span><span class="p">[</span><span class="n">Setmarked</span><span class="p">[</span><span class="mi">1</span><span class="p">]]):</span>
                <span class="n">Setworkspace</span><span class="p">[</span><span class="n">Setmarked</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">Setworklen</span><span class="p">[</span><span class="n">Setmarked</span><span class="p">[</span><span class="mi">0</span><span class="p">]]]</span><span class="o">=</span><span class="n">Setworkspace</span><span class="p">[</span><span class="n">Setmarked</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">k</span><span class="p">]</span>
                <span class="n">Setworklen</span><span class="p">[</span><span class="n">Setmarked</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">=</span><span class="n">Setworklen</span><span class="p">[</span><span class="n">Setmarked</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">+</span><span class="mi">1</span>
                <span class="n">Setworkspace</span><span class="p">[</span><span class="n">Setmarked</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">k</span><span class="p">]</span><span class="o">=-</span><span class="mi">1</span>

            <span class="n">Setworkspace</span><span class="p">[</span><span class="n">Setmarked</span><span class="p">[</span><span class="mi">0</span><span class="p">],:</span><span class="n">Setworklen</span><span class="p">[</span><span class="n">Setmarked</span><span class="p">[</span><span class="mi">0</span><span class="p">]]]</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="n">ix</span><span class="o">=</span><span class="mi">0</span>
            <span class="n">NewSet</span><span class="p">[:]</span><span class="o">=-</span><span class="mi">1</span>
            <span class="c1"># get set order</span>
            <span class="n">SetSort</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">Setworkspace</span><span class="p">[:</span><span class="n">SetNum</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">SetNum</span><span class="p">):</span>
                <span class="n">ID</span><span class="o">=</span><span class="n">SetSort</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="n">NewSet</span><span class="p">[</span><span class="n">ix</span><span class="p">:</span><span class="n">ix</span><span class="o">+</span><span class="n">Setworklen</span><span class="p">[</span><span class="n">ID</span><span class="p">]]</span><span class="o">=</span><span class="n">Setworkspace</span><span class="p">[</span><span class="n">ID</span><span class="p">,:</span><span class="n">Setworklen</span><span class="p">[</span><span class="n">ID</span><span class="p">]]</span>
                <span class="n">ix</span><span class="o">=</span><span class="n">ix</span><span class="o">+</span><span class="n">Setworklen</span><span class="p">[</span><span class="n">ID</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>

            <span class="k">if</span> <span class="n">Setlen</span><span class="o">&gt;</span><span class="n">TrieHashThreshold</span><span class="p">:</span>
                <span class="c1"># GET HASH</span>
                <span class="n">acc</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">2870177450012600261</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">vv</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Setlen</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">2</span><span class="p">)):</span>
                    <span class="n">acc</span><span class="o">=</span><span class="n">acc</span><span class="o">+</span><span class="n">numpy</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="n">NewSet</span><span class="p">[</span><span class="n">vv</span><span class="p">])</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">)</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">14029467366897019727</span><span class="p">)</span>
                    <span class="n">acc</span><span class="o">=</span><span class="p">((</span><span class="n">acc</span> <span class="o">&lt;&lt;</span> <span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">31</span><span class="p">))</span> <span class="o">|</span> <span class="p">(</span><span class="n">acc</span> <span class="o">&gt;&gt;</span> <span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">33</span><span class="p">)))</span>
                    <span class="n">acc</span><span class="o">=</span><span class="n">acc</span><span class="o">*</span><span class="mi">11400714785074694791</span>
                <span class="n">acc</span> <span class="o">=</span> <span class="n">acc</span><span class="o">+</span><span class="p">(</span><span class="n">Setlen</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">^</span> <span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">2870177450012600261</span><span class="p">)</span> <span class="o">^</span> <span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="mi">3527539</span><span class="p">))</span>
                <span class="n">acc</span><span class="o">=</span><span class="n">acc</span><span class="o">%</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">Setix0</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mf">1.3</span><span class="p">))</span>

                <span class="k">if</span> <span class="n">HashTable</span><span class="p">[</span><span class="n">acc</span><span class="p">]</span><span class="o">==-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">SetStorage</span><span class="p">[</span><span class="n">Setix</span><span class="p">,:]</span><span class="o">=</span><span class="n">NewSet</span>
                    <span class="n">SetP</span><span class="p">[</span><span class="n">Setix</span><span class="p">]</span><span class="o">=</span><span class="n">setProb</span><span class="o">*</span><span class="n">EdgeProb</span>
                    <span class="n">HashTable</span><span class="p">[</span><span class="n">acc</span><span class="p">]</span><span class="o">=</span><span class="n">Setix</span>
                    <span class="n">Setix</span><span class="o">=</span><span class="n">Setix</span><span class="o">+</span><span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">II0</span><span class="o">=</span><span class="n">HashTable</span><span class="p">[</span><span class="n">acc</span><span class="p">]</span>
                    <span class="k">while</span> <span class="n">II0</span><span class="o">!=-</span><span class="mi">1</span><span class="p">:</span>
                        <span class="n">II</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">II0</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">numpy</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">NewSet</span><span class="o">==</span><span class="n">SetStorage</span><span class="p">[</span><span class="n">II</span><span class="p">,:]):</span>
                            <span class="n">SetP</span><span class="p">[</span><span class="n">II</span><span class="p">]</span><span class="o">=</span><span class="n">SetP</span><span class="p">[</span><span class="n">II</span><span class="p">]</span><span class="o">+</span><span class="n">setProb</span><span class="o">*</span><span class="n">EdgeProb</span>
                            <span class="k">break</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">II0</span><span class="o">=</span><span class="n">LLix</span><span class="p">[</span><span class="n">II</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">II0</span><span class="o">==-</span><span class="mi">1</span><span class="p">:</span>
                        <span class="n">SetStorage</span><span class="p">[</span><span class="n">Setix</span><span class="p">,:]</span><span class="o">=</span><span class="n">NewSet</span>
                        <span class="n">SetP</span><span class="p">[</span><span class="n">Setix</span><span class="p">]</span><span class="o">=</span><span class="n">setProb</span><span class="o">*</span><span class="n">EdgeProb</span>
                        <span class="n">LLix</span><span class="p">[</span><span class="n">II</span><span class="p">]</span><span class="o">=</span><span class="n">Setix</span>
                        <span class="n">Setix</span><span class="o">=</span><span class="n">Setix</span><span class="o">+</span><span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Insert into Trie</span>
                <span class="c1"># print(NewSet)</span>
                <span class="n">Tix</span><span class="o">=</span><span class="mi">0</span>
                <span class="k">for</span> <span class="n">vv</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Setlen</span><span class="o">*</span><span class="mi">2</span><span class="p">):</span>
                    <span class="n">ss</span><span class="o">=</span><span class="n">NewSet</span><span class="p">[</span><span class="n">vv</span><span class="p">]</span>
                    <span class="n">II</span><span class="o">=</span><span class="n">Trie</span><span class="p">[</span><span class="n">Tix</span><span class="p">,</span><span class="n">NodeTTrieIx</span><span class="p">[</span><span class="n">ss</span><span class="p">]]</span>
                    <span class="k">if</span> <span class="n">II</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                        <span class="n">SetStorage</span><span class="p">[</span><span class="n">Setix</span><span class="p">,:]</span><span class="o">=</span><span class="n">NewSet</span>
                        <span class="n">SetP</span><span class="p">[</span><span class="n">Setix</span><span class="p">]</span><span class="o">=</span><span class="n">setProb</span><span class="o">*</span><span class="n">EdgeProb</span>
                        <span class="n">Trie</span><span class="p">[</span><span class="n">Tix</span><span class="p">,</span><span class="n">NodeTTrieIx</span><span class="p">[</span><span class="n">ss</span><span class="p">]]</span><span class="o">=-</span><span class="n">Setix</span>
                        <span class="n">Setix</span><span class="o">=</span><span class="n">Setix</span><span class="o">+</span><span class="mi">1</span>
                        <span class="k">break</span>

                    <span class="k">if</span> <span class="n">II</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">vv</span><span class="o">==</span><span class="n">Setlen</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                            <span class="n">SetP</span><span class="p">[</span><span class="o">-</span><span class="n">II</span><span class="p">]</span><span class="o">=</span><span class="n">SetP</span><span class="p">[</span><span class="o">-</span><span class="n">II</span><span class="p">]</span><span class="o">+</span><span class="n">setProb</span><span class="o">*</span><span class="n">EdgeProb</span>
                            <span class="k">break</span>
                        <span class="n">InSet</span><span class="o">=</span><span class="n">SetStorage</span><span class="p">[</span><span class="o">-</span><span class="n">II</span><span class="p">,:]</span>
                        <span class="n">Trie</span><span class="p">[</span><span class="n">Tix</span><span class="p">,</span><span class="n">NodeTTrieIx</span><span class="p">[</span><span class="n">ss</span><span class="p">]]</span><span class="o">=</span><span class="n">Tlen</span>
                        <span class="n">Trie</span><span class="p">[</span><span class="n">Tlen</span><span class="p">,</span><span class="n">NodeTTrieIx</span><span class="p">[</span><span class="n">InSet</span><span class="p">[</span><span class="n">vv</span><span class="o">+</span><span class="mi">1</span><span class="p">]]]</span><span class="o">=</span><span class="n">II</span>
                        <span class="n">Tix</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">Tlen</span><span class="p">)</span>
                        <span class="n">Tlen</span><span class="o">=</span><span class="n">Tlen</span><span class="o">+</span><span class="mi">1</span>
                        <span class="c1"># lazy increase size of Trie</span>
                        <span class="k">if</span> <span class="n">Tlen</span><span class="o">&gt;=</span><span class="n">TrieSize</span><span class="p">:</span>
                            <span class="n">Trie</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Trie</span><span class="p">,</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">TrieSize</span><span class="p">,</span><span class="n">Setlen</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                            <span class="n">TrieSize</span><span class="o">=</span><span class="n">TrieSize</span><span class="o">*</span><span class="mi">2</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">Tix</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">II</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="n">SetStorage0</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">SetStorage</span><span class="p">)</span>
        <span class="n">SetP0</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">SetP</span><span class="p">)</span>
        <span class="n">Setix0</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">Setix</span><span class="p">)</span>

        <span class="c1"># print(ee)</span>
        <span class="c1"># print(SetStorage0)</span>
        <span class="c1"># print(SetP0)</span>
        <span class="c1"># print(Trie[:Tlen,:])</span>
        <span class="c1"># print(Tlen/Setix)</span>
        <span class="c1"># print(Tlen)</span>
        <span class="c1"># print(&#39;ErrorCheck&#39;)</span>
        <span class="c1"># print(SetStorage)</span>
        <span class="c1"># print(SetP)</span>
        <span class="c1"># print(numpy.sum(SetP))</span>
        <span class="c1"># print(Curset)</span>
        <span class="c1"># print(ee)</span>
        <span class="c1"># print(Setmarked)</span>
        <span class="c1"># input()</span>

        <span class="n">SetixTotal</span><span class="o">=</span><span class="n">SetixTotal</span><span class="o">+</span><span class="n">Setix</span>
        <span class="n">SetixMax</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">SetixMax</span><span class="p">,</span><span class="n">Setix</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">Setix</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">SetixTotal</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">TrieHashThreshold</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>

    <span class="c1"># tests are stored here</span>

    <span class="c1">############ Complete Graph Test</span>
    <span class="n">n</span><span class="o">=</span><span class="mi">5</span>
    <span class="n">EdgeList</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">k1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">k2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k1</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
            <span class="n">EdgeList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">k1</span><span class="p">,</span><span class="n">k2</span><span class="p">))</span>
    <span class="c1">############ Complete Graph Test END</span>

    <span class="c1">############ Grid Graph Test</span>
    <span class="c1"># n=12</span>
    <span class="c1"># EdgeList=[]</span>
    <span class="c1"># for k1 in range(0,n):</span>
    <span class="c1">#     for k2 in range(0,n-1):</span>
    <span class="c1">#         EdgeList.append((n*k1+k2,n*k1+k2+1))</span>
    <span class="c1">#</span>
    <span class="c1"># for k1 in range(0,n-1):</span>
    <span class="c1">#     for k2 in range(0,n):</span>
    <span class="c1">#         EdgeList.append((n*k1+k2,n*(k1+1)+k2))</span>
    <span class="c1">#</span>
    <span class="c1"># EdgeList=numpy.array(EdgeList)</span>
    <span class="c1"># ix=numpy.argsort(EdgeList[:,0])</span>
    <span class="c1"># EdgeList=EdgeList[ix,:]</span>
    <span class="c1">############ Grid Graph Test END</span>
    <span class="n">EdgeList</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">EdgeList</span><span class="p">)</span>
    <span class="n">EP</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">EdgeList</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mf">.5</span>
    <span class="n">REL</span><span class="p">,</span><span class="n">SetixTotal</span><span class="p">,</span><span class="n">SetixMax</span><span class="o">=</span><span class="n">ATR</span><span class="p">(</span><span class="n">EdgeList</span><span class="p">,</span><span class="n">EP</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">REL</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">REL</span><span class="o">*</span><span class="mi">2</span><span class="o">**</span><span class="n">EdgeList</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

        </details>

            <div class="docstring"><p>This module calculates the all terminal reliability of undirected graphs</p>

<h6 id="functions">Functions</h6>

<p><strong>ATR(EdgeList,EP,verbose=False,TrieHashThreshold=10) :</strong> <br />
    Calculates the All Terminal Reliability of a undirected graph defined by EdgeList.</p>

<h6 id="notes">Notes</h6>

<p>When these functions are first executed, numba performs jit compilation. This causes the first execution to take several seconds to run, but the compilation is cached and future runs with different inputs do not need to recompile.</p>

<p>Currently just for All Terminal Reliability. K-Terminal Reliability can be implemented in the future.</p>

<h6 id="examples">Examples</h6>

<div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ATRnumbaTrie</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="o">=</span><span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EdgeList</span><span class="o">=</span><span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">k1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">for</span> <span class="n">k2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k1</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">EdgeList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">k1</span><span class="p">,</span><span class="n">k2</span><span class="p">))</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">EdgeList</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">EdgeList</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EP</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">EdgeList</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mf">.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">REL</span><span class="p">,</span><span class="n">SetixTotal</span><span class="p">,</span><span class="n">SetixMax</span><span class="o">=</span><span class="n">ATR</span><span class="p">(</span><span class="n">EdgeList</span><span class="p">,</span><span class="n">EP</span><span class="p">)</span>
</code></pre></div>
</div>


                </section>
                <section id="ContractionOrdering">
                                <div class="attr module"><a class="headerlink" href="#ContractionOrdering">#&nbsp;&nbsp</a>
<span class="name"><a href="ICOSSAR_2021/ContractionOrdering.html">ICOSSAR_2021.ContractionOrdering</a></span></div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">This module determines the best edge contraction order to use if a tree decomposition is given. The returned order optimizes for pathwidth</span>

<span class="sd">Functions</span>
<span class="sd">----------</span>
<span class="sd">**ContractionOrder(bags,tree) :**  </span>
<span class="sd">    Main function to determine the optimal contraction ordering from a tree decomposition.</span>

<span class="sd">**GetOrder(r,bags,tree,MasterTree,SolvedOrder) :**  </span>
<span class="sd">    Recursive function for determining the optimal contraction ordering.</span>

<span class="sd">**GetOrderSize(order,bags,tree,verbose=False) :**  </span>
<span class="sd">    Function for measuring the computational complexity of a given ordering.</span>

<span class="sd">**GetNodeOrdering(order,bags,tree,verbose=False) :**  </span>
<span class="sd">    Function to convert a bag ordering into a node ordering.</span>

<span class="sd">Notes</span>
<span class="sd">-----</span>
<span class="sd">Bag order is optimized using a greed local optimization recursive algorithm.</span>

<span class="sd">Node contraction order within a bag is not optimized.</span>

<span class="sd">Examples</span>
<span class="sd">--------</span>
<span class="sd">&gt;&gt;&gt; import ContractionOrdering</span>
<span class="sd">&gt;&gt;&gt; bags = [[0, 1],</span>
<span class="sd">            [1, 2, 3],</span>
<span class="sd">            [2, 4, 5],</span>
<span class="sd">            [2, 3, 5],</span>
<span class="sd">            [3, 5, 6]]</span>
<span class="sd">&gt;&gt;&gt; tree = [[1],</span>
<span class="sd">            [0, 3],</span>
<span class="sd">            [3],</span>
<span class="sd">            [1, 2, 4],</span>
<span class="sd">            [3]]</span>
<span class="sd">&gt;&gt;&gt; order,size=ContractionOrdering.ContractionOrder(bags,tree)</span>
<span class="sd">&gt;&gt;&gt; NodeOrder,PathWidthSize=ContractionOrdering.GetNodeOrdering(order,bags,tree,verbose=False)</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="kn">import</span> <span class="nn">itertools</span>

<span class="kn">import</span> <span class="nn">numpy</span>

<span class="k">def</span> <span class="nf">GetEdgeOrdering</span><span class="p">(</span><span class="n">order</span><span class="p">,</span><span class="n">bags</span><span class="p">,</span><span class="n">tree</span><span class="p">,</span><span class="n">G</span><span class="p">):</span>

    <span class="n">edges</span><span class="o">=</span><span class="p">[]</span>

    <span class="n">EdgeSet</span><span class="o">=</span><span class="nb">set</span><span class="p">()</span>
    <span class="n">removed</span><span class="o">=</span><span class="nb">set</span><span class="p">()</span>
    <span class="n">NodeRemove</span><span class="o">=</span><span class="nb">set</span><span class="p">()</span>
    <span class="n">MaxVal</span><span class="o">=</span><span class="mi">0</span>
    <span class="c1"># for o in reversed(order):</span>
    <span class="c1"># print(order)</span>
    <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">order</span><span class="p">:</span>
        <span class="n">removed</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
        <span class="n">CandidateSet</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">bags</span><span class="p">[</span><span class="n">o</span><span class="p">])</span>
        <span class="n">TotalSet</span><span class="o">=</span><span class="nb">set</span><span class="p">()</span>
        <span class="c1"># print(tree[o])</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">tree</span><span class="p">[</span><span class="n">o</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">e</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">removed</span><span class="p">:</span>
                <span class="n">TotalSet</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">bags</span><span class="p">[</span><span class="n">e</span><span class="p">])</span>
        <span class="n">noderemove</span><span class="o">=</span><span class="n">CandidateSet</span><span class="o">-</span><span class="n">TotalSet</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">noderemove</span><span class="p">:</span>
            <span class="n">NodeRemove</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">G</span><span class="p">[</span><span class="n">n</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">e</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">NodeRemove</span><span class="p">:</span>
                    <span class="n">edges</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="n">e</span><span class="p">))</span>
        <span class="c1"># print(noderemove)</span>
        <span class="n">EdgeSet</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">bags</span><span class="p">[</span><span class="n">o</span><span class="p">])</span>
        <span class="n">EdgeSet</span><span class="o">=</span><span class="n">EdgeSet</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">CandidateSet</span><span class="p">)</span><span class="o">-</span><span class="n">noderemove</span>
        <span class="c1"># print(EdgeSet)</span>
        <span class="c1"># print(len(EdgeSet))</span>
        <span class="n">MaxVal</span><span class="o">=</span><span class="nb">max</span><span class="p">([</span><span class="n">MaxVal</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">EdgeSet</span><span class="p">)])</span>
        <span class="c1"># print(MaxVal)</span>

    <span class="c1"># print(&#39;MaxVal=&#39;+str(MaxVal))</span>
    <span class="c1"># for e in edges:</span>
    <span class="c1">#     print(e)</span>
    <span class="c1"># input()</span>
    <span class="k">return</span> <span class="n">edges</span>

<span class="k">def</span> <span class="nf">GetNodeOrdering</span><span class="p">(</span><span class="n">order</span><span class="p">,</span><span class="n">bags</span><span class="p">,</span><span class="n">tree</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Helper function to convert an optimized bag order into an optimized node contraction ordering.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    order : list, int</span>
<span class="sd">        The optimized bag contraction order.</span>

<span class="sd">    bags : list of lists, int</span>
<span class="sd">        Tree decomposition algorithms output the tree bags in the format</span>
<span class="sd">        b 3 2 3 11 12 28 31 43 49</span>
<span class="sd">        where each number is a node label.</span>
<span class="sd">        bags[i] is the ith bag containing a list of the node labels in that bag.</span>
<span class="sd">        bags[i][j] is the jth node label in bag i.</span>

<span class="sd">    tree : list of lists, int</span>
<span class="sd">        tree[i] contains a list of the bags connected to bag i.</span>

<span class="sd">    verbose : bool</span>
<span class="sd">        boolean for verbose console output</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    NodeOrder : list</span>
<span class="sd">        A list of the optimized node contraction order</span>

<span class="sd">    PathWidth : int</span>
<span class="sd">        The pathwidth of the given order.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    No attempt is made to optimize the node order within a given bag</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">EdgeSet</span><span class="o">=</span><span class="nb">set</span><span class="p">()</span>
    <span class="n">removed</span><span class="o">=</span><span class="nb">set</span><span class="p">()</span>
    <span class="n">PathWidth</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">NodeOrder</span><span class="o">=</span><span class="p">[]</span>

    <span class="c1"># for each bag</span>
    <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">order</span><span class="p">:</span>
        <span class="n">removed</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
        <span class="n">CandidateSet</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">bags</span><span class="p">[</span><span class="n">o</span><span class="p">])</span>
        <span class="n">TotalSet</span><span class="o">=</span><span class="nb">set</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">tree</span><span class="p">[</span><span class="n">o</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">e</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">removed</span><span class="p">:</span>
                <span class="n">TotalSet</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">bags</span><span class="p">[</span><span class="n">e</span><span class="p">])</span>

        <span class="c1"># determine the nodes to contract</span>
        <span class="c1"># if the bag being contracted contains the last instance of a node,</span>
        <span class="c1"># that node needs to be contracted</span>
        <span class="n">noderemove</span><span class="o">=</span><span class="n">CandidateSet</span><span class="o">-</span><span class="n">TotalSet</span>
        <span class="n">NodeOrder</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">noderemove</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">noderemove</span><span class="p">)</span>
        <span class="n">EdgeSet</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">bags</span><span class="p">[</span><span class="n">o</span><span class="p">])</span>
        <span class="n">EdgeSet</span><span class="o">=</span><span class="n">EdgeSet</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">CandidateSet</span><span class="p">)</span><span class="o">-</span><span class="n">noderemove</span>

        <span class="c1"># keep track of the edge set size, equal to Pathwidth</span>
        <span class="c1">###</span>
        <span class="n">PathWidth</span><span class="o">=</span><span class="nb">max</span><span class="p">([</span><span class="n">PathWidth</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">EdgeSet</span><span class="p">)])</span>
        <span class="c1">###</span>

    <span class="k">return</span> <span class="n">NodeOrder</span><span class="p">,</span><span class="n">PathWidth</span>

<span class="k">def</span> <span class="nf">GetOrderSizeLineGraph</span><span class="p">(</span><span class="n">order</span><span class="p">,</span><span class="n">bags</span><span class="p">,</span><span class="n">tree</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="c1"># print(&#39;tree=&#39;+str(tree))</span>
    <span class="c1"># print(&#39;bags=&#39;+str(bags))</span>
    <span class="n">EdgeSet</span><span class="o">=</span><span class="nb">set</span><span class="p">()</span>
    <span class="n">EC</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">bags</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">b</span><span class="o">==</span><span class="p">[]:</span>
            <span class="k">continue</span>
        <span class="n">EdgeSet</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
        <span class="n">BM</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
        <span class="n">EC</span><span class="o">=</span><span class="nb">max</span><span class="p">([</span><span class="n">EC</span><span class="p">,</span><span class="n">BM</span><span class="p">])</span>
    <span class="n">Ndegree</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">EC</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">Nseen</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">EC</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">EdgeSet</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">EdgeSet</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">EdgeSet</span><span class="p">:</span>
        <span class="n">Ndegree</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">=</span><span class="n">Ndegree</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">+</span><span class="mi">1</span>
        <span class="n">Ndegree</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">=</span><span class="n">Ndegree</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">+</span><span class="mi">1</span>
    <span class="c1"># print(Ndegree)</span>

    <span class="n">EdgeSet</span><span class="o">=</span><span class="nb">set</span><span class="p">()</span>
    <span class="n">EdgeRemoved</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">removed</span><span class="o">=</span><span class="nb">set</span><span class="p">()</span>
    <span class="n">MaxVal</span><span class="o">=</span><span class="mi">0</span>
    <span class="c1"># for o in reversed(order):</span>
    <span class="c1"># print(order)</span>
    <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">order</span><span class="p">:</span>
        <span class="n">removed</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
        <span class="n">CandidateSet</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">bags</span><span class="p">[</span><span class="n">o</span><span class="p">])</span>
        <span class="n">TotalSet</span><span class="o">=</span><span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">tree</span><span class="p">[</span><span class="n">o</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">e</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">removed</span><span class="p">:</span>
                <span class="n">TotalSet</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">bags</span><span class="p">[</span><span class="n">e</span><span class="p">])</span>
        <span class="n">EdgeRemoved</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">CandidateSet</span><span class="o">-</span><span class="n">TotalSet</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">EdgeRemoved</span><span class="p">:</span>
        <span class="c1"># print(e)</span>
        <span class="n">Nseen</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">=</span><span class="n">Nseen</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">+</span><span class="mi">1</span>
        <span class="n">Nseen</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">=</span><span class="n">Nseen</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">+</span><span class="mi">1</span>
        <span class="n">Ndegree</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">=</span><span class="n">Ndegree</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">-</span><span class="mi">1</span>
        <span class="n">Ndegree</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">=</span><span class="n">Ndegree</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">-</span><span class="mi">1</span>

        <span class="n">SS</span><span class="o">=</span><span class="n">Ndegree</span><span class="o">*</span><span class="n">Nseen</span>
        <span class="c1"># print(Ndegree)</span>
        <span class="c1"># print(Nseen)</span>
        <span class="c1"># print(SS)</span>
        <span class="c1"># input()</span>
        <span class="n">NodeCount</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">SS</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">MaxVal</span><span class="o">=</span><span class="nb">max</span><span class="p">([</span><span class="n">MaxVal</span><span class="p">,</span><span class="n">NodeCount</span><span class="p">])</span>

    <span class="c1"># print(&#39;MaxVal=&#39;+str(MaxVal))</span>
    <span class="k">return</span> <span class="n">MaxVal</span>

<span class="n">BELLNUM</span><span class="o">=</span><span class="p">[]</span>
<span class="n">BELLNUM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">BELLNUM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">BELLNUM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">BELLNUM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">BELLNUM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="n">BELLNUM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">52</span><span class="p">)</span>
<span class="n">BELLNUM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">203</span><span class="p">)</span>
<span class="n">BELLNUM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">877</span><span class="p">)</span>
<span class="n">BELLNUM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">4140</span><span class="p">)</span>
<span class="n">BELLNUM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">21147</span><span class="p">)</span>
<span class="n">BELLNUM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">115975</span><span class="p">)</span>
<span class="n">BELLNUM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">678570</span><span class="p">)</span>
<span class="n">BELLNUM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">4213597</span><span class="p">)</span>
<span class="n">BELLNUM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">27644437</span><span class="p">)</span>
<span class="n">BELLNUM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">190899322</span><span class="p">)</span>
<span class="n">BELLNUM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1382958545</span><span class="p">)</span>
<span class="n">BELLNUM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">10480142147</span><span class="p">)</span>
<span class="n">BELLNUM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">82864869804</span><span class="p">)</span>
<span class="n">BELLNUM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">682076806159</span><span class="p">)</span>
<span class="n">BELLNUM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">5832742205057</span><span class="p">)</span>
<span class="n">BELLNUM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">51724158235372</span><span class="p">)</span>
<span class="n">BELLNUM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">474869816156751</span><span class="p">)</span>
<span class="n">BELLNUM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">4506715738447323</span><span class="p">)</span>
<span class="n">BELLNUM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">44152005855084346</span><span class="p">)</span>
<span class="n">BELLNUM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">445958869294805289</span><span class="p">)</span>
<span class="n">BELLNUM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">4638590332229999353</span><span class="p">)</span>
<span class="n">BELLNUM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">49631246523618756274</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">GetOrderSize</span><span class="p">(</span><span class="n">order</span><span class="p">,</span><span class="n">bags</span><span class="p">,</span><span class="n">tree</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This function calculates the computational cost of a particular bag ordering.</span>

<span class="sd">    The node edge set, |EdgeSet|, the number of nodes in common between bags[0:n] and bags[n+1:B] is used to determine the complexity. B is the number of bags.</span>

<span class="sd">    Complexity is calculated by sum( BELL(|EdgeSet|) ) for n from 0 to B.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    order : list, int</span>
<span class="sd">        The bag contraction order to be measured</span>

<span class="sd">    bags : list of lists, int</span>
<span class="sd">        Tree decomposition algorithms output the tree bags in the format</span>
<span class="sd">        b 3 2 3 11 12 28 31 43 49</span>
<span class="sd">        where each number is a node label.</span>
<span class="sd">        bags[i] is the ith bag containing a list of the node labels in that bag.</span>
<span class="sd">        bags[i][j] is the jth node label in bag i.</span>

<span class="sd">    tree : list of lists, int</span>
<span class="sd">        A deep copy of the whole bag tree.</span>

<span class="sd">    verbose : bool</span>
<span class="sd">        boolean for verbose console output</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MaxVal : int</span>
<span class="sd">        The total computational complexity of the contraction ordering.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The computational worst case for a node edge set of size n is assumed, BELL(n).</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">EdgeSet</span><span class="o">=</span><span class="nb">set</span><span class="p">()</span>
    <span class="n">removed</span><span class="o">=</span><span class="nb">set</span><span class="p">()</span>
    <span class="n">MaxVal</span><span class="o">=</span><span class="mi">0</span>

    <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">order</span><span class="p">:</span>
        <span class="n">removed</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
        <span class="n">CandidateSet</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">bags</span><span class="p">[</span><span class="n">o</span><span class="p">])</span>
        <span class="n">TotalSet</span><span class="o">=</span><span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">tree</span><span class="p">[</span><span class="n">o</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">e</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">removed</span><span class="p">:</span>
                <span class="n">TotalSet</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">bags</span><span class="p">[</span><span class="n">e</span><span class="p">])</span>
        <span class="n">noderemove</span><span class="o">=</span><span class="n">CandidateSet</span><span class="o">-</span><span class="n">TotalSet</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">noderemove</span><span class="p">)</span>
        <span class="n">EdgeSet</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">bags</span><span class="p">[</span><span class="n">o</span><span class="p">])</span>
        <span class="n">EdgeSet</span><span class="o">=</span><span class="n">EdgeSet</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">CandidateSet</span><span class="p">)</span><span class="o">-</span><span class="n">noderemove</span>
        <span class="c1">###</span>
        <span class="c1"># MaxVal=max([MaxVal,len(EdgeSet)])</span>
        <span class="c1"># MaxVal=MaxVal+2**len(EdgeSet)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">EdgeSet</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">26</span><span class="p">:</span>
            <span class="n">MaxVal</span><span class="o">=</span><span class="n">MaxVal</span><span class="o">+</span><span class="n">BELLNUM</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">EdgeSet</span><span class="p">)</span><span class="o">-</span><span class="mi">26</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">MaxVal</span><span class="o">=</span><span class="n">MaxVal</span><span class="o">+</span><span class="n">BELLNUM</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">EdgeSet</span><span class="p">)]</span>
        <span class="c1">###</span>

    <span class="k">return</span> <span class="n">MaxVal</span>

<span class="k">def</span> <span class="nf">GetOrder</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">bags</span><span class="p">,</span><span class="n">tree</span><span class="p">,</span><span class="n">MasterTree</span><span class="p">,</span><span class="n">SolvedOrder</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    The main recursive function for optimizing the bag contraction order.</span>

<span class="sd">    For each possible branch contraction order, this function is recursively called.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    r : int</span>
<span class="sd">        The current bag subroot</span>

<span class="sd">    bags : list of lists, int</span>
<span class="sd">        Tree decomposition algorithms output the tree bags in the format</span>
<span class="sd">        b 3 2 3 11 12 28 31 43 49</span>
<span class="sd">        where each number is a node label.</span>
<span class="sd">        bags[i] is the ith bag containing a list of the node labels in that bag.</span>
<span class="sd">        bags[i][j] is the jth node label in bag i.</span>

<span class="sd">    tree : list of lists, int</span>
<span class="sd">        The subtree passed to the recursive function.</span>
<span class="sd">        tree[i] contains a list of the bags connected to bag i.</span>

<span class="sd">    MasterTree : list of lists, int</span>
<span class="sd">        A deep copy of the whole bag tree.</span>

<span class="sd">    SolvedOrder : dict</span>
<span class="sd">        SolvedOrder[o] stores the optimal branch contraction order for bag o.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    OptimumOrder : list</span>
<span class="sd">        The optimal contraction order for the branches and bags below bag r</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Only the local best contraction order is chosen for bag r.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># determine leaf and branch bags</span>
    <span class="n">LeafStack</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">BranchStack</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">tree</span><span class="p">[</span><span class="n">r</span><span class="p">]:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tree</span><span class="p">[</span><span class="n">e</span><span class="p">])</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">LeafStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">BranchStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">LeafStack</span><span class="o">!=</span><span class="p">[]:</span>
        <span class="n">BranchStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">LeafStack</span><span class="p">)</span>

    <span class="c1"># permute over all possible branch contractions</span>
    <span class="n">orderings</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">permutations</span><span class="p">(</span><span class="n">BranchStack</span><span class="p">))</span>

    <span class="c1"># test to see which order is faster</span>
    <span class="n">OrderSize</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">ForderList</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">ordering</span> <span class="ow">in</span> <span class="n">orderings</span><span class="p">:</span>
        <span class="n">order</span><span class="o">=</span><span class="p">[]</span>
        <span class="c1"># create order</span>
        <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">ordering</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="n">order</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">o</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">order</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>

        <span class="c1"># recursively test order</span>
        <span class="n">Forder</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">order</span><span class="p">:</span>

            <span class="c1"># if the bag along the branch is not a leaf</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">MasterTree</span><span class="p">[</span><span class="n">o</span><span class="p">])</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
                <span class="c1"># if this bag has been solved already</span>
                <span class="c1"># used the cached answer</span>
                <span class="k">if</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">SolvedOrder</span><span class="p">:</span>
                    <span class="n">OptimumOrder</span><span class="o">=</span><span class="n">SolvedOrder</span><span class="p">[</span><span class="n">o</span><span class="p">]</span>
                    <span class="n">Forder</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">OptimumOrder</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># build subtree to send to recursive function</span>
                    <span class="n">subtree</span><span class="o">=</span><span class="p">[[]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">tree</span><span class="p">))]</span>
                    <span class="n">subtree</span><span class="p">[</span><span class="n">o</span><span class="p">]</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">tree</span><span class="p">[</span><span class="n">o</span><span class="p">])</span>

                    <span class="k">if</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">subtree</span><span class="p">[</span><span class="n">o</span><span class="p">]:</span>
                        <span class="n">subtree</span><span class="p">[</span><span class="n">o</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
                    <span class="n">GrowList</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">subtree</span><span class="p">[</span><span class="n">o</span><span class="p">])</span>
                    <span class="n">SeeList</span><span class="o">=</span><span class="nb">set</span><span class="p">([</span><span class="n">o</span><span class="p">])</span>
                    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">GrowList</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">GrowList</span><span class="p">):</span>
                            <span class="n">SeeList</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
                            <span class="n">subtree</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">tree</span><span class="p">[</span><span class="n">n</span><span class="p">])</span>
                            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">tree</span><span class="p">[</span><span class="n">n</span><span class="p">]:</span>
                                <span class="n">GrowList</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

                        <span class="n">GrowList</span><span class="o">=</span><span class="n">GrowList</span><span class="o">-</span><span class="n">SeeList</span>

                    <span class="c1"># send to recursive function</span>
                    <span class="n">OptimumOrder</span><span class="o">=</span><span class="n">GetOrder</span><span class="p">(</span><span class="n">o</span><span class="p">,</span><span class="n">bags</span><span class="p">,</span><span class="n">subtree</span><span class="p">,</span><span class="n">MasterTree</span><span class="p">,</span><span class="n">SolvedOrder</span><span class="p">)</span>
                    <span class="c1"># when recursive function returns, insert it into current</span>
                    <span class="c1"># Forder to be evaluated,</span>
                    <span class="c1"># and cache the result in SolvedOrder</span>
                    <span class="n">Forder</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">OptimumOrder</span><span class="p">)</span>
                    <span class="n">SolvedOrder</span><span class="p">[</span><span class="n">o</span><span class="p">]</span><span class="o">=</span><span class="n">OptimumOrder</span>

            <span class="c1"># add bag into contraction order</span>
            <span class="n">Forder</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
        <span class="c1"># add contraction order to list of contraction orders to test</span>
        <span class="n">ForderList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">Forder</span><span class="p">))</span>

        <span class="c1"># measure the computational complexity of the current order, and</span>
        <span class="c1"># save to a list</span>
        <span class="n">OrderSize</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">GetOrderSize</span><span class="p">(</span><span class="n">Forder</span><span class="p">,</span><span class="n">bags</span><span class="p">,</span><span class="n">MasterTree</span><span class="p">))</span>
    <span class="c1"># extract the best order</span>
    <span class="n">BestOrder</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">OrderSize</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ForderList</span><span class="p">[</span><span class="n">BestOrder</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">ContractionOrder</span><span class="p">(</span><span class="n">bags</span><span class="p">,</span><span class="n">tree</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Determines the optimum order to contract the bags in the tree decomposition. Specifically finds a contraction order to minimize Pathwidth.</span>

<span class="sd">    For each possible tree root, a greedy algorithm is used to optimize the bag contraction order. Starting at the root, the branch to contract first is recursively determined.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    bags : list of lists, int</span>
<span class="sd">        Tree decomposition algorithms output the tree bags in the format</span>
<span class="sd">        b 3 2 3 11 12 28 31 43 49</span>
<span class="sd">        where each number is a node label.</span>
<span class="sd">        bags[i] is the ith bag containing a list of the node labels in that bag.</span>
<span class="sd">        bags[i][j] is the jth node label in bag i.</span>

<span class="sd">    tree : list of lists, int</span>
<span class="sd">        tree[i] contains a list of the bags connected to bag i.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    order : list</span>
<span class="sd">        The optimal bag contraction order.</span>

<span class="sd">    size : int</span>
<span class="sd">        BELL(n). where n is the maximum size of the node edge set as the bags are contracted.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    As a greedy algorithm, the optimal solution, the optimal Pathwidth, is not guaranteed.</span>

<span class="sd">    The structure of the tree decomposition can affect the Pathwidth of the optimized order. Some grid graphs can have an optimal tree decomposition as measured by Treewidth, but the optimal Pathwidth cannot be extracted from the optimal tree decomposition.</span>

<span class="sd">    Only the bag contraction order is optimized. The contraction order of nodes within a bag is not optimized. For large bags, the order in which the nodes in the bag are contracted can affect the computational time of any algorithm that ingests the &quot;optimized&quot; order.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; bags = [[0, 1],</span>
<span class="sd">                [1, 2, 3],</span>
<span class="sd">                [2, 4, 5],</span>
<span class="sd">                [2, 3, 5],</span>
<span class="sd">                [3, 5, 6]]</span>
<span class="sd">    &gt;&gt;&gt; tree = [[1],</span>
<span class="sd">                [0, 3],</span>
<span class="sd">                [3],</span>
<span class="sd">                [1, 2, 4],</span>
<span class="sd">                [3]]</span>
<span class="sd">    &gt;&gt;&gt; (order,size) = ContractionOrder(bags,tree)</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1">### Auto contraction order</span>

    <span class="n">MasterTree</span><span class="o">=</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tree</span><span class="p">]</span>

    <span class="n">MasterOrderSize</span><span class="o">=</span><span class="p">[]</span>

    <span class="n">MasterForderList</span><span class="o">=</span><span class="p">[]</span>

    <span class="c1"># loop over each possible tree root</span>
    <span class="k">for</span> <span class="n">r</span><span class="p">,</span><span class="n">root</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">MasterTree</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">MasterTree</span><span class="p">[</span><span class="n">r</span><span class="p">])</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">SolvedOrder</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>

        <span class="c1"># determine leaf and branch bags</span>
        <span class="n">LeafStack</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">BranchStack</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">root</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">MasterTree</span><span class="p">[</span><span class="n">e</span><span class="p">])</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">LeafStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">BranchStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="c1"># bundle all leaf bags together</span>
        <span class="c1"># the order of the leaf bag contraction does not matter</span>
        <span class="n">BranchStack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">LeafStack</span><span class="p">)</span>

        <span class="c1"># permute over all possible branch contractions</span>
        <span class="n">orderings</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">permutations</span><span class="p">(</span><span class="n">BranchStack</span><span class="p">))</span>

        <span class="c1"># test to see which order is faster</span>
        <span class="n">OrderSize</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">ForderList</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">ordering</span> <span class="ow">in</span> <span class="n">orderings</span><span class="p">:</span>
            <span class="n">order</span><span class="o">=</span><span class="p">[]</span>
            <span class="c1"># create order</span>
            <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">ordering</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                    <span class="n">order</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">o</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">order</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>

            <span class="c1"># recursively test order</span>
            <span class="n">Forder</span><span class="o">=</span><span class="p">[]</span>
            <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">order</span><span class="p">:</span>

                <span class="c1"># if the bag along the branch is not a leaf</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">MasterTree</span><span class="p">[</span><span class="n">o</span><span class="p">])</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
                    <span class="c1"># if this bag has been solved already</span>
                    <span class="c1"># used the cached answer</span>
                    <span class="k">if</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">SolvedOrder</span><span class="p">:</span>
                        <span class="n">OptimumOrder</span><span class="o">=</span><span class="n">SolvedOrder</span><span class="p">[</span><span class="n">o</span><span class="p">]</span>
                        <span class="n">Forder</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">OptimumOrder</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># build subtree to send to recursive function</span>
                        <span class="n">subtree</span><span class="o">=</span><span class="p">[[]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">tree</span><span class="p">))]</span>
                        <span class="n">subtree</span><span class="p">[</span><span class="n">o</span><span class="p">]</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">tree</span><span class="p">[</span><span class="n">o</span><span class="p">])</span>

                        <span class="k">if</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">subtree</span><span class="p">[</span><span class="n">o</span><span class="p">]:</span>
                            <span class="n">subtree</span><span class="p">[</span><span class="n">o</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
                        <span class="n">GrowList</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">subtree</span><span class="p">[</span><span class="n">o</span><span class="p">])</span>
                        <span class="n">SeeList</span><span class="o">=</span><span class="nb">set</span><span class="p">([</span><span class="n">o</span><span class="p">])</span>
                        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">GrowList</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">GrowList</span><span class="p">):</span>
                                <span class="n">SeeList</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
                                <span class="n">subtree</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">tree</span><span class="p">[</span><span class="n">n</span><span class="p">])</span>
                                <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">tree</span><span class="p">[</span><span class="n">n</span><span class="p">]:</span>
                                    <span class="n">GrowList</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

                            <span class="n">GrowList</span><span class="o">=</span><span class="n">GrowList</span><span class="o">-</span><span class="n">SeeList</span>

                        <span class="c1"># send to recursive function</span>
                        <span class="n">OptimumOrder</span><span class="o">=</span><span class="n">GetOrder</span><span class="p">(</span><span class="n">o</span><span class="p">,</span><span class="n">bags</span><span class="p">,</span><span class="n">subtree</span><span class="p">,</span><span class="n">MasterTree</span><span class="p">,</span><span class="n">SolvedOrder</span><span class="p">)</span>
                        <span class="c1"># when recursive function returns, insert it into current</span>
                        <span class="c1"># Forder to be evaluated,</span>
                        <span class="c1"># and cache the result in SolvedOrder</span>
                        <span class="n">Forder</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">OptimumOrder</span><span class="p">)</span>
                        <span class="n">SolvedOrder</span><span class="p">[</span><span class="n">o</span><span class="p">]</span><span class="o">=</span><span class="n">OptimumOrder</span>

                <span class="c1"># add bag into contraction order</span>
                <span class="n">Forder</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
            <span class="c1"># add contraction order to list of contraction orders to test</span>
            <span class="n">ForderList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">Forder</span><span class="p">))</span>
            <span class="c1"># measure the computational complexity of the current order, and</span>
            <span class="c1"># save to a list</span>
            <span class="n">OrderSize</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">GetOrderSize</span><span class="p">(</span><span class="n">Forder</span><span class="p">,</span><span class="n">bags</span><span class="p">,</span><span class="n">MasterTree</span><span class="p">))</span>

        <span class="c1"># extract the best order</span>
        <span class="n">BestOrder</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">OrderSize</span><span class="p">)</span>
        <span class="c1"># return the best order</span>
        <span class="c1"># print(OrderSize)</span>
        <span class="c1"># print(&#39;Prime BestOrder=&#39;+str(BestOrder))</span>
        <span class="c1"># print(ForderList[BestOrder])</span>
        <span class="c1"># print(&#39;root=&#39;+str(r))</span>

        <span class="n">order</span><span class="o">=</span><span class="n">ForderList</span><span class="p">[</span><span class="n">BestOrder</span><span class="p">]</span>
        <span class="n">order</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

        <span class="c1"># add best order for root r into the list</span>
        <span class="n">MasterForderList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">order</span><span class="p">))</span>
        <span class="n">MasterOrderSize</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">GetOrderSize</span><span class="p">(</span><span class="n">order</span><span class="p">,</span><span class="n">bags</span><span class="p">,</span><span class="n">MasterTree</span><span class="p">))</span>
        <span class="c1"># print(MasterOrderSize)</span>

    <span class="c1"># print(MasterForderList[numpy.argmin(MasterOrderSize)])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Obtained Smallest Path Contraction&#39;</span><span class="p">)</span>

    <span class="c1"># find the best bag tree root</span>
    <span class="n">order</span><span class="o">=</span><span class="n">MasterForderList</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">MasterOrderSize</span><span class="p">)]</span>
    <span class="n">size</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">MasterOrderSize</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">order</span><span class="p">,</span><span class="n">size</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>This module determines the best edge contraction order to use if a tree decomposition is given. The returned order optimizes for pathwidth</p>

<h6 id="functions">Functions</h6>

<p><strong>ContractionOrder(bags,tree) :</strong> <br />
    Main function to determine the optimal contraction ordering from a tree decomposition.</p>

<p><strong>GetOrder(r,bags,tree,MasterTree,SolvedOrder) :</strong> <br />
    Recursive function for determining the optimal contraction ordering.</p>

<p><strong>GetOrderSize(order,bags,tree,verbose=False) :</strong> <br />
    Function for measuring the computational complexity of a given ordering.</p>

<p><strong>GetNodeOrdering(order,bags,tree,verbose=False) :</strong> <br />
    Function to convert a bag ordering into a node ordering.</p>

<h6 id="notes">Notes</h6>

<p>Bag order is optimized using a greed local optimization recursive algorithm.</p>

<p>Node contraction order within a bag is not optimized.</p>

<h6 id="examples">Examples</h6>

<div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ContractionOrdering</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bags</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="go">            [1, 2, 3],</span>
<span class="go">            [2, 4, 5],</span>
<span class="go">            [2, 3, 5],</span>
<span class="go">            [3, 5, 6]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tree</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">],</span>
<span class="go">            [0, 3],</span>
<span class="go">            [3],</span>
<span class="go">            [1, 2, 4],</span>
<span class="go">            [3]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">order</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">ContractionOrdering</span><span class="o">.</span><span class="n">ContractionOrder</span><span class="p">(</span><span class="n">bags</span><span class="p">,</span><span class="n">tree</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">NodeOrder</span><span class="p">,</span><span class="n">PathWidthSize</span><span class="o">=</span><span class="n">ContractionOrdering</span><span class="o">.</span><span class="n">GetNodeOrdering</span><span class="p">(</span><span class="n">order</span><span class="p">,</span><span class="n">bags</span><span class="p">,</span><span class="n">tree</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>
</div>


                </section>
                <section id="ICOSSAR_2021_analysis">
                                <div class="attr module"><a class="headerlink" href="#ICOSSAR_2021_analysis">#&nbsp;&nbsp</a>
<span class="name"><a href="ICOSSAR_2021/ICOSSAR_2021_analysis.html">ICOSSAR_2021.ICOSSAR_2021_analysis</a></span></div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">This module contains functions to initiate the analysis for the ICOSSAR 2021 paper.</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="c1"># ensures local modules are imported properly</span>
<span class="n">cwd</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">cwd</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">numpy</span>

<span class="kn">import</span> <span class="nn">networkx</span>

<span class="kn">import</span> <span class="nn">cubic_graph_utilities</span>
<span class="kn">import</span> <span class="nn">reliability</span>

<span class="k">def</span> <span class="nf">MCtrials_vs_e</span><span class="p">():</span>
    <span class="c1"># calculates the number of monte carlo trials needed to exclude e</span>

    <span class="c1"># Evenly sample ptrue values along the log scale</span>
    <span class="n">S</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">1000000</span><span class="p">),</span><span class="n">numpy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="mi">100</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>

    <span class="n">NN</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;analysis/MCtheory&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">S</span><span class="p">:</span>
        <span class="c1"># convert to true ptrue value</span>
        <span class="n">pt</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span>
        <span class="n">Ne</span><span class="o">=</span><span class="p">[</span><span class="n">pt</span><span class="p">]</span>
        <span class="c1"># for a few e values</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">1.10</span><span class="p">,</span><span class="mf">1.05</span><span class="p">,</span><span class="mf">1.01</span><span class="p">]:</span>

            <span class="n">P0</span><span class="o">=</span><span class="n">pt</span><span class="o">/</span><span class="n">e</span>

            <span class="c1"># chi squared values for 95% confidence interval</span>
            <span class="n">C2</span><span class="o">=</span><span class="mf">1.9205</span>
            <span class="c1"># determine number of needed MC trials NT</span>
            <span class="n">NT</span><span class="o">=</span><span class="n">C2</span><span class="o">/</span><span class="p">(</span><span class="n">pt</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">pt</span><span class="p">)</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">pt</span><span class="p">)</span><span class="o">-</span><span class="n">pt</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">P0</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">pt</span><span class="p">)</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">P0</span><span class="p">))</span>

            <span class="n">Ne</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">NT</span><span class="p">)</span>

        <span class="n">NN</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Ne</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Ne</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Ne</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Ne</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Ne</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">GridRel_vs_n</span><span class="p">():</span>
    <span class="c1"># 3 different edge reliabilities</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">.5</span><span class="p">,</span><span class="mf">.9</span><span class="p">,</span><span class="mf">.99</span><span class="p">]:</span>
        <span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;analysis/GridsNvary&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="mi">100</span><span class="p">)),</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="c1"># different grid sizes</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">13</span><span class="p">):</span>
            <span class="c1"># make grid edge list</span>
            <span class="n">n1</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="n">n2</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="n">EdgeList</span><span class="o">=</span><span class="p">[]</span>
            <span class="k">for</span> <span class="n">k1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n1</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">k2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n2</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                    <span class="n">EdgeList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">n2</span><span class="o">*</span><span class="n">k1</span><span class="o">+</span><span class="n">k2</span><span class="p">,</span><span class="n">n2</span><span class="o">*</span><span class="n">k1</span><span class="o">+</span><span class="n">k2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">p</span><span class="p">))</span>

            <span class="k">for</span> <span class="n">k1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n1</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">k2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n2</span><span class="p">):</span>
                    <span class="n">EdgeList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">n2</span><span class="o">*</span><span class="n">k1</span><span class="o">+</span><span class="n">k2</span><span class="p">,</span><span class="n">n2</span><span class="o">*</span><span class="p">(</span><span class="n">k1</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">k2</span><span class="p">,</span><span class="n">p</span><span class="p">))</span>

            <span class="n">EdgeList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

            <span class="c1"># get grid Edge Cover values</span>
            <span class="n">Result</span><span class="o">=</span><span class="n">reliability</span><span class="o">.</span><span class="n">EdgeCover</span><span class="p">(</span><span class="n">EdgeList</span><span class="p">,</span><span class="n">ECverbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">TreeWidthCalcTime</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">EC</span><span class="o">=</span><span class="n">Result</span><span class="p">[</span><span class="s1">&#39;EC&#39;</span><span class="p">]</span>
            <span class="n">CalculationEffortEC</span><span class="o">=</span><span class="n">Result</span><span class="p">[</span><span class="s1">&#39;CalculationEffort&#39;</span><span class="p">]</span>
            <span class="n">ECtime</span><span class="o">=</span><span class="n">Result</span><span class="p">[</span><span class="s1">&#39;ECtime&#39;</span><span class="p">]</span>

            <span class="c1"># get grid All Terminal Reliability values</span>
            <span class="n">Result</span><span class="o">=</span><span class="n">reliability</span><span class="o">.</span><span class="n">ATR</span><span class="p">(</span><span class="n">EdgeList</span><span class="p">,</span><span class="n">ATRverbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">TreeWidthCalcTime</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">REL</span><span class="o">=</span><span class="n">Result</span><span class="p">[</span><span class="s1">&#39;REL&#39;</span><span class="p">]</span>
            <span class="n">CalculationEffortREL</span><span class="o">=</span><span class="n">Result</span><span class="p">[</span><span class="s1">&#39;CalculationEffort&#39;</span><span class="p">]</span>
            <span class="n">RELtime</span><span class="o">=</span><span class="n">Result</span><span class="p">[</span><span class="s1">&#39;RELtime&#39;</span><span class="p">]</span>

            <span class="nb">print</span><span class="p">(</span><span class="n">EC</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">REL</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">REL</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">EC</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">REL</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">RELtime</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">CalculationEffortREL</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">EC</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ECtime</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">CalculationEffortEC</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">GridRel_vs_n_MCtrials</span><span class="p">():</span>
    <span class="c1"># for each tested edge reliability</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">.5</span><span class="p">,</span><span class="mf">.9</span><span class="p">,</span><span class="mf">.99</span><span class="p">]:</span>
        <span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;analysis/GridsNvary&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="mi">100</span><span class="p">)),</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">=</span><span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;analysis/GridsNvaryMCTRIALS&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="mi">100</span><span class="p">)),</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="n">data</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>

            <span class="n">pt</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">P0</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>

            <span class="n">C2</span><span class="o">=</span><span class="mf">1.9205</span>
            <span class="n">NT</span><span class="o">=</span><span class="n">C2</span><span class="o">/</span><span class="p">(</span><span class="n">pt</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">pt</span><span class="p">)</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">pt</span><span class="p">)</span><span class="o">-</span><span class="n">pt</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">P0</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">pt</span><span class="p">)</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">P0</span><span class="p">))</span>

            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">l</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">NT</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">GridRel_vs_len</span><span class="p">():</span>
    <span class="c1"># 3 different edge reliabilities</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">.5</span><span class="p">,</span><span class="mf">.9</span><span class="p">,</span><span class="mf">.99</span><span class="p">]:</span>
        <span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;analysis/GridsLvary&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="mi">100</span><span class="p">)),</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="c1"># different grid lengths</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">65</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="n">n1</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="n">n2</span><span class="o">=</span><span class="mi">8</span> <span class="c1"># assume grid 8 noded wide</span>
            <span class="n">EdgeList</span><span class="o">=</span><span class="p">[]</span>
            <span class="k">for</span> <span class="n">k1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n1</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">k2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n2</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                    <span class="n">EdgeList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">n2</span><span class="o">*</span><span class="n">k1</span><span class="o">+</span><span class="n">k2</span><span class="p">,</span><span class="n">n2</span><span class="o">*</span><span class="n">k1</span><span class="o">+</span><span class="n">k2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">p</span><span class="p">))</span>

            <span class="k">for</span> <span class="n">k1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n1</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">k2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n2</span><span class="p">):</span>
                    <span class="n">EdgeList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">n2</span><span class="o">*</span><span class="n">k1</span><span class="o">+</span><span class="n">k2</span><span class="p">,</span><span class="n">n2</span><span class="o">*</span><span class="p">(</span><span class="n">k1</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">k2</span><span class="p">,</span><span class="n">p</span><span class="p">))</span>

            <span class="n">EdgeList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="n">Result</span><span class="o">=</span><span class="n">reliability</span><span class="o">.</span><span class="n">EdgeCover</span><span class="p">(</span><span class="n">EdgeList</span><span class="p">,</span><span class="n">ECverbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">TreeWidthCalcTime</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">EC</span><span class="o">=</span><span class="n">Result</span><span class="p">[</span><span class="s1">&#39;EC&#39;</span><span class="p">]</span>
            <span class="n">CalculationEffortEC</span><span class="o">=</span><span class="n">Result</span><span class="p">[</span><span class="s1">&#39;CalculationEffort&#39;</span><span class="p">]</span>
            <span class="n">ECtime</span><span class="o">=</span><span class="n">Result</span><span class="p">[</span><span class="s1">&#39;ECtime&#39;</span><span class="p">]</span>

            <span class="n">Result</span><span class="o">=</span><span class="n">reliability</span><span class="o">.</span><span class="n">ATR</span><span class="p">(</span><span class="n">EdgeList</span><span class="p">,</span><span class="n">ATRverbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">TreeWidthCalcTime</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">REL</span><span class="o">=</span><span class="n">Result</span><span class="p">[</span><span class="s1">&#39;REL&#39;</span><span class="p">]</span>
            <span class="n">CalculationEffortREL</span><span class="o">=</span><span class="n">Result</span><span class="p">[</span><span class="s1">&#39;CalculationEffort&#39;</span><span class="p">]</span>
            <span class="n">RELtime</span><span class="o">=</span><span class="n">Result</span><span class="p">[</span><span class="s1">&#39;RELtime&#39;</span><span class="p">]</span>

            <span class="nb">print</span><span class="p">(</span><span class="n">EC</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">REL</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">REL</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">EC</span><span class="p">))</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">REL</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">RELtime</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">CalculationEffortREL</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">EC</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ECtime</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">CalculationEffortEC</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">GridRel_vs_len_MCtrials</span><span class="p">():</span>
    <span class="c1"># for each tested edge reliability</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">.5</span><span class="p">,</span><span class="mf">.9</span><span class="p">,</span><span class="mf">.99</span><span class="p">]:</span>
        <span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;analysis/GridsLvary&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="mi">100</span><span class="p">)),</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">=</span><span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;analysis/GridsLvaryMCTRIALS&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="mi">100</span><span class="p">)),</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="n">data</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>

            <span class="n">pt</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">P0</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>

            <span class="n">C2</span><span class="o">=</span><span class="mf">1.9205</span>
            <span class="n">NT</span><span class="o">=</span><span class="n">C2</span><span class="o">/</span><span class="p">(</span><span class="n">pt</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">pt</span><span class="p">)</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">pt</span><span class="p">)</span><span class="o">-</span><span class="n">pt</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">P0</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">pt</span><span class="p">)</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">P0</span><span class="p">))</span>

            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">l</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">NT</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">InfRepeat</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="c1"># k=0</span>

    <span class="c1"># check which graph IDS have already been processed</span>
    <span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;analysis/TreeWidthData-&#39;</span><span class="o">+</span><span class="n">filename</span><span class="p">[</span><span class="n">filename</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;/&quot;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:],</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">IDlist</span><span class="o">=</span><span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">l</span><span class="o">=</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
        <span class="n">IDlist</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="c1"># load the graph from the text file into memory</span>
    <span class="c1"># yield value for parallel processing</span>
    <span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">l</span><span class="o">=</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">IDlist</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">EdgeList</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">edges</span><span class="o">=</span><span class="n">l</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ee</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">ee</span><span class="o">=</span><span class="n">ee</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
            <span class="n">EdgeList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">ee</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="nb">int</span><span class="p">(</span><span class="n">ee</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">ee</span><span class="p">[</span><span class="mi">2</span><span class="p">])))</span>
        <span class="c1"># print((EdgeList,l[0],l[1]))</span>
        <span class="k">yield</span> <span class="p">(</span><span class="n">EdgeList</span><span class="p">,</span><span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="c1"># yield (int(numpy.random.randint(10,201)*2),str(k))</span>
        <span class="c1"># k=k+1</span>

<span class="k">def</span> <span class="nf">CubicGraphTreeWidths</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">multiprocessing</span>
    <span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="kn">import</span> <span class="n">Pool</span>

    <span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;analysis/TreeWidthData-&#39;</span><span class="o">+</span><span class="n">filename</span><span class="p">[</span><span class="n">filename</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;/&quot;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:],</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="c1"># filename=&quot;ConnectedRandomCubic-0-10000-Vmin-20-Vmax-400-seed-42&quot;</span>
    <span class="c1"># for n in InfRepeat(filename):</span>
    <span class="c1">#     G=cubic_graph_utilities.CubicTreeWidthParallel(n)</span>
    <span class="c1">#     file.write(str(G[0])+&#39;|&#39;+str(G[1])+&#39;|&#39;+str(G[2])+&#39;|&#39;+str(G[3])+&#39;|&#39;+str(G[4])+&#39;\n&#39;)</span>
    <span class="c1">#     file.flush()</span>
    <span class="c1">#     os.fsync(file)</span>
    <span class="c1">#     print(G)</span>

    <span class="n">cores</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">multiprocessing</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="n">processes</span><span class="o">=</span><span class="n">cores</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">G</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">imap_unordered</span><span class="p">(</span><span class="n">cubic_graph_utilities</span><span class="o">.</span><span class="n">CubicTreeWidthParallel</span><span class="p">,</span> <span class="n">InfRepeat</span><span class="p">(</span><span class="n">filename</span><span class="p">)):</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">G</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">G</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">G</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">G</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">G</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="n">os</span><span class="o">.</span><span class="n">fsync</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>


        <span class="c1"># if G[1]!=&#39;Error&#39; and G[2]!=&#39;Error&#39;:</span>
        <span class="c1">#     file.write(str(G[0])+&#39;|&#39;+str(G[1])+&#39;|&#39;+str(G[2])+&#39;|&#39;+str(G[3])+&#39;\n&#39;)</span>
        <span class="c1">#     file.flush()</span>
        <span class="c1">#     os.fsync(file)</span>
        <span class="c1">#     print(G)</span>

    <span class="n">p</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">RandomCubicFileRead</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="n">edge_reliability</span><span class="o">=</span><span class="mf">.99</span><span class="p">):</span>
    <span class="c1"># k=0</span>

    <span class="c1"># check which graph IDS have already been processed</span>
    <span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;analysis/Rcubic-&#39;</span><span class="o">+</span><span class="n">filename</span><span class="p">[</span><span class="n">filename</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;/&quot;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:],</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">IDlist</span><span class="o">=</span><span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">l</span><span class="o">=</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
        <span class="n">IDlist</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="c1"># load the graph from the text file into memory</span>
    <span class="c1"># yield value for parallel processing</span>
    <span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">l</span><span class="o">=</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">IDlist</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">EdgeList</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">edges</span><span class="o">=</span><span class="n">l</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ee</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">ee</span><span class="o">=</span><span class="n">ee</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
            <span class="n">EdgeList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">ee</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="nb">int</span><span class="p">(</span><span class="n">ee</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">edge_reliability</span><span class="p">)))</span>
        <span class="c1"># print((EdgeList,l[0],l[1]))</span>
        <span class="k">yield</span> <span class="p">(</span><span class="n">EdgeList</span><span class="p">,</span><span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="c1"># yield (int(numpy.random.randint(10,201)*2),str(k))</span>
        <span class="c1"># k=k+1</span>

<span class="k">def</span> <span class="nf">RandomCubicRelProcess</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="c1"># while True:</span>
    <span class="c1">#     try:</span>
    <span class="n">EdgeList</span><span class="o">=</span><span class="n">n</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">k</span><span class="o">=</span><span class="n">n</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">Result</span><span class="o">=</span><span class="n">reliability</span><span class="o">.</span><span class="n">EdgeCover</span><span class="p">(</span><span class="n">EdgeList</span><span class="p">,</span><span class="n">ECverbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">TreeWidthCalcTime</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">ID</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
    <span class="n">EC</span><span class="o">=</span><span class="n">Result</span><span class="p">[</span><span class="s1">&#39;EC&#39;</span><span class="p">]</span>
    <span class="n">CalculationEffortEC</span><span class="o">=</span><span class="n">Result</span><span class="p">[</span><span class="s1">&#39;CalculationEffort&#39;</span><span class="p">]</span>
    <span class="n">ECtime</span><span class="o">=</span><span class="n">Result</span><span class="p">[</span><span class="s1">&#39;ECtime&#39;</span><span class="p">]</span>
    <span class="n">LineGraphWidth</span><span class="o">=</span><span class="n">Result</span><span class="p">[</span><span class="s1">&#39;LineGraphWidth&#39;</span><span class="p">]</span>

    <span class="n">Result</span><span class="o">=</span><span class="n">reliability</span><span class="o">.</span><span class="n">ATR</span><span class="p">(</span><span class="n">EdgeList</span><span class="p">,</span><span class="n">ATRverbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">TreeWidthCalcTime</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">ID</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
    <span class="n">REL</span><span class="o">=</span><span class="n">Result</span><span class="p">[</span><span class="s1">&#39;REL&#39;</span><span class="p">]</span>
    <span class="n">CalculationEffortREL</span><span class="o">=</span><span class="n">Result</span><span class="p">[</span><span class="s1">&#39;CalculationEffort&#39;</span><span class="p">]</span>
    <span class="n">RELtime</span><span class="o">=</span><span class="n">Result</span><span class="p">[</span><span class="s1">&#39;RELtime&#39;</span><span class="p">]</span>
    <span class="n">TreeWidthSize</span><span class="o">=</span><span class="n">Result</span><span class="p">[</span><span class="s1">&#39;TreeWidthSize&#39;</span><span class="p">]</span>
    <span class="n">PathWidthSize</span><span class="o">=</span><span class="n">Result</span><span class="p">[</span><span class="s1">&#39;PathWidthSize&#39;</span><span class="p">]</span>

    <span class="n">EL</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">EdgeList</span><span class="p">:</span>
        <span class="n">EL</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="n">G</span><span class="o">=</span><span class="n">networkx</span><span class="o">.</span><span class="n">from_edgelist</span><span class="p">(</span><span class="n">EL</span><span class="p">)</span>
    <span class="n">G6</span><span class="o">=</span><span class="n">networkx</span><span class="o">.</span><span class="n">to_graph6_bytes</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">R</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>
    <span class="n">R</span><span class="p">[</span><span class="s1">&#39;k&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="n">R</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">R</span><span class="p">[</span><span class="s1">&#39;G6&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">G6</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">R</span><span class="p">[</span><span class="s1">&#39;REL&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">REL</span><span class="p">)</span>
    <span class="n">R</span><span class="p">[</span><span class="s1">&#39;RELtime&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">RELtime</span><span class="p">)</span>
    <span class="n">R</span><span class="p">[</span><span class="s1">&#39;TreeWidthSize&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">TreeWidthSize</span><span class="p">)</span>
    <span class="n">R</span><span class="p">[</span><span class="s1">&#39;PathWidthSize&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">PathWidthSize</span><span class="p">)</span>
    <span class="n">R</span><span class="p">[</span><span class="s1">&#39;CalculationEffortREL&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">CalculationEffortREL</span><span class="p">)</span>
    <span class="n">R</span><span class="p">[</span><span class="s1">&#39;EC&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">EC</span><span class="p">)</span>
    <span class="n">R</span><span class="p">[</span><span class="s1">&#39;ECtime&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">ECtime</span><span class="p">)</span>
    <span class="n">R</span><span class="p">[</span><span class="s1">&#39;LineGraphWidth&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">LineGraphWidth</span><span class="p">)</span>
    <span class="n">R</span><span class="p">[</span><span class="s1">&#39;CalculationEffortEC&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">CalculationEffortEC</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">R</span>
        <span class="c1"># except:</span>
        <span class="c1">#     pass</span>

<span class="k">def</span> <span class="nf">RandomCubicRel</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="n">edge_reliability</span><span class="o">=</span><span class="mf">.99</span><span class="p">):</span>

    <span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;analysis/Rcubic-&#39;</span><span class="o">+</span><span class="n">filename</span><span class="p">[</span><span class="n">filename</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;/&quot;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:],</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>

    <span class="c1"># for n in RandomCubicFileRead(filename):</span>
    <span class="c1">#     R=RandomCubicRelProcess(n)</span>
    <span class="c1">#     file.write(R[&#39;k&#39;]+&#39;|&#39;)</span>
    <span class="c1">#     file.write(R[&#39;n&#39;]+&#39;|&#39;)</span>
    <span class="c1">#     file.write(R[&#39;G6&#39;]+&#39;|&#39;)</span>
    <span class="c1">#     file.write(R[&#39;REL&#39;]+&#39;|&#39;)</span>
    <span class="c1">#     file.write(R[&#39;RELtime&#39;]+&#39;|&#39;)</span>
    <span class="c1">#     file.write(R[&#39;TreeWidthSize&#39;]+&#39;|&#39;)</span>
    <span class="c1">#     file.write(R[&#39;PathWidthSize&#39;]+&#39;|&#39;)</span>
    <span class="c1">#     file.write(R[&#39;CalculationEffortREL&#39;]+&#39;|&#39;)</span>
    <span class="c1">#     file.write(R[&#39;EC&#39;]+&#39;|&#39;)</span>
    <span class="c1">#     file.write(R[&#39;ECtime&#39;]+&#39;|&#39;)</span>
    <span class="c1">#     file.write(R[&#39;LineGraphWidth&#39;]+&#39;|&#39;)</span>
    <span class="c1">#     file.write(R[&#39;CalculationEffortEC&#39;]+&#39;\n&#39;)</span>
    <span class="c1">#     file.flush()</span>
    <span class="c1">#     os.fsync(file)</span>

    <span class="kn">import</span> <span class="nn">multiprocessing</span>
    <span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="kn">import</span> <span class="n">Pool</span>
    <span class="n">cores</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">multiprocessing</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="n">processes</span><span class="o">=</span><span class="n">cores</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">R</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">imap</span><span class="p">(</span><span class="n">RandomCubicRelProcess</span><span class="p">,</span> <span class="n">RandomCubicFileRead</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="n">edge_reliability</span><span class="p">)):</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="s1">&#39;k&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="s1">&#39;G6&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="s1">&#39;REL&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="s1">&#39;RELtime&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="s1">&#39;TreeWidthSize&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="s1">&#39;PathWidthSize&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="s1">&#39;CalculationEffortREL&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="s1">&#39;EC&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="s1">&#39;ECtime&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="s1">&#39;LineGraphWidth&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="s1">&#39;CalculationEffortEC&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="n">os</span><span class="o">.</span><span class="n">fsync</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">RandomCubicRel_MCtrials</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;analysis/Rcubic-&#39;</span><span class="o">+</span><span class="n">filename</span><span class="p">[</span><span class="n">filename</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;/&quot;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:],</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">lines</span><span class="o">=</span><span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;analysis/RcubicMCTRIALS-&#39;</span><span class="o">+</span><span class="n">filename</span><span class="p">[</span><span class="n">filename</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;/&quot;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:],</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="n">data</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
        <span class="c1"># sometimes the G6 format string contains a &#39;|&#39;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">==</span><span class="mi">12</span><span class="p">:</span>
            <span class="n">pt</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
            <span class="n">P0</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">8</span><span class="p">])</span>
            <span class="n">D</span><span class="o">=</span><span class="n">data</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">D</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">:])</span>

        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">==</span><span class="mi">13</span><span class="p">:</span>
            <span class="n">pt</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
            <span class="n">P0</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">9</span><span class="p">])</span>
            <span class="n">D</span><span class="o">=</span><span class="n">data</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">D</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">:])</span>

        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">13</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
            <span class="nb">input</span><span class="p">()</span>

        <span class="n">C2</span><span class="o">=</span><span class="mf">1.9205</span>
        <span class="c1"># print(l)</span>
        <span class="k">if</span> <span class="n">P0</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
            <span class="nb">input</span><span class="p">()</span>
        <span class="n">NT</span><span class="o">=</span><span class="n">C2</span><span class="o">/</span><span class="p">(</span><span class="n">pt</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">pt</span><span class="p">)</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">pt</span><span class="p">)</span><span class="o">-</span><span class="n">pt</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">P0</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">pt</span><span class="p">)</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">P0</span><span class="p">))</span>

        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">D</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">NT</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">PowerGridsREL</span><span class="p">():</span>
    <span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;data/PowerGrids&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">lines</span><span class="o">=</span><span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">.5</span><span class="p">,</span><span class="mf">.9</span><span class="p">,</span><span class="mf">.99</span><span class="p">]:</span>
        <span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;analysis/PowerGridsREL&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="mi">100</span><span class="p">)),</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">II</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span> <span class="c1">#59</span>
            <span class="n">data</span><span class="o">=</span><span class="n">II</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>

            <span class="c1"># Trivial or unsolvable power grid instances</span>
            <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">==</span><span class="mi">27</span> <span class="ow">or</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">==</span><span class="mi">54</span> <span class="ow">or</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">==</span><span class="mi">57</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">G</span><span class="o">=</span><span class="nb">eval</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">EdgeList</span><span class="o">=</span><span class="p">[]</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">G</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">G</span><span class="p">[</span><span class="n">n</span><span class="p">]:</span>
                    <span class="n">Edge</span><span class="o">=</span><span class="p">[</span><span class="n">n</span><span class="p">,</span><span class="n">e</span><span class="p">]</span>
                    <span class="n">Edge</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
                    <span class="n">EdgeList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">Edge</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">Edge</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">p</span><span class="p">))</span>
            <span class="n">EdgeList</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">EdgeList</span><span class="p">))</span>
            <span class="n">EdgeList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

            <span class="n">Result</span><span class="o">=</span><span class="n">reliability</span><span class="o">.</span><span class="n">EdgeCover</span><span class="p">(</span><span class="n">EdgeList</span><span class="p">,</span><span class="n">ECverbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">TreeWidthCalcTime</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
            <span class="n">EC</span><span class="o">=</span><span class="n">Result</span><span class="p">[</span><span class="s1">&#39;EC&#39;</span><span class="p">]</span>
            <span class="n">CalculationEffortEC</span><span class="o">=</span><span class="n">Result</span><span class="p">[</span><span class="s1">&#39;CalculationEffort&#39;</span><span class="p">]</span>
            <span class="n">ECtime</span><span class="o">=</span><span class="n">Result</span><span class="p">[</span><span class="s1">&#39;ECtime&#39;</span><span class="p">]</span>
            <span class="n">LineGraphWidth</span><span class="o">=</span><span class="n">Result</span><span class="p">[</span><span class="s1">&#39;LineGraphWidth&#39;</span><span class="p">]</span>

            <span class="n">Result</span><span class="o">=</span><span class="n">reliability</span><span class="o">.</span><span class="n">ATR</span><span class="p">(</span><span class="n">EdgeList</span><span class="p">,</span><span class="n">ATRverbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">TreeWidthCalcTime</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
            <span class="n">REL</span><span class="o">=</span><span class="n">Result</span><span class="p">[</span><span class="s1">&#39;REL&#39;</span><span class="p">]</span>
            <span class="n">CalculationEffortREL</span><span class="o">=</span><span class="n">Result</span><span class="p">[</span><span class="s1">&#39;CalculationEffort&#39;</span><span class="p">]</span>
            <span class="n">RELtime</span><span class="o">=</span><span class="n">Result</span><span class="p">[</span><span class="s1">&#39;RELtime&#39;</span><span class="p">]</span>
            <span class="n">TreeWidthSize</span><span class="o">=</span><span class="n">Result</span><span class="p">[</span><span class="s1">&#39;TreeWidthSize&#39;</span><span class="p">]</span>
            <span class="n">PathWidthSize</span><span class="o">=</span><span class="n">Result</span><span class="p">[</span><span class="s1">&#39;PathWidthSize&#39;</span><span class="p">]</span>

            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">G</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">EdgeList</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">REL</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">RELtime</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">TreeWidthSize</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">PathWidthSize</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">CalculationEffortREL</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">EC</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ECtime</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">LineGraphWidth</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">CalculationEffortEC</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
            <span class="n">os</span><span class="o">.</span><span class="n">fsync</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">PowerGridsREL_MCtrials</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">.5</span><span class="p">,</span><span class="mf">.9</span><span class="p">,</span><span class="mf">.99</span><span class="p">]:</span>
        <span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;analysis/PowerGridsREL&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="mi">100</span><span class="p">)),</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">=</span><span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;analysis/PowerGridsRELMC&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="mi">100</span><span class="p">)),</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="n">data</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;NA&#39;</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">pt</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
            <span class="n">P0</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">8</span><span class="p">])</span>

            <span class="n">C2</span><span class="o">=</span><span class="mf">1.9205</span>
            <span class="n">NT</span><span class="o">=</span><span class="n">C2</span><span class="o">/</span><span class="p">(</span><span class="n">pt</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">pt</span><span class="p">)</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">pt</span><span class="p">)</span><span class="o">-</span><span class="n">pt</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">P0</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">pt</span><span class="p">)</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">P0</span><span class="p">))</span>

            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">l</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">NT</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;data/ConnectedRandomCubic-0-10000-Vmin-20-Vmax-50-seed-64&quot;</span>
    <span class="c1"># RandomCubicRel_MCtrials(filename)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">gen</span><span class="o">=</span><span class="n">RandomCubicFileRead</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="s1">&#39;656&#39;</span>
    <span class="n">Clist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;615&#39;</span><span class="p">,</span><span class="s1">&#39;4986&#39;</span><span class="p">,</span><span class="s1">&#39;5839&#39;</span><span class="p">,</span><span class="s1">&#39;7786&#39;</span><span class="p">,</span><span class="s1">&#39;8338&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">gen</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">n</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">Clist</span><span class="p">:</span>
            <span class="n">R</span><span class="o">=</span><span class="n">RandomCubicRelProcess</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>This module contains functions to initiate the analysis for the ICOSSAR 2021 paper.</p>
</div>


                </section>
                <section id="cubic_graph_utilities">
                                <div class="attr module"><a class="headerlink" href="#cubic_graph_utilities">#&nbsp;&nbsp</a>
<span class="name"><a href="ICOSSAR_2021/cubic_graph_utilities.html">ICOSSAR_2021.cubic_graph_utilities</a></span></div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">This module contains functions to perform miscellaneous tasks on cubic graphs. Mostly for generating uniform connected random cubic graphs.</span>

<span class="sd">Functions</span>
<span class="sd">---------</span>
<span class="sd">**SetSeed(seed) :**</span>
<span class="sd">    Sets seed of numba runtime</span>

<span class="sd">**ConnectedRandomCubicGenerate(pegs,G) :**</span>
<span class="sd">    numba optimized function for generating random uniform connected random cubic graphs. A 1-Flipper Markov Chain Monte Carlo (MCMC) algorithm is used to uniformly generate these random cubic graphs.</span>
<span class="sd">    Algorithm from:</span>
<span class="sd">    Toms Feder, Adam Guetz, Milena Mihail, and Amin Saberi. A local switch markov chain on given degree graphs with application in connectivity of peer-to-peer networks. In 2006 47th Annual IEEE Symposium on Foundations of Computer Science (FOCS06), pages 69-76. IEEE, 2006</span>
<span class="sd">    Code written by me.</span>

<span class="sd">**ConnectedRandomCubic(n,EP=None) :**</span>
<span class="sd">    Returns a random uniform connected random cubic graph of size n by calling ConnectedRandomCubicGenerate</span>

<span class="sd">**GenConnectedRandomCubic(ID0=0,ID1=10000,Vmin=20,Vmax=400,seed=42) :**</span>
<span class="sd">    Helper function to pre-generate a list of random connected cubic graphs.</span>


<span class="sd">Notes</span>
<span class="sd">-----</span>
<span class="sd">When the graph generation is first executed, numba performs jit compilation. This causes the first execution to take several seconds to run, but the compilation is cached and future runs with different inputs do not need to recompile.</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="c1"># ensures local modules are imported properly</span>
<span class="n">cwd</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">cwd</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span>

<span class="kn">import</span> <span class="nn">general_utilities</span>
<span class="kn">import</span> <span class="nn">ContractionOrdering</span>
<span class="kn">from</span> <span class="nn">tree_width</span> <span class="kn">import</span> <span class="n">TreeWidth</span>

<span class="nd">@jit</span><span class="p">(</span><span class="n">nopython</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">cache</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">SetSeed</span><span class="p">(</span><span class="n">seed</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This function sets the seed of the numba runtime.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    seed : int</span>
<span class="sd">        seeds the numba RNG</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; seed=42</span>
<span class="sd">    &gt;&gt;&gt; SetSeed(seed)</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="k">return</span>

<span class="nd">@jit</span><span class="p">(</span><span class="n">nopython</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">cache</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">ConnectedRandomCubicGenerate</span><span class="p">(</span><span class="n">pegs</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This function generates random uniform connected cubic graphs. A 1-Flipper Markov Chain Monte Carlo (MCMC) algorithm is used to uniformly generate these random cubic graphs.</span>
<span class="sd">    Algorithm from:</span>
<span class="sd">    Toms Feder, Adam Guetz, Milena Mihail, and Amin Saberi. A local switch markov chain on given degree graphs with application in connectivity of peer-to-peer networks. In 2006 47th Annual IEEE Symposium on Foundations of Computer Science (FOCS06), pages 69-76. IEEE, 2006</span>
<span class="sd">    Code written by me.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    pegs : 1D numpy array of size n, int</span>
<span class="sd">        Array containing the sequence of node degrees. Currently is overridden to only generate cubic graphs.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    G : nx(V+1) numpy array, int</span>
<span class="sd">        The randomly generated graph. G[n,0] is the (degree-1) of node n. G[n,1:degree+1] contains the labels of the nodes connected to node n by an edge</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    When the reliability calculation is first executed, numba performs jit compilation. This causes the first execution to take several seconds to run, but the compilation is cached and future runs with different inputs do not need to recompile.</span>

<span class="sd">    Currently just for cubic graphs. Graphs with arbitrary degree sequences can be implemented in the future.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; n=20</span>
<span class="sd">    &gt;&gt;&gt; pegs=numpy.ones(n,dtype=numpy.int8)*3</span>
<span class="sd">    &gt;&gt;&gt; G=ConnectedRandomCubicGenerate(pegs)</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="c1"># sometimes the last two pegs are on the same node, so if this occurs, just try to make another graph</span>
    <span class="n">Error</span><span class="o">=</span><span class="kc">True</span>
    <span class="k">while</span> <span class="n">Error</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>

        <span class="c1"># set the number of pegs on each node to 3</span>
        <span class="n">N</span><span class="o">=</span><span class="n">pegs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">pegs</span><span class="p">[:]</span><span class="o">=</span><span class="mi">3</span>

        <span class="c1"># First build a random spanning tree</span>
        <span class="c1"># this ensures connectivity</span>
        <span class="c1"># Each node is limited to 3 edges</span>
        <span class="n">G</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span><span class="o">*-</span><span class="mi">1</span>
        <span class="n">G</span><span class="p">[:]</span><span class="o">=-</span><span class="mi">1</span>
        <span class="n">G</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>

        <span class="n">Etree</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">Ftree</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>


        <span class="n">TT</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Etree</span><span class="o">==</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">C1</span><span class="o">=</span><span class="n">TT</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">TT</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
        <span class="n">Etree</span><span class="p">[</span><span class="n">C1</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">Ftree</span><span class="p">[</span><span class="n">C1</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">TT</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Ftree</span><span class="o">==</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">C1</span><span class="o">=</span><span class="n">TT</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">TT</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
            <span class="n">TT</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Etree</span><span class="o">==</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">C2</span><span class="o">=</span><span class="n">TT</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">TT</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>

            <span class="n">Etree</span><span class="p">[</span><span class="n">C2</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
            <span class="n">Ftree</span><span class="p">[</span><span class="n">C2</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>

            <span class="n">pegs</span><span class="p">[</span><span class="n">C1</span><span class="p">]</span><span class="o">=</span><span class="n">pegs</span><span class="p">[</span><span class="n">C1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span>
            <span class="n">pegs</span><span class="p">[</span><span class="n">C2</span><span class="p">]</span><span class="o">=</span><span class="n">pegs</span><span class="p">[</span><span class="n">C2</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span>
            <span class="k">if</span> <span class="n">pegs</span><span class="p">[</span><span class="n">C1</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">Ftree</span><span class="p">[</span><span class="n">C1</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
            <span class="k">if</span> <span class="n">pegs</span><span class="p">[</span><span class="n">C2</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">Ftree</span><span class="p">[</span><span class="n">C2</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>

            <span class="n">G</span><span class="p">[</span><span class="n">C1</span><span class="p">,</span><span class="n">G</span><span class="p">[</span><span class="n">C1</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span><span class="o">=</span><span class="n">C2</span>
            <span class="n">G</span><span class="p">[</span><span class="n">C1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">G</span><span class="p">[</span><span class="n">C1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>
            <span class="n">G</span><span class="p">[</span><span class="n">C2</span><span class="p">,</span><span class="n">G</span><span class="p">[</span><span class="n">C2</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span><span class="o">=</span><span class="n">C1</span>
            <span class="n">G</span><span class="p">[</span><span class="n">C2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">G</span><span class="p">[</span><span class="n">C2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>
        <span class="c1"># Finish building the random spanning tree</span>

        <span class="c1">### Randomly connect pegs together</span>
        <span class="n">Pexist</span><span class="o">=</span><span class="mi">1</span>
        <span class="n">Edge</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="o">*</span><span class="mi">9</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
        <span class="c1"># loop for number of needed edges (hardcoded for cubic)</span>
        <span class="k">for</span> <span class="n">zz</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">N</span><span class="o">*</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)):</span>
            <span class="n">Edge</span><span class="p">[:]</span><span class="o">=</span><span class="mi">0</span>
            <span class="n">Eix</span><span class="o">=</span><span class="mi">0</span>
            <span class="n">PT</span><span class="o">=</span><span class="mi">0</span>
            <span class="c1"># loop over each possible head and tail node for each edge.</span>
            <span class="c1"># build a list of possible edges to add</span>
            <span class="k">for</span> <span class="n">k1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">pegs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="k">if</span> <span class="n">pegs</span><span class="p">[</span><span class="n">k1</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">for</span> <span class="n">k2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">pegs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                    <span class="k">if</span> <span class="n">pegs</span><span class="p">[</span><span class="n">k2</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="k">if</span> <span class="n">k1</span><span class="o">==</span><span class="n">k2</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="n">bb</span><span class="o">=</span><span class="kc">False</span>
                    <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">k2</span> <span class="o">==</span> <span class="n">G</span><span class="p">[</span><span class="n">k1</span><span class="p">,</span><span class="n">z</span><span class="p">]:</span>
                            <span class="n">bb</span><span class="o">=</span><span class="kc">True</span>
                            <span class="k">break</span>
                    <span class="k">if</span> <span class="n">bb</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">pegs</span><span class="p">[</span><span class="n">k1</span><span class="p">]</span><span class="o">*</span><span class="n">pegs</span><span class="p">[</span><span class="n">k2</span><span class="p">]):</span>
                        <span class="n">Edge</span><span class="p">[</span><span class="n">Eix</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">k1</span>
                        <span class="n">Edge</span><span class="p">[</span><span class="n">Eix</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">k2</span>
                        <span class="n">Eix</span><span class="o">=</span><span class="n">Eix</span><span class="o">+</span><span class="mi">1</span>
            <span class="n">Error</span><span class="o">=</span><span class="kc">False</span>
            <span class="k">if</span> <span class="n">Eix</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;forced loop in spanning tree, trying again&#39;</span><span class="p">)</span>
                <span class="n">Error</span><span class="o">=</span><span class="kc">True</span>
                <span class="k">break</span>
            <span class="c1"># select a random edge to add</span>
            <span class="n">Rix</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Eix</span><span class="p">)</span>

            <span class="n">k1</span><span class="o">=</span><span class="n">Edge</span><span class="p">[</span><span class="n">Rix</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">k2</span><span class="o">=</span><span class="n">Edge</span><span class="p">[</span><span class="n">Rix</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">pegs</span><span class="p">[</span><span class="n">k1</span><span class="p">]</span><span class="o">=</span><span class="n">pegs</span><span class="p">[</span><span class="n">k1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span>
            <span class="n">pegs</span><span class="p">[</span><span class="n">k2</span><span class="p">]</span><span class="o">=</span><span class="n">pegs</span><span class="p">[</span><span class="n">k2</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span>
            <span class="n">ix</span><span class="o">=</span><span class="n">G</span><span class="p">[</span><span class="n">k1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">G</span><span class="p">[</span><span class="n">k1</span><span class="p">,</span><span class="n">ix</span><span class="p">]</span><span class="o">=</span><span class="n">k2</span>
            <span class="n">G</span><span class="p">[</span><span class="n">k1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">G</span><span class="p">[</span><span class="n">k1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>
            <span class="n">ix</span><span class="o">=</span><span class="n">G</span><span class="p">[</span><span class="n">k2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">G</span><span class="p">[</span><span class="n">k2</span><span class="p">,</span><span class="n">ix</span><span class="p">]</span><span class="o">=</span><span class="n">k1</span>
            <span class="n">G</span><span class="p">[</span><span class="n">k2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">G</span><span class="p">[</span><span class="n">k2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>
        <span class="c1">### Finished Randomly connecting pegs together</span>

    <span class="c1">### Edge Mixing: 1-flipper</span>
    <span class="n">Switch</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">Swap</span><span class="o">=</span><span class="mi">0</span>
    <span class="c1"># perform n*log(N) random path selections</span>
    <span class="c1"># viger2005efficient empirically suggests O(n) &quot;SWAPS&quot; are enough</span>
    <span class="c1"># A &quot;SWAP&quot; is a non-rejected edge flip</span>
    <span class="c1"># The log(N) is to ensure more than enough random path selections are performed to ensure O(n) not-rejected &quot;SWAPS&quot; are performed.</span>
    <span class="k">while</span> <span class="n">Switch</span><span class="o">&lt;</span><span class="nb">int</span><span class="p">(</span><span class="n">N</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">N</span><span class="p">)):</span>

        <span class="c1"># find a random path of length 3 (3 edges, 4 nodes)</span>

        <span class="c1"># pick a random starting node, Node 1</span>
        <span class="n">N1</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
        <span class="c1"># pick a random edge to follow, and get Node 2</span>
        <span class="n">E1</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">N2</span><span class="o">=</span><span class="n">G</span><span class="p">[</span><span class="n">N1</span><span class="p">,</span><span class="n">E1</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1"># look at edges off of Node 3</span>
        <span class="n">V1</span><span class="o">=-</span><span class="mi">1</span>
        <span class="n">V2</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">k1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
            <span class="c1"># reject edge if it goes back to Node 1</span>
            <span class="k">if</span> <span class="n">G</span><span class="p">[</span><span class="n">N2</span><span class="p">,</span><span class="n">k1</span><span class="p">]</span><span class="o">==</span><span class="n">N1</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="c1"># reject edge if the node it goes to, Node 3, connects to Node 1</span>
            <span class="n">CONN</span><span class="o">=</span><span class="kc">False</span>
            <span class="k">for</span> <span class="n">k2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">G</span><span class="p">[</span><span class="n">G</span><span class="p">[</span><span class="n">N2</span><span class="p">,</span><span class="n">k1</span><span class="p">],</span><span class="n">k2</span><span class="p">]</span><span class="o">==</span><span class="n">N1</span><span class="p">:</span>
                    <span class="n">CONN</span><span class="o">=</span><span class="kc">True</span>
            <span class="k">if</span> <span class="n">CONN</span><span class="o">==</span><span class="kc">False</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">V1</span><span class="o">==-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">V1</span><span class="o">=</span><span class="n">G</span><span class="p">[</span><span class="n">N2</span><span class="p">,</span><span class="n">k1</span><span class="p">]</span>
                    <span class="n">V2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">G</span><span class="p">[</span><span class="n">N2</span><span class="p">,</span><span class="n">k1</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">V2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">G</span><span class="p">[</span><span class="n">N2</span><span class="p">,</span><span class="n">k1</span><span class="p">]</span>

        <span class="c1"># randomly choose an edge that does not go back to Node 1</span>
        <span class="n">N3</span><span class="o">=</span><span class="n">V2</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)]</span>

        <span class="n">V1</span><span class="o">=-</span><span class="mi">1</span>
        <span class="n">V2</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="c1"># if the prior selected edge was not a rejected edge.</span>
        <span class="k">if</span> <span class="n">N3</span><span class="o">!=-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
                <span class="c1"># reject edge if it goes back to Node 2</span>
                <span class="k">if</span> <span class="n">G</span><span class="p">[</span><span class="n">N3</span><span class="p">,</span><span class="n">k1</span><span class="p">]</span><span class="o">==</span><span class="n">N2</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="c1"># reject edge if the node it goes to, Node 4, connects to Node 2</span>
                <span class="n">CONN</span><span class="o">=</span><span class="kc">False</span>
                <span class="k">for</span> <span class="n">k2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">G</span><span class="p">[</span><span class="n">G</span><span class="p">[</span><span class="n">N3</span><span class="p">,</span><span class="n">k1</span><span class="p">],</span><span class="n">k2</span><span class="p">]</span><span class="o">==</span><span class="n">N2</span><span class="p">:</span>
                        <span class="n">CONN</span><span class="o">=</span><span class="kc">True</span>
                <span class="k">if</span> <span class="n">CONN</span><span class="o">==</span><span class="kc">False</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">V1</span><span class="o">==-</span><span class="mi">1</span><span class="p">:</span>
                        <span class="n">V1</span><span class="o">=</span><span class="n">G</span><span class="p">[</span><span class="n">N3</span><span class="p">,</span><span class="n">k1</span><span class="p">]</span>
                        <span class="n">V2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">G</span><span class="p">[</span><span class="n">N3</span><span class="p">,</span><span class="n">k1</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">V2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">G</span><span class="p">[</span><span class="n">N3</span><span class="p">,</span><span class="n">k1</span><span class="p">]</span>

        <span class="c1"># randomly choose an edge that does not go back to Node 2</span>
        <span class="n">N4</span><span class="o">=</span><span class="n">V2</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)]</span>

        <span class="c1"># swap end nodes, if all chosen edges are valid.</span>
        <span class="k">if</span> <span class="n">N4</span><span class="o">!=-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">G</span><span class="p">[</span><span class="n">N4</span><span class="p">,</span><span class="n">k1</span><span class="p">]</span><span class="o">==</span><span class="n">N3</span><span class="p">:</span>
                    <span class="n">G</span><span class="p">[</span><span class="n">N4</span><span class="p">,</span><span class="n">k1</span><span class="p">]</span><span class="o">=</span><span class="n">N2</span>
                <span class="k">if</span> <span class="n">G</span><span class="p">[</span><span class="n">N3</span><span class="p">,</span><span class="n">k1</span><span class="p">]</span><span class="o">==</span><span class="n">N4</span><span class="p">:</span>
                    <span class="n">G</span><span class="p">[</span><span class="n">N3</span><span class="p">,</span><span class="n">k1</span><span class="p">]</span><span class="o">=</span><span class="n">N1</span>
                <span class="k">if</span> <span class="n">G</span><span class="p">[</span><span class="n">N2</span><span class="p">,</span><span class="n">k1</span><span class="p">]</span><span class="o">==</span><span class="n">N1</span><span class="p">:</span>
                    <span class="n">G</span><span class="p">[</span><span class="n">N2</span><span class="p">,</span><span class="n">k1</span><span class="p">]</span><span class="o">=</span><span class="n">N4</span>
                <span class="k">if</span> <span class="n">G</span><span class="p">[</span><span class="n">N1</span><span class="p">,</span><span class="n">k1</span><span class="p">]</span><span class="o">==</span><span class="n">N2</span><span class="p">:</span>
                    <span class="n">G</span><span class="p">[</span><span class="n">N1</span><span class="p">,</span><span class="n">k1</span><span class="p">]</span><span class="o">=</span><span class="n">N3</span>
            <span class="c1"># count the number of successful flips</span>
            <span class="n">Swap</span><span class="o">=</span><span class="n">Swap</span><span class="o">+</span><span class="mi">1</span>
        <span class="c1"># count the number of attempted flips</span>
        <span class="n">Switch</span><span class="o">=</span><span class="n">Switch</span><span class="o">+</span><span class="mi">1</span>

    <span class="k">return</span> <span class="n">G</span>

<span class="k">def</span> <span class="nf">ConnectedRandomCubic</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">EP</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This is the user called function that generates random uniform connected cubic graphs. It ingests the user desired graph size n, and creates the peg array, degree sequence array, to feed into the ConnectedRandomCubicGenerate function.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    n : int</span>
<span class="sd">        size of the desired random cubic graph. Must be even.</span>

<span class="sd">    EP : float</span>
<span class="sd">        The probability of an edge not failing. This value is set if the user desires the output graph to be probabilistic, usually for reliability measurements.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ee : list of tuples</span>
<span class="sd">        Returns the random cubic graph as an edge list.</span>
<span class="sd">        If EP=None, each tuple contains two values (n1,n2). These are the labels of the nodes connected by that edge.</span>
<span class="sd">        if EP!=None, each tuple contains two values (n1,n2,EP). These are the labels of the nodes connected by that edge, and the probability of the edge not failing EP.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    When the graph generation by ConnectedRandomCubicGenerate is first executed, numba performs jit compilation. This causes the first execution to take several seconds to run, but the compilation is cached and future runs with different inputs do not need to recompile.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; n=20</span>
<span class="sd">    &gt;&gt;&gt; EdgeList=ConnectedRandomCubic(n)</span>

<span class="sd">    &gt;&gt;&gt; n=20</span>
<span class="sd">    &gt;&gt;&gt; EP=0.99</span>
<span class="sd">    &gt;&gt;&gt; EdgeList=ConnectedRandomCubic(n,EP)</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># check to make sure n is even</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">n</span><span class="o">%</span><span class="mi">2</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;n is not even&quot;</span><span class="p">)</span>

    <span class="c1"># set up arrays that go into ConnectedRandomCubic</span>
    <span class="n">pegs</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span><span class="o">*</span><span class="mi">3</span>
    <span class="c1"># G=numpy.ones((n,4),dtype=numpy.int64)*-1</span>
    <span class="c1"># G[:,0]=1</span>

    <span class="n">G</span><span class="o">=</span><span class="n">ConnectedRandomCubicGenerate</span><span class="p">(</span><span class="n">pegs</span><span class="p">)</span>
    <span class="c1"># output an edge list</span>
    <span class="k">if</span> <span class="n">EP</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
        <span class="c1"># if no edge failure rate is specified</span>
        <span class="n">ee</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
                <span class="n">Edge</span><span class="o">=</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">G</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">e</span><span class="p">]]</span>
                <span class="n">Edge</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
                <span class="n">ee</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">Edge</span><span class="p">))</span>
        <span class="n">ee</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">ee</span><span class="p">))</span>
        <span class="n">ee</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># if an edge failure rate is specified</span>
        <span class="n">ee</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
                <span class="n">Edge</span><span class="o">=</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">G</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">e</span><span class="p">]]</span>
                <span class="n">Edge</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
                <span class="n">ee</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">Edge</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">Edge</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">EP</span><span class="p">))</span>
        <span class="n">ee</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">ee</span><span class="p">))</span>
        <span class="n">ee</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">ee</span>

<span class="k">def</span> <span class="nf">GenConnectedRandomCubic</span><span class="p">(</span><span class="n">ID0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ID1</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span><span class="n">Vmin</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">Vmax</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Helper function to generate a file of pre-generated random cubic graphs.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ID0 : int</span>
<span class="sd">        Start ID of generated graphs</span>

<span class="sd">    ID1 : int</span>
<span class="sd">        End ID of generated graphs. ID1-ID0 graphs are generated.</span>

<span class="sd">    Vmin : int</span>
<span class="sd">        Smallest random cubic graph to generate, number of nodes.</span>

<span class="sd">    Vmax : int</span>
<span class="sd">        Largest random cubic graph to generate, number of nodes.</span>

<span class="sd">    seed : int</span>
<span class="sd">        seed for the random cubic graph generation process.</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    file : list of tuples</span>
<span class="sd">        Creates a file in the folder &quot;data&quot; named</span>
<span class="sd">        &quot;ConnectedRandomCubic-&#39;+str(ID0)+&#39;-&#39;+str(ID1)+&#39;-Vmin-&#39;+str(Vmin)+&#39;-Vmax-&#39;+str(Vmax)+&#39;-seed-&#39;+str(seed)&quot;</span>
<span class="sd">        | delimated file.</span>
<span class="sd">        header:</span>
<span class="sd">        Graph ID|Graph size in number of nodes|Edge List deliminated by ;</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Graph sizes between Vmin and Vmax inclusive are uniformly randomly selected.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; ID0=0</span>
<span class="sd">    &gt;&gt;&gt; ID1=10000</span>
<span class="sd">    &gt;&gt;&gt; Vmin=20</span>
<span class="sd">    &gt;&gt;&gt; Vmax=50</span>
<span class="sd">    &gt;&gt;&gt; seed=42</span>
<span class="sd">    &gt;&gt;&gt; GenConnectedRandomCubic(ID0,ID1,Vmin,Vmax,seed)</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">Vmin</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Vmin is not Even&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">Vmax</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Vmax is not Even&#39;</span><span class="p">)</span>

    <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">SetSeed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span> <span class="c1"># sets seed for the numba runtime</span>
    <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;data/ConnectedRandomCubic-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ID0</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ID1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-Vmin-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Vmin</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-Vmax-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Vmax</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-seed-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ID1</span><span class="p">):</span>
        <span class="n">N</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">Vmin</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span><span class="n">Vmax</span><span class="o">//</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">EdgeList</span><span class="o">=</span><span class="n">ConnectedRandomCubic</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">EP</span><span class="o">=</span><span class="mf">.5</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">k</span><span class="o">&lt;</span><span class="n">ID0</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ee</span> <span class="ow">in</span> <span class="n">EdgeList</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ee</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">CubicTreeWidthParallel</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    function called by multiprocessing to calculate the Treewidth, Pathwidth, and LineGraphwidth of a graph.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    n : tuple</span>
<span class="sd">        n[0] contains the graph defined by an edgelist, list of tuples</span>
<span class="sd">        n[1] contains the ID of the graph from the random generation process, int</span>
<span class="sd">        n[2] contains the size of the graph in terms of the number of nodes, int</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    (n[1],n[2],TreeWidthSize,PathWidthSize,LineGraphWidth) : tuple</span>
<span class="sd">        (Graph ID, Graph node count,Treewidth,Pathwidth,LineGraphwidth)</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Graph sizes between Vmin and Vmax inclusive are uniformly randomly selected.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; EdgeList=[  (0,1,.5),</span>
<span class="sd">                    (0,2,.5),</span>
<span class="sd">                    (0,3,.5),</span>
<span class="sd">                    (1,2,.5),</span>
<span class="sd">                    (1,3,.5),</span>
<span class="sd">                    (2,3,.5)]</span>
<span class="sd">    &gt;&gt;&gt; ID=0</span>
<span class="sd">    &gt;&gt;&gt; NodeCount=4</span>
<span class="sd">    &gt;&gt;&gt; n=(EdgeList,ID,NodeCount)</span>
<span class="sd">    &gt;&gt;&gt; CubicTreeWidthParallel(n)</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="c1"># N=n[0]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">n</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">EdgeList</span><span class="o">=</span><span class="n">n</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># only calculate the treewidth for 6 seconds</span>
    <span class="n">TreeWidthCalcTime</span><span class="o">=</span><span class="mi">6</span>

    <span class="c1"># sometimes the tree decomposition program does not play nice with the</span>
    <span class="c1"># multiprocessing module (wsl.exe conflicts?)</span>
    <span class="c1"># so if an error occurs, try again</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">Fname</span><span class="o">=</span><span class="n">TreeWidth</span><span class="o">.</span><span class="n">TreeWidthApprox</span><span class="p">(</span><span class="n">EdgeList</span><span class="p">,</span><span class="n">seconds</span><span class="o">=</span><span class="n">TreeWidthCalcTime</span><span class="p">,</span><span class="n">ID</span><span class="o">=</span><span class="n">n</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="c1"># GET EDGE CONTRACTION ORDER</span>
            <span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">Fname</span><span class="p">)</span>
            <span class="n">lines</span><span class="o">=</span><span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
            <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">Fname</span><span class="p">)</span>
            <span class="n">bags</span><span class="o">=</span><span class="p">[]</span>
            <span class="n">tree</span><span class="o">=</span><span class="p">[]</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;c&#39;</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;s&#39;</span><span class="p">:</span>
                    <span class="n">data</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                    <span class="n">tree</span><span class="o">=</span><span class="p">[[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]))]</span>
                    <span class="n">TreeWidthSize</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
                    <span class="k">continue</span>
                <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;b&#39;</span><span class="p">:</span>
                    <span class="n">data</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                    <span class="n">d</span><span class="o">=</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">:]]</span>
                    <span class="n">bags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
                    <span class="k">continue</span>
                <span class="n">data</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>

                <span class="n">tree</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">tree</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">order</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">ContractionOrdering</span><span class="o">.</span><span class="n">ContractionOrder</span><span class="p">(</span><span class="n">bags</span><span class="p">,</span><span class="n">tree</span><span class="p">)</span>

            <span class="n">NodeOrder</span><span class="p">,</span><span class="n">PathWidthSize</span><span class="o">=</span><span class="n">ContractionOrdering</span><span class="o">.</span><span class="n">GetNodeOrdering</span><span class="p">(</span><span class="n">order</span><span class="p">,</span><span class="n">bags</span><span class="p">,</span><span class="n">tree</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

            <span class="n">Gline</span><span class="o">=</span><span class="n">general_utilities</span><span class="o">.</span><span class="n">_EdgeListtoLine</span><span class="p">(</span><span class="n">EdgeList</span><span class="p">)</span>
            <span class="n">Gix</span><span class="p">,</span><span class="n">ixTdict</span><span class="p">,</span><span class="n">dictTix</span><span class="o">=</span><span class="n">general_utilities</span><span class="o">.</span><span class="n">_DictToix</span><span class="p">(</span><span class="n">Gline</span><span class="p">)</span>
            <span class="n">EdgeListLine</span><span class="o">=</span><span class="n">general_utilities</span><span class="o">.</span><span class="n">_ixDictToEdgeList</span><span class="p">(</span><span class="n">Gix</span><span class="p">)</span>
            <span class="n">Fname</span><span class="o">=</span><span class="n">TreeWidth</span><span class="o">.</span><span class="n">TreeWidthApprox</span><span class="p">(</span><span class="n">EdgeListLine</span><span class="p">,</span><span class="n">seconds</span><span class="o">=</span><span class="n">TreeWidthCalcTime</span><span class="p">,</span><span class="n">ID</span><span class="o">=</span><span class="n">n</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="c1">#### GET EDGE CONTRACTION ORDER</span>
            <span class="c1"># read tree decomposition</span>
            <span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">Fname</span><span class="p">)</span>
            <span class="n">lines</span><span class="o">=</span><span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
            <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">Fname</span><span class="p">)</span>
            <span class="n">bags</span><span class="o">=</span><span class="p">[]</span>
            <span class="n">tree</span><span class="o">=</span><span class="p">[]</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;c&#39;</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;s&#39;</span><span class="p">:</span>
                    <span class="n">data</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                    <span class="n">tree</span><span class="o">=</span><span class="p">[[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]))]</span>
                    <span class="n">LineGraphWidth</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
                    <span class="k">continue</span>
                <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;b&#39;</span><span class="p">:</span>
                    <span class="n">data</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                    <span class="n">d</span><span class="o">=</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">:]]</span>
                    <span class="n">bags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
                    <span class="k">continue</span>
                <span class="n">data</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>

                <span class="n">tree</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">tree</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">n</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">TreeWidthSize</span><span class="p">,</span><span class="n">PathWidthSize</span><span class="p">,</span><span class="n">LineGraphWidth</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
</pre></div>

        </details>

            <div class="docstring"><p>This module contains functions to perform miscellaneous tasks on cubic graphs. Mostly for generating uniform connected random cubic graphs.</p>

<h6 id="functions">Functions</h6>

<p><strong>SetSeed(seed) :</strong>
    Sets seed of numba runtime</p>

<p><strong>ConnectedRandomCubicGenerate(pegs,G) :</strong>
    numba optimized function for generating random uniform connected random cubic graphs. A 1-Flipper Markov Chain Monte Carlo (MCMC) algorithm is used to uniformly generate these random cubic graphs.
    Algorithm from:
    Toms Feder, Adam Guetz, Milena Mihail, and Amin Saberi. A local switch markov chain on given degree graphs with application in connectivity of peer-to-peer networks. In 2006 47th Annual IEEE Symposium on Foundations of Computer Science (FOCS06), pages 69-76. IEEE, 2006
    Code written by me.</p>

<p><strong>ConnectedRandomCubic(n,EP=None) :</strong>
    Returns a random uniform connected random cubic graph of size n by calling ConnectedRandomCubicGenerate</p>

<p><strong>GenConnectedRandomCubic(ID0=0,ID1=10000,Vmin=20,Vmax=400,seed=42) :</strong>
    Helper function to pre-generate a list of random connected cubic graphs.</p>

<h6 id="notes">Notes</h6>

<p>When the graph generation is first executed, numba performs jit compilation. This causes the first execution to take several seconds to run, but the compilation is cached and future runs with different inputs do not need to recompile.</p>
</div>


                </section>
                <section id="general_utilities">
                                <div class="attr module"><a class="headerlink" href="#general_utilities">#&nbsp;&nbsp</a>
<span class="name"><a href="ICOSSAR_2021/general_utilities.html">ICOSSAR_2021.general_utilities</a></span></div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">This module contains functions to general utility tasks. The functions here are mostly responsible for converting from one graph format to another, and converting node labels from arbitrary strings to integers from 0 to |V|-1</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="k">def</span> <span class="nf">_EdgeListtoG</span><span class="p">(</span><span class="n">EdgeList</span><span class="p">):</span>
    <span class="c1"># Build G</span>
    <span class="n">G</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">ee</span> <span class="ow">in</span> <span class="n">EdgeList</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ee</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">G</span><span class="p">:</span>
            <span class="n">G</span><span class="p">[</span><span class="n">ee</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">if</span> <span class="n">ee</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">G</span><span class="p">:</span>
            <span class="n">G</span><span class="p">[</span><span class="n">ee</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">G</span><span class="p">[</span><span class="n">ee</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ee</span><span class="p">)</span>
        <span class="n">G</span><span class="p">[</span><span class="n">ee</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ee</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">G</span>

<span class="k">def</span> <span class="nf">_EdgeListtoLine</span><span class="p">(</span><span class="n">EdgeList</span><span class="p">):</span>
    <span class="c1"># Build G</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">EdgeList</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">==</span><span class="mi">3</span><span class="p">:</span>
        <span class="n">G</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ee</span> <span class="ow">in</span> <span class="n">EdgeList</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ee</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">G</span><span class="p">:</span>
                <span class="n">G</span><span class="p">[</span><span class="n">ee</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">=</span><span class="p">[]</span>
            <span class="k">if</span> <span class="n">ee</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">G</span><span class="p">:</span>
                <span class="n">G</span><span class="p">[</span><span class="n">ee</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">=</span><span class="p">[]</span>
            <span class="n">G</span><span class="p">[</span><span class="n">ee</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ee</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">ee</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
            <span class="n">G</span><span class="p">[</span><span class="n">ee</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ee</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ee</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>

        <span class="n">Gline</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">EdgeList</span><span class="p">:</span>
            <span class="n">ee</span><span class="o">=</span><span class="p">[</span><span class="n">n</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">n</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">ee</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="n">n</span><span class="o">=</span><span class="nb">tuple</span><span class="p">([</span><span class="n">ee</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ee</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">n</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
            <span class="c1"># n=tuple([ee[0],ee[1]])</span>
            <span class="n">Gline</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=</span><span class="p">[]</span>
            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">G</span><span class="p">[</span><span class="n">n</span><span class="p">[</span><span class="mi">0</span><span class="p">]]:</span>
                <span class="n">Edge</span><span class="o">=</span><span class="p">[</span><span class="n">n</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                <span class="n">Edge</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
                <span class="n">Gline</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">tuple</span><span class="p">([</span><span class="n">Edge</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">Edge</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]]))</span>
            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">G</span><span class="p">[</span><span class="n">n</span><span class="p">[</span><span class="mi">1</span><span class="p">]]:</span>
                <span class="n">Edge</span><span class="o">=</span><span class="p">[</span><span class="n">n</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                <span class="n">Edge</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
                <span class="n">Gline</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">tuple</span><span class="p">([</span><span class="n">Edge</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">Edge</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]]))</span>
            <span class="n">Gline</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
            <span class="n">Gline</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">G</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ee</span> <span class="ow">in</span> <span class="n">EdgeList</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ee</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">G</span><span class="p">:</span>
                <span class="n">G</span><span class="p">[</span><span class="n">ee</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">=</span><span class="p">[]</span>
            <span class="k">if</span> <span class="n">ee</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">G</span><span class="p">:</span>
                <span class="n">G</span><span class="p">[</span><span class="n">ee</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">=</span><span class="p">[]</span>
            <span class="n">G</span><span class="p">[</span><span class="n">ee</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ee</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">G</span><span class="p">[</span><span class="n">ee</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ee</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="n">Gline</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">EdgeList</span><span class="p">:</span>
            <span class="n">ee</span><span class="o">=</span><span class="p">[</span><span class="n">n</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">n</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">ee</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="n">n</span><span class="o">=</span><span class="nb">tuple</span><span class="p">([</span><span class="n">ee</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ee</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
            <span class="n">Gline</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=</span><span class="p">[]</span>
            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">G</span><span class="p">[</span><span class="n">n</span><span class="p">[</span><span class="mi">0</span><span class="p">]]:</span>
                <span class="n">Edge</span><span class="o">=</span><span class="p">[</span><span class="n">n</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">e</span><span class="p">]</span>
                <span class="n">Edge</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
                <span class="n">Gline</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">Edge</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">G</span><span class="p">[</span><span class="n">n</span><span class="p">[</span><span class="mi">1</span><span class="p">]]:</span>
                <span class="n">Edge</span><span class="o">=</span><span class="p">[</span><span class="n">n</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">e</span><span class="p">]</span>
                <span class="n">Edge</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
                <span class="n">Gline</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">Edge</span><span class="p">))</span>
            <span class="n">Gline</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
            <span class="n">Gline</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Gline</span>

<span class="c1"># convert dict to [0,|E|] format</span>
<span class="k">def</span> <span class="nf">_DictToix</span><span class="p">(</span><span class="n">Gdict</span><span class="p">):</span>
    <span class="n">ix</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">ixTdict</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>
    <span class="n">dictTix</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>
    <span class="n">G</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">Gdict</span><span class="p">:</span>
        <span class="n">GL</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">if</span> <span class="n">n</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dictTix</span><span class="p">:</span>
            <span class="n">dictTix</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=</span><span class="n">ix</span>
            <span class="n">ixTdict</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">=</span><span class="n">n</span>
            <span class="n">ix</span><span class="o">=</span><span class="n">ix</span><span class="o">+</span><span class="mi">1</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">Gdict</span><span class="p">[</span><span class="n">n</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">e</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dictTix</span><span class="p">:</span>
                <span class="n">dictTix</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">=</span><span class="n">ix</span>
                <span class="n">ixTdict</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">=</span><span class="n">e</span>
                <span class="n">ix</span><span class="o">=</span><span class="n">ix</span><span class="o">+</span><span class="mi">1</span>
            <span class="n">GL</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dictTix</span><span class="p">[</span><span class="n">e</span><span class="p">])</span>
        <span class="n">G</span><span class="p">[</span><span class="n">dictTix</span><span class="p">[</span><span class="n">n</span><span class="p">]]</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">GL</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">G</span><span class="p">,</span><span class="n">ixTdict</span><span class="p">,</span><span class="n">dictTix</span>

<span class="k">def</span> <span class="nf">_ixDictToEdgeList</span><span class="p">(</span><span class="n">G</span><span class="p">):</span>
    <span class="n">ee</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">keys</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">keys</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">G</span><span class="p">[</span><span class="n">n</span><span class="p">]:</span>
            <span class="n">ee</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="n">e</span><span class="p">))</span>
    <span class="n">ee</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">ee</span><span class="p">))</span>
    <span class="n">ee</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">ee</span>
</pre></div>

        </details>

            <div class="docstring"><p>This module contains functions to general utility tasks. The functions here are mostly responsible for converting from one graph format to another, and converting node labels from arbitrary strings to integers from 0 to |V|-1</p>
</div>


                </section>
                <section id="generate_figures">
                                <div class="attr module"><a class="headerlink" href="#generate_figures">#&nbsp;&nbsp</a>
<span class="name"><a href="ICOSSAR_2021/generate_figures.html">ICOSSAR_2021.generate_figures</a></span></div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">This module contains functions to create the figures seen in the ICOSSAR 2021 paper.</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="kn">import</span> <span class="nn">numpy</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;Agg&#39;</span><span class="p">)</span>  <span class="c1"># no UI backend</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.ticker</span> <span class="k">as</span> <span class="nn">mtick</span>

<span class="k">def</span> <span class="nf">MCtrials_vs_e_Figure</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;xtick&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;ytick&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span> <span class="c1">#labelsizes</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">titlesize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>  <span class="c1">#titlesize</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;legend&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>  <span class="c1">#legendsize</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="mf">3.5</span> <span class="c1">#plot size in inches</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1">#plot size in inches</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">))</span> <span class="c1">#makes figure/canvas space</span>
    <span class="n">plot</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.5</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">/</span> <span class="n">dy</span><span class="p">,</span> <span class="mf">2.75</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mf">1.25</span> <span class="o">/</span> <span class="n">dy</span><span class="p">])</span>
    <span class="c1"># plot2 = fig.add_axes([0.5 / dx, 0.5 / dy, 2.75 / dx, 1.25 / dy])</span>

    <span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;analysis/MCtheory&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">lines</span><span class="o">=</span><span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">X</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">Y1</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">Y2</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">Y3</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="n">data</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
        <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">])))</span>

    <span class="n">X</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\epsilon$=&#39;</span><span class="o">+</span><span class="s2">&quot;1.1&quot;</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">X</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\epsilon$=&#39;</span><span class="o">+</span><span class="s2">&quot;1.05&quot;</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">X</span><span class="p">[:,</span><span class="mi">3</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\epsilon$=&#39;</span><span class="o">+</span><span class="s2">&quot;1.01&quot;</span><span class="p">)</span>

    <span class="c1"># plot.plot(numpy.exp(S),NN,label=&#39;$\epsilon$=&#39;+&quot;{:.2f}&quot;.format(e-1))</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Needed Bernoulli Monte Carlo Trials&#39;</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Monte Carlo Trials&#39;</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$P_</span><span class="si">{true}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;figures/MCTrials.png&quot;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">TensorGraphFigure</span><span class="p">():</span>

    <span class="c1"># set up plotting area</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;xtick&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;ytick&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span> <span class="c1">#labelsizes</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">titlesize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>  <span class="c1">#titlesize</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;legend&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>  <span class="c1">#legendsize</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="mf">3.5</span> <span class="c1">#plot size in inches</span>
    <span class="c1"># dy = 6 #plot size in inches</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="c1">#plot size in inches</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">))</span> <span class="c1">#makes figure/canvas space</span>
    <span class="n">plot</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mi">0</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mi">0</span> <span class="o">/</span> <span class="n">dy</span><span class="p">,</span> <span class="mf">1.75</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mf">1.75</span> <span class="o">/</span> <span class="n">dy</span><span class="p">])</span>
    <span class="n">plotb</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">1.75</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mi">0</span> <span class="o">/</span> <span class="n">dy</span><span class="p">,</span> <span class="mf">1.75</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mf">1.75</span> <span class="o">/</span> <span class="n">dy</span><span class="p">])</span>

    <span class="c1">### Tensor Graph Drawing</span>
    <span class="kn">import</span> <span class="nn">matplotlib.lines</span> <span class="k">as</span> <span class="nn">lines</span>
    <span class="k">def</span> <span class="nf">CC</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">color</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">r</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">LL</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">y2</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">lines</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span><span class="n">y2</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">TTc</span><span class="p">(</span><span class="n">AA</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">text</span><span class="p">):</span>
        <span class="n">AA</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">TTl</span><span class="p">(</span><span class="n">AA</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">text</span><span class="p">):</span>
        <span class="n">AA</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

    <span class="n">plot</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="n">plotb</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">.5</span><span class="p">,</span><span class="mf">.9</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$(x_1 \vee x_2 \vee x_3) \wedge (x_3 \vee x_4 \vee x_5) \wedge $&#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;$(x_2 \vee x_4 \vee x_6 \vee x_7) \wedge (x_1 \vee x_6) \wedge (x_5 \vee x_7)$&#39;</span><span class="p">,</span><span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

    <span class="c1">### PLOT A</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">LL</span><span class="p">(</span><span class="mf">.2</span><span class="p">,</span><span class="mf">.2</span><span class="p">,</span><span class="mf">.2</span><span class="p">,</span><span class="mf">.8</span><span class="p">))</span>
    <span class="n">TTl</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span><span class="mf">.2</span><span class="p">,</span><span class="mf">.5</span><span class="p">,</span><span class="s1">&#39;$X_1$&#39;</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">LL</span><span class="p">(</span><span class="mf">.2</span><span class="p">,</span><span class="mf">.5</span><span class="p">,</span><span class="mf">.8</span><span class="p">,</span><span class="mf">.5</span><span class="p">))</span>
    <span class="n">TTl</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span><span class="mf">.36</span><span class="p">,</span><span class="mf">.65</span><span class="p">,</span><span class="s1">&#39;$X_2$&#39;</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">LL</span><span class="p">(</span><span class="mf">.2</span><span class="p">,</span><span class="mf">.8</span><span class="p">,</span><span class="mf">.8</span><span class="p">,</span><span class="mf">.8</span><span class="p">))</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">.5</span><span class="p">,</span><span class="mf">.75</span><span class="p">,</span><span class="s1">&#39;$X_3$&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">LL</span><span class="p">(</span><span class="mf">.5</span><span class="p">,</span><span class="mf">.8</span><span class="p">,</span><span class="mf">.5</span><span class="p">,</span><span class="mf">.8</span><span class="p">))</span>
    <span class="n">TTl</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span><span class="mf">.675</span><span class="p">,</span><span class="mf">.65</span><span class="p">,</span><span class="s1">&#39;$X_4$&#39;</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">LL</span><span class="p">(</span><span class="mf">.8</span><span class="p">,</span><span class="mf">.8</span><span class="p">,</span><span class="mf">.2</span><span class="p">,</span><span class="mf">.8</span><span class="p">))</span>
    <span class="n">TTl</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span><span class="mf">.8</span><span class="p">,</span><span class="mf">.5</span><span class="p">,</span><span class="s1">&#39;$X_5$&#39;</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">LL</span><span class="p">(</span><span class="mf">.2</span><span class="p">,</span><span class="mf">.5</span><span class="p">,</span><span class="mf">.2</span><span class="p">,</span><span class="mf">.5</span><span class="p">))</span>
    <span class="n">TTl</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span><span class="mf">.25</span><span class="p">,</span><span class="mf">.35</span><span class="p">,</span><span class="s1">&#39;$X_6$&#39;</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">LL</span><span class="p">(</span><span class="mf">.8</span><span class="p">,</span><span class="mf">.5</span><span class="p">,</span><span class="mf">.2</span><span class="p">,</span><span class="mf">.5</span><span class="p">))</span>
    <span class="n">TTl</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span><span class="mf">.66</span><span class="p">,</span><span class="mf">.35</span><span class="p">,</span><span class="s1">&#39;$X_7$&#39;</span><span class="p">)</span>

    <span class="n">plot</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">CC</span><span class="p">(</span><span class="mf">.2</span><span class="p">,</span><span class="mf">.8</span><span class="p">,</span><span class="mf">.04</span><span class="p">,</span><span class="s1">&#39;#777777&#39;</span><span class="p">))</span>
    <span class="n">TTc</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span><span class="mf">.2</span><span class="p">,</span><span class="mf">.8</span><span class="p">,</span><span class="s1">&#39;C1&#39;</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">CC</span><span class="p">(</span><span class="mf">.8</span><span class="p">,</span><span class="mf">.8</span><span class="p">,</span><span class="mf">.04</span><span class="p">,</span><span class="s1">&#39;#777777&#39;</span><span class="p">))</span>
    <span class="n">TTc</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span><span class="mf">.8</span><span class="p">,</span><span class="mf">.8</span><span class="p">,</span><span class="s1">&#39;C2&#39;</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">CC</span><span class="p">(</span><span class="mf">.5</span><span class="p">,</span><span class="mf">.5</span><span class="p">,</span><span class="mf">.04</span><span class="p">,</span><span class="s1">&#39;#777777&#39;</span><span class="p">))</span>
    <span class="n">TTc</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span><span class="mf">.5</span><span class="p">,</span><span class="mf">.5</span><span class="p">,</span><span class="s1">&#39;C3&#39;</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">CC</span><span class="p">(</span><span class="mf">.2</span><span class="p">,</span><span class="mf">.2</span><span class="p">,</span><span class="mf">.04</span><span class="p">,</span><span class="s1">&#39;#777777&#39;</span><span class="p">))</span>
    <span class="n">TTc</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span><span class="mf">.2</span><span class="p">,</span><span class="mf">.2</span><span class="p">,</span><span class="s1">&#39;C4&#39;</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">CC</span><span class="p">(</span><span class="mf">.8</span><span class="p">,</span><span class="mf">.2</span><span class="p">,</span><span class="mf">.04</span><span class="p">,</span><span class="s1">&#39;#777777&#39;</span><span class="p">))</span>
    <span class="n">TTc</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span><span class="mf">.8</span><span class="p">,</span><span class="mf">.2</span><span class="p">,</span><span class="s1">&#39;C5&#39;</span><span class="p">)</span>

    <span class="n">plot</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">.5</span><span class="p">,</span><span class="mf">.13</span><span class="p">,</span><span class="s1">&#39;[a]&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">LL</span><span class="p">(</span><span class="mf">.5</span><span class="p">,</span><span class="mf">.5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">.75</span><span class="p">))</span>
    <span class="c1">### PLOT B</span>
    <span class="n">plotb</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">LL</span><span class="p">(</span><span class="mf">.2</span><span class="p">,</span><span class="mf">.5</span><span class="p">,</span><span class="mf">.525</span><span class="p">,</span><span class="mf">.525</span><span class="p">))</span>
    <span class="n">TTl</span><span class="p">(</span><span class="n">plotb</span><span class="p">,</span><span class="mf">.375</span><span class="p">,</span><span class="mf">.555</span><span class="p">,</span><span class="s1">&#39;$X_2$&#39;</span><span class="p">)</span>
    <span class="n">plotb</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">LL</span><span class="p">(</span><span class="mf">.2</span><span class="p">,</span><span class="mf">.8</span><span class="p">,</span><span class="mf">.5</span><span class="p">,</span><span class="mf">.8</span><span class="p">))</span>
    <span class="n">TTl</span><span class="p">(</span><span class="n">plotb</span><span class="p">,</span><span class="mf">.475</span><span class="p">,</span><span class="mf">.71</span><span class="p">,</span><span class="s1">&#39;$X_3$&#39;</span><span class="p">)</span>
    <span class="n">plotb</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">LL</span><span class="p">(</span><span class="mf">.5</span><span class="p">,</span><span class="mf">.8</span><span class="p">,</span><span class="mf">.5</span><span class="p">,</span><span class="mf">.8</span><span class="p">))</span>
    <span class="n">TTl</span><span class="p">(</span><span class="n">plotb</span><span class="p">,</span><span class="mf">.675</span><span class="p">,</span><span class="mf">.65</span><span class="p">,</span><span class="s1">&#39;$X_4$&#39;</span><span class="p">)</span>
    <span class="n">plotb</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">LL</span><span class="p">(</span><span class="mf">.8</span><span class="p">,</span><span class="mf">.8</span><span class="p">,</span><span class="mf">.2</span><span class="p">,</span><span class="mf">.8</span><span class="p">))</span>
    <span class="n">TTl</span><span class="p">(</span><span class="n">plotb</span><span class="p">,</span><span class="mf">.8</span><span class="p">,</span><span class="mf">.5</span><span class="p">,</span><span class="s1">&#39;$X_5$&#39;</span><span class="p">)</span>
    <span class="n">plotb</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">LL</span><span class="p">(</span><span class="mf">.2</span><span class="p">,</span><span class="mf">.5</span><span class="p">,</span><span class="mf">.475</span><span class="p">,</span><span class="mf">.475</span><span class="p">))</span>
    <span class="n">TTl</span><span class="p">(</span><span class="n">plotb</span><span class="p">,</span><span class="mf">.35</span><span class="p">,</span><span class="mf">.425</span><span class="p">,</span><span class="s1">&#39;$X_6$&#39;</span><span class="p">)</span>
    <span class="n">plotb</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">LL</span><span class="p">(</span><span class="mf">.8</span><span class="p">,</span><span class="mf">.5</span><span class="p">,</span><span class="mf">.2</span><span class="p">,</span><span class="mf">.5</span><span class="p">))</span>
    <span class="n">TTl</span><span class="p">(</span><span class="n">plotb</span><span class="p">,</span><span class="mf">.66</span><span class="p">,</span><span class="mf">.35</span><span class="p">,</span><span class="s1">&#39;$X_7$&#39;</span><span class="p">)</span>

    <span class="n">plotb</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">CC</span><span class="p">(</span><span class="mf">.2</span><span class="p">,</span><span class="mf">.5</span><span class="p">,</span><span class="mf">.04</span><span class="p">,</span><span class="s1">&#39;#777777&#39;</span><span class="p">))</span>
    <span class="c1"># TTc(plotb,.2,.5,&#39;C14&#39;)</span>
    <span class="n">plotb</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">.2</span><span class="p">,</span><span class="mf">.565</span><span class="p">,</span><span class="s1">&#39;C14&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plotb</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">CC</span><span class="p">(</span><span class="mf">.8</span><span class="p">,</span><span class="mf">.8</span><span class="p">,</span><span class="mf">.04</span><span class="p">,</span><span class="s1">&#39;#777777&#39;</span><span class="p">))</span>
    <span class="n">TTc</span><span class="p">(</span><span class="n">plotb</span><span class="p">,</span><span class="mf">.8</span><span class="p">,</span><span class="mf">.8</span><span class="p">,</span><span class="s1">&#39;C2&#39;</span><span class="p">)</span>
    <span class="n">plotb</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">CC</span><span class="p">(</span><span class="mf">.5</span><span class="p">,</span><span class="mf">.5</span><span class="p">,</span><span class="mf">.04</span><span class="p">,</span><span class="s1">&#39;#777777&#39;</span><span class="p">))</span>
    <span class="n">TTc</span><span class="p">(</span><span class="n">plotb</span><span class="p">,</span><span class="mf">.5</span><span class="p">,</span><span class="mf">.5</span><span class="p">,</span><span class="s1">&#39;C3&#39;</span><span class="p">)</span>
    <span class="c1"># plotb.add_artist(CC(.2,.2,.08,&#39;#777777&#39;))</span>
    <span class="c1"># TTc(plotb,.2,.2,&#39;C4&#39;)</span>
    <span class="n">plotb</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">CC</span><span class="p">(</span><span class="mf">.8</span><span class="p">,</span><span class="mf">.2</span><span class="p">,</span><span class="mf">.04</span><span class="p">,</span><span class="s1">&#39;#777777&#39;</span><span class="p">))</span>
    <span class="n">TTc</span><span class="p">(</span><span class="n">plotb</span><span class="p">,</span><span class="mf">.8</span><span class="p">,</span><span class="mf">.2</span><span class="p">,</span><span class="s1">&#39;C5&#39;</span><span class="p">)</span>
    <span class="c1"># plot.add_artist(CC(.25,.5,.75,&#39;#444444&#39;))</span>
    <span class="n">plotb</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">.5</span><span class="p">,</span><span class="mf">.13</span><span class="p">,</span><span class="s1">&#39;[b]&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;figures/TensorGraphExample.png&quot;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">GridGraphComputeTimeFigure</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;xtick&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;ytick&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span> <span class="c1">#labelsizes</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">titlesize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>  <span class="c1">#titlesize</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;legend&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>  <span class="c1">#legendsize</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="mf">3.5</span> <span class="c1">#plot size in inches</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="mf">3.5</span> <span class="c1">#plot size in inches</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">))</span> <span class="c1">#makes figure/canvas space</span>
    <span class="n">plot</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.5</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">dy</span><span class="p">,</span> <span class="mf">2.75</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mf">1.25</span> <span class="o">/</span> <span class="n">dy</span><span class="p">])</span>
    <span class="n">plot2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.5</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">/</span> <span class="n">dy</span><span class="p">,</span> <span class="mf">2.75</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mf">1.25</span> <span class="o">/</span> <span class="n">dy</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">ix</span><span class="p">,</span><span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mf">.5</span><span class="p">,</span><span class="mf">.9</span><span class="p">,</span><span class="mf">.99</span><span class="p">]):</span>
        <span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;analysis/GridsNvaryMCTRIALS&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="mi">100</span><span class="p">)),</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">=</span><span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="n">X</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">REL</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">RELsubg</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">EC</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">ECfp</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="mi">2</span><span class="p">:]:</span>
            <span class="n">data</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>

            <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

            <span class="n">REL</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
            <span class="n">RELsubg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
            <span class="n">EC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">]))</span>
            <span class="n">ECfp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">6</span><span class="p">]))</span>

    <span class="n">plot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">RELsubg</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$Rel_</span><span class="si">{ATR}</span><span class="s1">(G)$ Subgraphs&#39;</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">ECfp</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$EC(G)$ Floating Point Operations&#39;</span><span class="p">)</span>
    <span class="n">plot2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">REL</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$Rel_</span><span class="si">{ATR}</span><span class="s1">(G)$ solve time&#39;</span><span class="p">)</span>
    <span class="n">plot2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">EC</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$EC(G)$ solve time&#39;</span><span class="p">)</span>

    <span class="n">plot</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
    <span class="c1"># plot1a.set_yticklabels([])</span>
    <span class="c1"># plot1a.set_yticks([])</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
    <span class="n">plot2</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>

    <span class="n">plot</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Grid Graph Computational Difficulty [a]&#39;</span><span class="p">)</span>
    <span class="n">plot2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Grid Graph Wall Clock Solve Time [b]&#39;</span><span class="p">)</span>
    <span class="n">plot2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Grid Dimension $n$&#39;</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Operation Count&#39;</span><span class="p">)</span>
    <span class="n">plot2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Time (seconds)&#39;</span><span class="p">)</span>

    <span class="n">plot</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plot2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="c1"># plot.text(8,1000,&#39;Fig b&#39;, horizontalalignment=&#39;center&#39;, fontsize=16)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;figures/GridGraphComputeTime.png&quot;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">GridGraphComplexityFigure</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;xtick&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;ytick&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span> <span class="c1">#labelsizes</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">7</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">titlesize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>  <span class="c1">#titlesize</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;legend&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>  <span class="c1">#legendsize</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="mf">3.5</span> <span class="c1">#plot size in inches</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="mf">3.25</span> <span class="c1">#plot size in inches</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">))</span> <span class="c1">#makes figure/canvas space</span>
    <span class="n">plot</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.5</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mf">1.75</span> <span class="o">/</span> <span class="n">dy</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">dy</span><span class="p">])</span>
    <span class="n">plot2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.5</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">/</span> <span class="n">dy</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">dy</span><span class="p">])</span>
    <span class="n">plot3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">2.15</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mf">1.75</span> <span class="o">/</span> <span class="n">dy</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">dy</span><span class="p">])</span>
    <span class="n">plot4</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">2.15</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">/</span> <span class="n">dy</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">dy</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">ix</span><span class="p">,</span><span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mf">.5</span><span class="p">,</span><span class="mf">.9</span><span class="p">,</span><span class="mf">.99</span><span class="p">]):</span>
        <span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;analysis/GridsNvaryMCTRIALS&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="mi">100</span><span class="p">)),</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">=</span><span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="n">X</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">REL</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">RELsubg</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">EC</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">ECfp</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="mi">2</span><span class="p">:]:</span>
            <span class="n">data</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>

            <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

            <span class="n">REL</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
            <span class="n">RELsubg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
            <span class="n">EC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">]))</span>
            <span class="n">ECfp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">6</span><span class="p">]))</span>

    <span class="n">plot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">RELsubg</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Subgraphs&#39;</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">ECfp</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Floating Point </span><span class="se">\n</span><span class="s1"> Operations&#39;</span><span class="p">)</span>
    <span class="n">plot2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">REL</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$Rel_</span><span class="si">{ATR}</span><span class="s1">(G)$&#39;</span><span class="p">)</span>
    <span class="n">plot2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">EC</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$EC(G)$&#39;</span><span class="p">)</span>

    <span class="n">plot</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
    <span class="c1"># plot1a.set_yticklabels([])</span>
    <span class="c1"># plot1a.set_yticks([])</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
    <span class="n">plot2</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>

    <span class="n">plot</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$nxn$ Grid [a]&#39;</span><span class="p">)</span>
    <span class="n">plot2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Wall Clock Time [b]&#39;</span><span class="p">)</span>
    <span class="n">plot2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Grid Dimension $n$&#39;</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Operation Count&#39;</span><span class="p">)</span>
    <span class="n">plot2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Time (seconds)&#39;</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Grid Graph Computational Difficulty&#39;</span><span class="p">)</span>

    <span class="n">plot</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plot2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="c1"># plot.text(8,1000,&#39;Fig b&#39;, horizontalalignment=&#39;center&#39;, fontsize=16)</span>

    <span class="c1"># fig.savefig(&quot;figures/GridGraphComputeTime.png&quot;,dpi=600)</span>
    <span class="c1"># sys.exit()</span>

    <span class="c1">## test 2: Grid Graph 8xn MC</span>
    <span class="c1"># plt.rc(&#39;xtick&#39;, labelsize=7)</span>
    <span class="c1"># plt.rc(&#39;ytick&#39;, labelsize=7) #labelsizes</span>
    <span class="c1"># plt.rcParams[&#39;axes.labelsize&#39;] = 8</span>
    <span class="c1"># plt.rc(&#39;axes&#39;, titlesize=10)  #titlesize</span>
    <span class="c1"># plt.rc(&#39;legend&#39;, fontsize=6)  #legendsize</span>
    <span class="c1"># dx = 3.5 #plot size in inches</span>
    <span class="c1"># dy = 3.5 #plot size in inches</span>
    <span class="c1"># fig = plt.figure(figsize=(dx, dy)) #makes figure/canvas space</span>
    <span class="c1"># plot = fig.add_axes([0.5 / dx, 2 / dy, 2.75 / dx, 1.25 / dy])</span>
    <span class="c1"># plot2 = fig.add_axes([0.5 / dx, 0.5 / dy, 2.75 / dx, 1.25 / dy])</span>

    <span class="k">for</span> <span class="n">ix</span><span class="p">,</span><span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mf">.5</span><span class="p">,</span><span class="mf">.9</span><span class="p">,</span><span class="mf">.99</span><span class="p">]):</span>
        <span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;analysis/GridsLvaryMCTRIALS&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="mi">100</span><span class="p">)),</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">=</span><span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="n">X</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">REL</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>
        <span class="n">RELsubg</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">EC</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>
        <span class="n">ECfp</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="mi">2</span><span class="p">:]:</span>
            <span class="n">data</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>

            <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

            <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">REL</span><span class="p">:</span>
                <span class="n">REL</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span><span class="o">=</span><span class="p">[]</span>
            <span class="n">REL</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
            <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">EC</span><span class="p">:</span>
                <span class="n">EC</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span><span class="o">=</span><span class="p">[]</span>
            <span class="n">EC</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">]))</span>

            <span class="n">RELsubg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
            <span class="n">ECfp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">6</span><span class="p">]))</span>

    <span class="n">RELt</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">ECt</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">X</span><span class="p">:</span>
        <span class="n">RELt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">REL</span><span class="p">[</span><span class="n">x</span><span class="p">]))</span>
        <span class="n">ECt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">EC</span><span class="p">[</span><span class="n">x</span><span class="p">]))</span>


    <span class="n">plot3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">RELsubg</span><span class="p">),</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Subgraphs&#39;</span><span class="p">)</span>
    <span class="n">plot3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ECfp</span><span class="p">),</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Floating Point </span><span class="se">\n</span><span class="s1"> Operations&#39;</span><span class="p">)</span>
    <span class="n">plot4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">RELt</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$Rel_</span><span class="si">{ATR}</span><span class="s1">(G)$ (sec)&#39;</span><span class="p">)</span>
    <span class="n">plot4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ECt</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$EC(G)$ </span><span class="se">\n</span><span class="s1"> (sec*100)&#39;</span><span class="p">)</span>

    <span class="n">plot3</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
    <span class="n">plot3</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
    <span class="n">plot3</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">plot3</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">()])</span>
    <span class="n">yticks</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">plot3</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">())</span>
    <span class="n">ticks</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">yy</span> <span class="ow">in</span> <span class="n">yticks</span><span class="p">:</span>
        <span class="n">ticks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">yy</span><span class="o">/</span><span class="mi">100000</span><span class="p">))</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$*10^5$&#39;</span><span class="p">))</span>
    <span class="n">ticks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;0&#39;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">yticks</span><span class="p">)</span>
    <span class="c1"># plot3.set_yticklabels(ticks,fontsize=6)</span>
    <span class="n">plot3</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
    <span class="c1"># plot1a.set_yticklabels([])</span>
    <span class="c1"># plot1a.set_yticks([])</span>
    <span class="c1"># plot.set_yscale(&quot;log&quot;)</span>
    <span class="c1"># plot2.set_yscale(&quot;log&quot;)</span>

    <span class="n">plot3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;8xn Grid [c]&#39;</span><span class="p">)</span>
    <span class="n">plot4</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Wall Clock Time [d]&#39;</span><span class="p">)</span>
    <span class="n">plot4</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Grid Dimension $n$&#39;</span><span class="p">)</span>
    <span class="c1"># plot3.set_ylabel(&#39;Operation Count (thousands)&#39;)</span>
    <span class="c1"># plot4.set_ylabel(&#39;Time&#39;)</span>
    <span class="c1"># plot3.ticklabel_format(axis=&#39;y&#39;,style=&#39;sci&#39;,scilimits=(0,0))</span>

    <span class="n">plot3</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plot4</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;figures/GridGraphComputeTime8.png&quot;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">RandomCubicGraphFigure</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;xtick&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;ytick&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span> <span class="c1">#labelsizes</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">titlesize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>  <span class="c1">#titlesize</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;legend&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>  <span class="c1">#legendsize</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="mf">3.5</span> <span class="c1">#plot size in inches</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="mf">3.5</span> <span class="c1">#plot size in inches</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">))</span> <span class="c1">#makes figure/canvas space</span>
    <span class="n">plot</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.6</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mf">.5</span> <span class="o">/</span> <span class="n">dy</span><span class="p">,</span> <span class="mf">2.75</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mf">2.75</span> <span class="o">/</span> <span class="n">dy</span><span class="p">])</span>
    <span class="c1"># plot2 = fig.add_axes([0.6 / dx, 0.5 / dy, 2.75 / dx, 1.25 / dy])</span>

    <span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;RcubicMCTRIALS64&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">lines</span><span class="o">=</span><span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">MCtrials</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="n">data</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
        <span class="n">n</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">n</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">MCtrials</span><span class="p">:</span>
            <span class="n">MCtrials</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">MCtrials</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">7</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span><span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">11</span><span class="p">])))</span>

    <span class="n">X</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">MIN</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">MAX</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">p10</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">p25</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">p50</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">p75</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">p90</span><span class="o">=</span><span class="p">[]</span>

    <span class="n">AVG</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">STD</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">19</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">):</span>
        <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="n">D</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">MCtrials</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="c1"># print(numpy.unique(D[:,1]))</span>
        <span class="c1"># y=numpy.array(Y[k])</span>

        <span class="n">xix</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">D</span><span class="p">[:,</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">AVG</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">D</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">STD</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">D</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]))</span>

        <span class="n">MIN</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">D</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">p10</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">D</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="mi">10</span><span class="p">))</span>
        <span class="n">p25</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">D</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="mi">25</span><span class="p">))</span>
        <span class="n">p50</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">D</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="mi">50</span><span class="p">))</span>
        <span class="n">p75</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">D</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="mi">75</span><span class="p">))</span>
        <span class="n">p90</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">D</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="mi">90</span><span class="p">))</span>
        <span class="n">MAX</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">D</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]))</span>

        <span class="c1"># AVG.append(numpy.average(D[:,1]))</span>
        <span class="c1"># STD.append(numpy.std(D[:,1]))</span>

        <span class="c1"># plot.plot(numpy.ones(D[:,0].shape[0])*k,D[:,0],&#39;.&#39;,label=&#39;n=&#39;+str(k))</span>
        <span class="c1"># plot2.plot(numpy.ones(D[:,0].shape[0])*k,D[:,1],&#39;.&#39;,label=&#39;n=&#39;+str(k))</span>
        <span class="c1"># plot.set_xscale(&quot;log&quot;)</span>
        <span class="c1"># plot.set_yscale(&quot;log&quot;)</span>
        <span class="c1"># plot2.set_yticks([i for i in numpy.linspace(numpy.min(D[:,1]),numpy.max(D[:,1]),6)])</span>
        <span class="c1"># print(numpy.average(D[:,1]))</span>
        <span class="c1"># plot2.set_yticklabels(plot2.get_yticks())</span>
        <span class="c1"># plot.set_title(&#39;MC trials needed to rule out $EC_{cubic}(G)$&#39;)</span>
        <span class="c1"># plot.set_xlabel(&#39;Needed MC Trials at 95% confidence&#39;)</span>
        <span class="c1"># plot.set_ylabel(&#39;$P(\# MC\ trials &lt; x)$&#39;)</span>
        <span class="c1"># plot.legend()</span>
        <span class="c1"># fig.savefig(&quot;RcubicSanityCheck.png&quot;,dpi=600)</span>
        <span class="c1"># input()</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">MIN</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Minimum&quot;</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">p10</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;$10^</span><span class="si">{th}</span><span class="s2">$ percentile&quot;</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">p25</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;$25^</span><span class="si">{th}</span><span class="s2">$ percentile&quot;</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">p50</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;$50^</span><span class="si">{th}</span><span class="s2">$ percentile&quot;</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">p75</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;$75^</span><span class="si">{th}</span><span class="s2">$ percentile&quot;</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">p90</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;$90^</span><span class="si">{th}</span><span class="s2">$ percentile&quot;</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">MAX</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Maximum&quot;</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
    <span class="c1"># plot.set_yscale(&quot;log&quot;)</span>
    <span class="c1"># plot2.plot(X,STD)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">MIN</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">MAX</span><span class="p">))</span>

    <span class="n">plot</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$(1-Rel_</span><span class="si">{ATR}</span><span class="s1">(G_</span><span class="si">{rc}</span><span class="s1">))$ vs |V|&#39;</span><span class="p">)</span>
    <span class="c1"># plot.set_xticklabels([])</span>
    <span class="c1"># plot.set_xticks([])</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;|V|&#39;</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$(1-Rel_</span><span class="si">{ATR}</span><span class="s1">(G_</span><span class="si">{rc}</span><span class="s1">))$&#39;</span><span class="p">)</span>

    <span class="c1"># plot2.set_title(&#39;Standard Deviation of $Rel_{ATR}(G_{rc})$ vs |V| [b]&#39;)</span>
    <span class="c1"># plot2.set_xlabel(&#39;|V|&#39;)</span>
    <span class="c1"># plot2.set_ylabel(&#39;std($Rel_{ATR}(G_{rc})$)&#39;)</span>

    <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">),</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">AVG</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
    <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">),</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">STD</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
    <span class="c1"># plot.plot(X,a*numpy.array(X)+b)</span>
    <span class="c1"># plot.plot(X,1-numpy.array(X)*.01**3)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;figures/RcubicReliability.png&quot;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">RandomCubicMonteCarlo</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;xtick&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;ytick&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span> <span class="c1">#labelsizes</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">titlesize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>  <span class="c1">#titlesize</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;legend&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>  <span class="c1">#legendsize</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="mf">3.5</span> <span class="c1">#plot size in inches</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1">#plot size in inches</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">))</span> <span class="c1">#makes figure/canvas space</span>
    <span class="n">plot</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.5</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">/</span> <span class="n">dy</span><span class="p">,</span> <span class="mf">2.75</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mf">1.25</span> <span class="o">/</span> <span class="n">dy</span><span class="p">])</span>

    <span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;analysis/RcubicMCTRIALS-ConnectedRandomCubic-0-10000-Vmin-20-Vmax-50-seed-64&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">lines</span><span class="o">=</span><span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">MCtrials</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="n">data</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
        <span class="n">n</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">n</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">MCtrials</span><span class="p">:</span>
            <span class="n">MCtrials</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">MCtrials</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">11</span><span class="p">]))</span>

    <span class="n">Y</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">52</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span>
        <span class="n">MCtrials</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">Y</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">MCtrials</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>
    <span class="c1"># MCtrials=numpy.array(MCtrials)</span>
    <span class="c1"># Y=numpy.linspace(0,1,MCtrials.shape[0])</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">19</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="p">):</span>
        <span class="n">plot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">MCtrials</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">Y</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;|N|=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
    <span class="c1"># plot.set_yscale(&quot;log&quot;)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;MC trials needed to rule out $EC_</span><span class="si">{cubic}</span><span class="s1">(G)$&#39;</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Needed MC Trials at 95</span><span class="si">% c</span><span class="s1">onfidence&#39;</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$P(\# MC\ trials &lt; x)$&#39;</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;figures/RcubicTrials.png&quot;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">RandomCubicWidthFigure</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;xtick&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;ytick&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span> <span class="c1">#labelsizes</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">titlesize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>  <span class="c1">#titlesize</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;legend&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>  <span class="c1">#legendsize</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="mf">3.5</span> <span class="c1">#plot size in inches</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="mf">3.0</span> <span class="c1">#plot size in inches</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">))</span> <span class="c1">#makes figure/canvas space</span>
    <span class="n">plot</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.5</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mf">1.75</span> <span class="o">/</span> <span class="n">dy</span><span class="p">,</span> <span class="mf">2.75</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">dy</span><span class="p">])</span>
    <span class="n">plot2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.5</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">/</span> <span class="n">dy</span><span class="p">,</span> <span class="mf">2.75</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">dy</span><span class="p">])</span>

    <span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;analysis/TreeWidthData-ConnectedRandomCubic-0-10000-Vmin-20-Vmax-400-seed-42&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">lines</span><span class="o">=</span><span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">TWvPW</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>
    <span class="n">TWvLGW</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>
    <span class="n">X</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">TW</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">PW</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">LGW</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="n">data</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
        <span class="n">n</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="n">TW</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
        <span class="n">PW</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
        <span class="n">LGW</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>

    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">X</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">TWvPW</span><span class="p">:</span>
            <span class="n">TWvPW</span><span class="p">[</span><span class="n">X</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">if</span> <span class="n">X</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">TWvLGW</span><span class="p">:</span>
            <span class="n">TWvLGW</span><span class="p">[</span><span class="n">X</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">TWvPW</span><span class="p">[</span><span class="n">X</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PW</span><span class="p">[</span><span class="n">X</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span><span class="o">/</span><span class="n">TW</span><span class="p">[</span><span class="n">X</span><span class="p">[</span><span class="n">k</span><span class="p">]])</span>
        <span class="n">TWvLGW</span><span class="p">[</span><span class="n">X</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">LGW</span><span class="p">[</span><span class="n">X</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span><span class="o">/</span><span class="n">TW</span><span class="p">[</span><span class="n">X</span><span class="p">[</span><span class="n">k</span><span class="p">]])</span>

    <span class="n">XR</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">TWvPWy</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">TWvLGWy</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">keys</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">TWvPW</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">keys</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
        <span class="n">TWvPWy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">TWvPW</span><span class="p">[</span><span class="n">n</span><span class="p">]))</span>
        <span class="n">TWvLGWy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">TWvLGW</span><span class="p">[</span><span class="n">n</span><span class="p">]))</span>
        <span class="n">XR</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">TW</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>

    <span class="n">plot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">TW</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">.05</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Treewidth&#39;</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">PW</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">.05</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pathwidth&#39;</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">LGW</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">.05</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$tw(LG(G))$&#39;</span><span class="p">)</span>
    <span class="c1"># plot.set_xscale(&quot;log&quot;)</span>
    <span class="c1"># plot.set_yscale(&quot;log&quot;)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Random Cubic Graph Width [a]&#39;</span><span class="p">)</span>
    <span class="c1"># plot.set_xlabel(&#39;$n$&#39;)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Width&#39;</span><span class="p">)</span>
    <span class="n">legn</span><span class="o">=</span><span class="n">plot</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">markerscale</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">lh</span> <span class="ow">in</span> <span class="n">legn</span><span class="o">.</span><span class="n">legendHandles</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">lh</span><span class="o">.</span><span class="n">_legmarker</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">lh</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># plot2.plot(XR,TWvPWy)</span>
    <span class="c1"># plot2.plot(XR,TWvLGWy)</span>
    <span class="n">plot2</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span> <span class="p">[])</span>
    <span class="n">plot2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">PW</span><span class="p">)</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">TW</span><span class="p">),</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">.2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\frac</span><span class="si">{Pathwidth}{Treewidth}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">plot2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">LGW</span><span class="p">)</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">TW</span><span class="p">),</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">.2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\frac{tw(LG(G))}</span><span class="si">{Treewidth}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">plot2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Width Ratios [b]&#39;</span><span class="p">)</span>
    <span class="n">plot2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$|V|$&#39;</span><span class="p">)</span>
    <span class="n">plot2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Width Ratio&#39;</span><span class="p">)</span>
    <span class="n">legn</span><span class="o">=</span><span class="n">plot2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">markerscale</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">lh</span> <span class="ow">in</span> <span class="n">legn</span><span class="o">.</span><span class="n">legendHandles</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">lh</span><span class="o">.</span><span class="n">_legmarker</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">lh</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">plot</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
    <span class="n">plot2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;figures/RcubicWidth.png&quot;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">RandomCubicWidthFigure_short</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;xtick&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;ytick&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span> <span class="c1">#labelsizes</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">titlesize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>  <span class="c1">#titlesize</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;legend&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>  <span class="c1">#legendsize</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="mf">3.5</span> <span class="c1">#plot size in inches</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="mf">1.7</span> <span class="c1">#plot size in inches</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">))</span> <span class="c1">#makes figure/canvas space</span>
    <span class="n">plot</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.5</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mf">0.4</span> <span class="o">/</span> <span class="n">dy</span><span class="p">,</span> <span class="mf">2.75</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">dy</span><span class="p">])</span>
    <span class="c1"># plot2 = fig.add_axes([0.5 / dx, 0.5 / dy, 2.75 / dx, 1.0 / dy])</span>

    <span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;analysis/TreeWidthData-ConnectedRandomCubic-0-10000-Vmin-20-Vmax-400-seed-42&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">lines</span><span class="o">=</span><span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">TWvPW</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>
    <span class="n">TWvLGW</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>
    <span class="n">X</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">TW</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">PW</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">LGW</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="n">data</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
        <span class="n">n</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="n">TW</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
        <span class="n">PW</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
        <span class="n">LGW</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>

    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">X</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">TWvPW</span><span class="p">:</span>
            <span class="n">TWvPW</span><span class="p">[</span><span class="n">X</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">if</span> <span class="n">X</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">TWvLGW</span><span class="p">:</span>
            <span class="n">TWvLGW</span><span class="p">[</span><span class="n">X</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">TWvPW</span><span class="p">[</span><span class="n">X</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PW</span><span class="p">[</span><span class="n">X</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span><span class="o">/</span><span class="n">TW</span><span class="p">[</span><span class="n">X</span><span class="p">[</span><span class="n">k</span><span class="p">]])</span>
        <span class="n">TWvLGW</span><span class="p">[</span><span class="n">X</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">LGW</span><span class="p">[</span><span class="n">X</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span><span class="o">/</span><span class="n">TW</span><span class="p">[</span><span class="n">X</span><span class="p">[</span><span class="n">k</span><span class="p">]])</span>

    <span class="n">XR</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">TWvPWy</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">TWvLGWy</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">keys</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">TWvPW</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">keys</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
        <span class="n">TWvPWy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">TWvPW</span><span class="p">[</span><span class="n">n</span><span class="p">]))</span>
        <span class="n">TWvLGWy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">TWvLGW</span><span class="p">[</span><span class="n">n</span><span class="p">]))</span>
        <span class="n">XR</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">TW</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>

    <span class="n">plot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">TW</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">.05</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Treewidth&#39;</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">PW</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">.05</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pathwidth&#39;</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">LGW</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">.05</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$tw(LG(G))$&#39;</span><span class="p">)</span>
    <span class="c1"># plot.set_xscale(&quot;log&quot;)</span>
    <span class="c1"># plot.set_yscale(&quot;log&quot;)</span>
    <span class="c1"># plot.set_xticklabels([])</span>
    <span class="c1"># plot.set_xticks([])</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Random Cubic Graph Width [a]&#39;</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$|N|$&#39;</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Width&#39;</span><span class="p">)</span>
    <span class="n">legn</span><span class="o">=</span><span class="n">plot</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">markerscale</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">lh</span> <span class="ow">in</span> <span class="n">legn</span><span class="o">.</span><span class="n">legendHandles</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">lh</span><span class="o">.</span><span class="n">_legmarker</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">lh</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># plot2.plot(XR,TWvPWy)</span>
    <span class="c1"># plot2.plot(XR,TWvLGWy)</span>
    <span class="c1"># plot2.plot([], [])</span>
    <span class="c1"># plot2.plot(X,numpy.array(PW)/numpy.array(TW),&#39;.&#39;,markersize=2,alpha=.2,label=r&#39;$\frac{Pathwidth}{Treewidth}$&#39;)</span>
    <span class="c1"># plot2.plot(X,numpy.array(LGW)/numpy.array(TW),&#39;.&#39;,markersize=2,alpha=.2,label=r&#39;$\frac{tw(LG(G))}{Treewidth}$&#39;)</span>
    <span class="c1"># plot2.set_title(&#39;Width Ratios [b]&#39;)</span>
    <span class="c1"># plot2.set_xlabel(&#39;$|V|$&#39;)</span>
    <span class="c1"># plot2.set_ylabel(&#39;Width Ratio&#39;)</span>
    <span class="c1"># legn=plot2.legend(markerscale=5)</span>
    <span class="c1"># for lh in legn.legendHandles:</span>
    <span class="c1">#     lh._legmarker.set_alpha(1)</span>

    <span class="n">plot</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
    <span class="c1"># plot2.set_xlim(20, 400)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;figures/RcubicWidth_short.png&quot;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">GridGraphnxnMonteCarlo</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;xtick&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;ytick&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span> <span class="c1">#labelsizes</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">titlesize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>  <span class="c1">#titlesize</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;legend&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>  <span class="c1">#legendsize</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="mf">3.5</span> <span class="c1">#plot size in inches</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="mf">3.5</span> <span class="c1">#plot size in inches</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">))</span> <span class="c1">#makes figure/canvas space</span>
    <span class="n">plot</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.5</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">dy</span><span class="p">,</span> <span class="mf">2.75</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mf">1.25</span> <span class="o">/</span> <span class="n">dy</span><span class="p">])</span>
    <span class="n">plot2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.5</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">/</span> <span class="n">dy</span><span class="p">,</span> <span class="mf">2.75</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mf">1.25</span> <span class="o">/</span> <span class="n">dy</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">ix</span><span class="p">,</span><span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mf">.5</span><span class="p">,</span><span class="mf">.9</span><span class="p">,</span><span class="mf">.99</span><span class="p">]):</span>
        <span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;GridsNvaryMCTRIALS&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="mi">100</span><span class="p">)),</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">=</span><span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="n">X</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">REL</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">EC</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">Y</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="n">data</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>

            <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

            <span class="n">REL</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="n">EC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
            <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">7</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>

        <span class="n">plot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">REL</span><span class="p">,</span><span class="s1">&#39;-1&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$Rel(G)$, $p=&#39;</span><span class="o">+</span><span class="s2">&quot;</span><span class="si">{:1.2}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">p</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;$&#39;</span><span class="p">)</span>
        <span class="n">plot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">EC</span><span class="p">,</span><span class="s1">&#39;:2&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$EC(G)$, $p=&#39;</span><span class="o">+</span><span class="s2">&quot;</span><span class="si">{:1.2}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">p</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;$&#39;</span><span class="p">)</span>
        <span class="n">plot2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$p=&#39;</span><span class="o">+</span><span class="s2">&quot;</span><span class="si">{:1.2}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">p</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;$&#39;</span><span class="p">)</span>

    <span class="n">plot</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
    <span class="c1"># plot1a.set_yticklabels([])</span>
    <span class="c1"># plot1a.set_yticks([])</span>
    <span class="n">plot2</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>

    <span class="n">plot</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Grid Graph $Rel(G)$ and $EC(G)$ [a]&#39;</span><span class="p">)</span>
    <span class="n">plot2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;MC Trials Needed to Exclude $EC(G)$ [b]&#39;</span><span class="p">)</span>
    <span class="n">plot2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Grid Dimension $n$&#39;</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Probability&#39;</span><span class="p">)</span>
    <span class="n">plot2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Monte Carlo Trials&#39;</span><span class="p">)</span>
    <span class="n">plot2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100000000</span><span class="p">)</span>

    <span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">handles</span><span class="o">=</span><span class="n">handles</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">plot2</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
    <span class="n">plot2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">,</span><span class="n">handles</span><span class="o">=</span><span class="n">handles</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;figures/GridGraphMCtrials.png&quot;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">TreewidthCompare</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;xtick&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;ytick&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span> <span class="c1">#labelsizes</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">titlesize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>  <span class="c1">#titlesize</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;legend&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>  <span class="c1">#legendsize</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="mf">3.5</span> <span class="c1">#plot size in inches</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="mf">3.5</span> <span class="c1">#plot size in inches</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">))</span> <span class="c1">#makes figure/canvas space</span>
    <span class="n">plot1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.5</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">dy</span><span class="p">,</span> <span class="mf">2.0</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mf">1.25</span> <span class="o">/</span> <span class="n">dy</span><span class="p">])</span>
    <span class="n">plot1a</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">2.6</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">dy</span><span class="p">,</span> <span class="mf">0.375</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mf">1.25</span> <span class="o">/</span> <span class="n">dy</span><span class="p">])</span>
    <span class="n">plot1b</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">3.075</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">dy</span><span class="p">,</span> <span class="mf">0.375</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mf">1.25</span> <span class="o">/</span> <span class="n">dy</span><span class="p">])</span>

    <span class="n">plot2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.5</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">/</span> <span class="n">dy</span><span class="p">,</span> <span class="mf">2.0</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mf">1.25</span> <span class="o">/</span> <span class="n">dy</span><span class="p">])</span>
    <span class="n">plot2a</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">2.6</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">/</span> <span class="n">dy</span><span class="p">,</span> <span class="mf">0.375</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mf">1.25</span> <span class="o">/</span> <span class="n">dy</span><span class="p">])</span>
    <span class="n">plot2b</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">3.075</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">/</span> <span class="n">dy</span><span class="p">,</span> <span class="mf">0.375</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mf">1.25</span> <span class="o">/</span> <span class="n">dy</span><span class="p">])</span>

    <span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;analysis/TreeWidthData-ConnectedRandomCubic-0-10000-Vmin-20-Vmax-400-seed-42&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">lines</span><span class="o">=</span><span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">RCedges</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">RCTW</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">RCLGW</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="n">data</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
        <span class="n">RCedges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">RCTW</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
        <span class="n">RCLGW</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>

    <span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;analysis/PowerGridsREL99&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">lines</span><span class="o">=</span><span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">PGedges</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">PGTW</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">PGLGW</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="n">data</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;NA&#39;</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">PGedges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
        <span class="n">PGTW</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">]))</span>
        <span class="n">PGLGW</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">10</span><span class="p">]))</span>

    <span class="n">SQedges</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">SQTW</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">SQLGW</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">22</span><span class="p">):</span>
        <span class="n">SQedges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">SQTW</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="n">SQLGW</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">plot1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">SQedges</span><span class="p">,</span><span class="n">SQTW</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Square Grid TW&#39;</span><span class="p">)</span>
    <span class="n">plot1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">RCedges</span><span class="p">,</span><span class="n">RCTW</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">.05</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Random Cubic TW&#39;</span><span class="p">)</span>
    <span class="n">plot1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">PGedges</span><span class="p">,</span><span class="n">PGTW</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Power Grid TW&#39;</span><span class="p">)</span>

    <span class="n">plot2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">SQedges</span><span class="p">,</span><span class="n">SQLGW</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Square Grid $tw(LG(G))$&#39;</span><span class="p">)</span>
    <span class="n">plot2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">RCedges</span><span class="p">,</span><span class="n">RCLGW</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">.05</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Random Cubic $tw(LG(G))$&#39;</span><span class="p">)</span>
    <span class="n">plot2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">PGedges</span><span class="p">,</span><span class="n">PGLGW</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Power Grid $tw(LG(G))$&#39;</span><span class="p">)</span>
    <span class="n">plot1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

    <span class="n">plot1a</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">SQedges</span><span class="p">,</span><span class="n">SQTW</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Square Grid TW&#39;</span><span class="p">)</span>
    <span class="n">plot1a</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span> <span class="p">[])</span>
    <span class="n">plot1a</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">PGedges</span><span class="p">,</span><span class="n">PGTW</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Power Grid TW&#39;</span><span class="p">)</span>
    <span class="n">plot1b</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">SQedges</span><span class="p">,</span><span class="n">SQTW</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Square Grid TW&#39;</span><span class="p">)</span>
    <span class="n">plot1b</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span> <span class="p">[])</span>
    <span class="n">plot1b</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">PGedges</span><span class="p">,</span><span class="n">PGTW</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Power Grid TW&#39;</span><span class="p">)</span>
    <span class="n">plot1a</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">360</span><span class="p">,</span> <span class="mi">425</span><span class="p">)</span>
    <span class="n">plot1b</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">755</span><span class="p">,</span> <span class="mi">845</span><span class="p">)</span>
    <span class="n">plot1a</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
    <span class="n">plot1b</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>

    <span class="n">plot2a</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">SQedges</span><span class="p">,</span><span class="n">SQLGW</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Square Grid TW&#39;</span><span class="p">)</span>
    <span class="n">plot2a</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span> <span class="p">[])</span>
    <span class="n">plot2a</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">PGedges</span><span class="p">,</span><span class="n">PGLGW</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Power Grid TW&#39;</span><span class="p">)</span>
    <span class="n">plot2b</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">SQedges</span><span class="p">,</span><span class="n">SQLGW</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Square Grid TW&#39;</span><span class="p">)</span>
    <span class="n">plot2b</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span> <span class="p">[])</span>
    <span class="n">plot2b</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">PGedges</span><span class="p">,</span><span class="n">PGLGW</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Power Grid TW&#39;</span><span class="p">)</span>
    <span class="n">plot2a</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">360</span><span class="p">,</span> <span class="mi">425</span><span class="p">)</span>
    <span class="n">plot2b</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">755</span><span class="p">,</span> <span class="mi">845</span><span class="p">)</span>
    <span class="n">plot2a</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
    <span class="n">plot2b</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>


    <span class="n">plot2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
    <span class="n">plot1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
    <span class="n">plot2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>

    <span class="n">plot1a</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
    <span class="n">plot1a</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
    <span class="n">plot1b</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
    <span class="n">plot1b</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
    <span class="n">plot1a</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
    <span class="n">plot1a</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
    <span class="n">plot1b</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
    <span class="n">plot1b</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>

    <span class="n">plot2</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">plot2</span><span class="o">.</span><span class="n">get_xticks</span><span class="p">()])</span>
    <span class="n">plot2</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">plot2</span><span class="o">.</span><span class="n">get_xticks</span><span class="p">(),</span><span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
    <span class="n">plot2a</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">360</span><span class="p">,</span> <span class="mi">390</span><span class="p">,</span> <span class="mi">425</span><span class="p">])</span>
    <span class="n">plot2a</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">plot2a</span><span class="o">.</span><span class="n">get_xticks</span><span class="p">(),</span><span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
    <span class="n">plot2b</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">755</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">845</span><span class="p">])</span>
    <span class="n">plot2b</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">plot2b</span><span class="o">.</span><span class="n">get_xticks</span><span class="p">(),</span><span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>

    <span class="n">plot2a</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
    <span class="n">plot2a</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
    <span class="n">plot2b</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
    <span class="n">plot2b</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>

    <span class="n">plot1</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
    <span class="n">plot1</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
    <span class="n">plot1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Treewidth Comparison [a]&#39;</span><span class="p">)</span>
    <span class="n">plot2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$tw(LG(G))$ Comparison [b]&#39;</span><span class="p">)</span>
    <span class="n">plot2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$|E|$&#39;</span><span class="p">)</span>
    <span class="n">plot1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Treewidth&#39;</span><span class="p">)</span>
    <span class="n">plot2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$tw(LG(G))$&#39;</span><span class="p">)</span>

    <span class="n">legn</span><span class="o">=</span><span class="n">plot1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">markerscale</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">lh</span> <span class="ow">in</span> <span class="n">legn</span><span class="o">.</span><span class="n">legendHandles</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">lh</span><span class="o">.</span><span class="n">_legmarker</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">lh</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">legn</span><span class="o">=</span><span class="n">plot2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">markerscale</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">lh</span> <span class="ow">in</span> <span class="n">legn</span><span class="o">.</span><span class="n">legendHandles</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">lh</span><span class="o">.</span><span class="n">_legmarker</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">lh</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;figures/WidthCompare.png&quot;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">PowerGridMonteCarlo</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;xtick&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;ytick&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span> <span class="c1">#labelsizes</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">titlesize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>  <span class="c1">#titlesize</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;legend&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>  <span class="c1">#legendsize</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="mf">3.5</span> <span class="c1">#plot size in inches</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1">#plot size in inches</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">))</span> <span class="c1">#makes figure/canvas space</span>
    <span class="n">plot</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.5</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">/</span> <span class="n">dy</span><span class="p">,</span> <span class="mf">2.75</span> <span class="o">/</span> <span class="n">dx</span><span class="p">,</span> <span class="mf">1.25</span> <span class="o">/</span> <span class="n">dy</span><span class="p">])</span>
    <span class="c1"># plot2 = fig.add_axes([0.5 / dx, 0.5 / dy, 2.75 / dx, 1.25 / dy])</span>

    <span class="n">width</span><span class="o">=</span><span class="mf">.25</span>
    <span class="k">for</span> <span class="n">ix</span><span class="p">,</span><span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mf">.5</span><span class="p">,</span><span class="mf">.9</span><span class="p">,</span><span class="mf">.99</span><span class="p">]):</span>
        <span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;analysis/PowerGridsRELMC&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="mi">100</span><span class="p">)),</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">=</span><span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="n">X</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">Y</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="n">data</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
            <span class="c1"># X.append(int(data[2]))</span>
            <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="c1"># X.append(None)</span>
            <span class="c1"># print(float(data[-1][:-1]))</span>
            <span class="c1"># Y.append(0)</span>
            <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
            <span class="c1"># Y.append(None)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1000000</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>


        <span class="c1"># print(X)</span>
        <span class="c1"># print(Y)</span>
        <span class="c1"># plot.plot(Y,X,&#39;.&#39;)</span>
        <span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">ix</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">width</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">width</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;p=&quot;</span><span class="o">+</span><span class="s1">&#39;</span><span class="si">{:0.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">p</span><span class="p">))</span>
        <span class="n">plot</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
        <span class="c1"># plot.set_xscale(&quot;log&quot;)</span>
    <span class="c1"># plot.set_xlim(1, 58)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">56</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">+</span><span class="p">[</span><span class="mi">58</span><span class="p">])</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Power Grid MC Trials to Rule Out $EC(G)$&#39;</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Power Grid ID&#39;</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Mc Trials&#39;</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;figures/PowerGridMC.png&quot;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">PowerGridTable</span><span class="p">():</span>
    <span class="c1">### Test 5, Make Infrastructure Table</span>
    <span class="n">D</span><span class="o">=</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">14</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">55</span><span class="p">)]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
    <span class="n">RELtime</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">55</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
    <span class="n">ECtime</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">55</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">ix</span><span class="p">,</span><span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="s1">&#39;50&#39;</span><span class="p">,</span><span class="s1">&#39;90&#39;</span><span class="p">,</span><span class="s1">&#39;99&#39;</span><span class="p">]):</span>
        <span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;analysis/PowerGridsREL&#39;</span><span class="o">+</span><span class="n">k</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">=</span><span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">ix2</span><span class="p">,</span><span class="n">l</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
            <span class="n">data</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
            <span class="n">D</span><span class="p">[</span><span class="n">ix2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">D</span><span class="p">[</span><span class="n">ix2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">D</span><span class="p">[</span><span class="n">ix2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">D</span><span class="p">[</span><span class="n">ix2</span><span class="p">][</span><span class="mi">7</span><span class="o">+</span><span class="n">ix</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
            <span class="c1"># D[ix2][6].append(data[4])</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">RELtime</span><span class="p">[</span><span class="n">ix2</span><span class="p">,</span><span class="n">ix</span><span class="p">]</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">D</span><span class="p">[</span><span class="n">ix2</span><span class="p">][</span><span class="mi">6</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;NA&#39;</span>
            <span class="n">D</span><span class="p">[</span><span class="n">ix2</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
            <span class="n">D</span><span class="p">[</span><span class="n">ix2</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
            <span class="n">D</span><span class="p">[</span><span class="n">ix2</span><span class="p">][</span><span class="mi">11</span><span class="o">+</span><span class="n">ix</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>
            <span class="c1"># D[ix2][10].append(data[9])</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">ECtime</span><span class="p">[</span><span class="n">ix2</span><span class="p">,</span><span class="n">ix</span><span class="p">]</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">9</span><span class="p">])</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">D</span><span class="p">[</span><span class="n">ix2</span><span class="p">][</span><span class="mi">10</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;NA&#39;</span>
            <span class="n">D</span><span class="p">[</span><span class="n">ix2</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span>
            <span class="c1"># print(D)</span>
            <span class="c1"># input()</span>

    <span class="c1"># print(D)</span>
    <span class="c1"># input()</span>

    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">D</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">D</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">6</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;NA&#39;</span><span class="p">:</span>
            <span class="n">D</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">6</span><span class="p">]</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">RELtime</span><span class="p">[</span><span class="n">k</span><span class="p">,:])</span>
        <span class="k">if</span> <span class="n">D</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">10</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;NA&#39;</span><span class="p">:</span>
            <span class="n">D</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">10</span><span class="p">]</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">ECtime</span><span class="p">[</span><span class="n">k</span><span class="p">,:])</span>

    <span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;tables/PowerGridsRELTable.tex&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">D</span><span class="p">)):</span>

        <span class="n">data</span><span class="o">=</span><span class="n">D</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39; &amp; &#39;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39; &amp; &#39;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39; &amp; &#39;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39; &amp; &#39;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39; &amp; &#39;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39; &amp; &#39;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:4.6f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">6</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39; &amp; &#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:4.8f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">7</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39; &amp; &#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:4.8f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">8</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39; &amp; &#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:4.8f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">9</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39; &amp; &#39;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;NA &amp; &#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;NA &amp; &#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;NA &amp; &#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;NA &amp; &#39;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:4.6f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">10</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39; &amp; &#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:4.8f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">11</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39; &amp; &#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:4.8f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">12</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39; &amp; &#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:4.8f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">13</span><span class="p">]))</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39; \tabularnewline&#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;NA &amp; &#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;NA &amp; &#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;NA &amp; &#39;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;NA \tabularnewline&#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">PowerGridTable</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>This module contains functions to create the figures seen in the ICOSSAR 2021 paper.</p>
</div>


                </section>
                <section id="reliability">
                                <div class="attr module"><a class="headerlink" href="#reliability">#&nbsp;&nbsp</a>
<span class="name"><a href="ICOSSAR_2021/reliability.html">ICOSSAR_2021.reliability</a></span></div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">This module calculates the reliability of undirected graphs.</span>
<span class="sd">Using tree decomposition algorithms, these functions optimize the edge factor ordering before the reliability calculations are performed.</span>

<span class="sd">Functions</span>
<span class="sd">---------</span>
<span class="sd">**ATR(EdgeList,ATRverbose=False,TreeWidthCalcTime=6) :**</span>
<span class="sd">    Calculates the All Terminal Reliability of a undirected graph defined by EdgeList.</span>

<span class="sd">**EdgeCover(EdgeList,ECverbose=False,TreeWidthCalcTime=6) :**</span>
<span class="sd">    Calculates the Edge Cover of a undirected graph defined by EdgeList.</span>

<span class="sd">Notes</span>
<span class="sd">-----</span>
<span class="sd">When the reliability calculation is first executed, numba performs jit compilation. This causes the first execution to take several seconds to run, but the compilation is cached and future runs with different inputs do not need to recompile.</span>

<span class="sd">The tree decomposition algorithms are written for UNIX operating environments, so windows environments must have the ability to run &quot;wsl.exe&quot; to properly execute these code packages.</span>

<span class="sd">Currently just for All Terminal Reliability. K-Terminal Reliability can be implemented in the future.</span>

<span class="sd">Examples</span>
<span class="sd">--------</span>
<span class="sd">&gt;&gt;&gt; import reliability</span>
<span class="sd">&gt;&gt;&gt; n=5</span>
<span class="sd">&gt;&gt;&gt; EdgeList=[]</span>
<span class="sd">&gt;&gt;&gt; for k1 in range(0,n-1):</span>
<span class="sd">&gt;&gt;&gt;     for k2 in range(k1+1,n):</span>
<span class="sd">&gt;&gt;&gt;         EdgeList.append((k1,k2))</span>

<span class="sd">&gt;&gt;&gt; EdgeList=numpy.array(EdgeList)</span>
<span class="sd">&gt;&gt;&gt; EP=numpy.ones(EdgeList.shape[0])*.5</span>
<span class="sd">&gt;&gt;&gt; REL,SetixTotal,SetixMax=reliability.ATR(EdgeList,EP)</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">cwd</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">cwd</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">time</span>

<span class="kn">import</span> <span class="nn">numpy</span>

<span class="kn">import</span> <span class="nn">general_utilities</span>
<span class="kn">import</span> <span class="nn">tensor_network_contraction</span>
<span class="kn">import</span> <span class="nn">ContractionOrdering</span>
<span class="kn">import</span> <span class="nn">ATRnumbaTrie</span>
<span class="kn">from</span> <span class="nn">tree_width</span> <span class="kn">import</span> <span class="n">TreeWidth</span>

<span class="c1"># input a list of edges, E</span>
<span class="c1"># E[x]=(n1,n2,p)</span>
<span class="c1"># n1=head of edge</span>
<span class="c1"># n2=tail of edge</span>
<span class="c1"># p=probability of edge existing, float between 0 and 1</span>

<span class="c1"># each node is labeled as an integer from 0 to n.</span>

<span class="k">def</span> <span class="nf">ATR</span><span class="p">(</span><span class="n">EdgeList</span><span class="p">,</span><span class="n">ATRverbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">TreeWidthCalcTime</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">ID</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This function determines the All Terminal Reliability of a given graph. It calls the functions to optimize the edge contraction order, and calls the function to calculate the All Terminal Reliability.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    EdgeList : list of tuples, (int,int,float)</span>
<span class="sd">        EdgeList[i] is the ith edge of the graph.</span>
<span class="sd">        EdgeList[i][0] and EdgeList[i][1] are the node labels that the edge connects.</span>
<span class="sd">        EdgeList[i][2] is the probability of the edge not failing, the edge reliability.</span>

<span class="sd">    ATRverbose : bool</span>
<span class="sd">        bool controlling the amount of text output to the console</span>

<span class="sd">    TreeWidthCalcTime : int</span>
<span class="sd">        length of time in seconds to compute the tree decomposition of the graph. First this length of time is used to attempt to exactly solve for a tree decomposition. If the solver does not finish in time, an approximate solver is used for this length of time.</span>

<span class="sd">    ID : string</span>
<span class="sd">        When this function is called in a parallel application, a unique ID should be passed so the tree decomposition programs do not overwrite each others output</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Result : dictionary</span>
<span class="sd">        Result[&#39;REL&#39;]=All Terminal Reliability of the graph</span>
<span class="sd">        Result[&#39;CalculationEffort&#39;]=Total subgraphs computed</span>
<span class="sd">        Result[&#39;RELtime&#39;]=Wall clock computation time</span>
<span class="sd">        Result[&#39;TreeWidthSize&#39;]=Treewidth</span>
<span class="sd">        Result[&#39;PathWidthSize&#39;]=Pathwidth</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    When the reliability calculation is first executed, numba performs jit compilation. This causes the first execution to take several seconds to run, but the compilation is cached and future runs with different inputs do not need to recompile.</span>

<span class="sd">    Each run is not identical, the treewidth solvers use their own internal Pseudo-RNG and do not expose a way to set this seed. Therefore, while Result[&#39;REL&#39;] should be the same each time, the computational effort may not be the same on each run.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; EdgeList=[  (0,1,.5),</span>
<span class="sd">                    (0,2,.5),</span>
<span class="sd">                    (0,3,.5),</span>
<span class="sd">                    (1,2,.5),</span>
<span class="sd">                    (1,3,.5),</span>
<span class="sd">                    (2,3,.5)]</span>
<span class="sd">    &gt;&gt;&gt; TreeWidthCalcTime=60</span>
<span class="sd">    &gt;&gt;&gt; ID=&#39;64&#39;</span>
<span class="sd">    &gt;&gt;&gt; Results=ATR(EdgeList,TreeWidthCalcTime=6,ID=ID)</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">TreeWidthSize</span><span class="o">=</span><span class="kc">None</span>
    <span class="n">PathWidthSize</span><span class="o">=</span><span class="kc">None</span>
    <span class="c1"># if the treewidth calculation time is not set to zero, optimize the edge ordering</span>
    <span class="k">if</span> <span class="n">TreeWidthCalcTime</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">Fname</span><span class="o">=</span><span class="n">TreeWidth</span><span class="o">.</span><span class="n">TreeWidthExact</span><span class="p">(</span><span class="n">EdgeList</span><span class="p">,</span><span class="n">seconds</span><span class="o">=</span><span class="n">TreeWidthCalcTime</span><span class="p">,</span><span class="n">ID</span><span class="o">=</span><span class="n">ID</span><span class="o">+</span><span class="s1">&#39;ATR&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Obtained Tree Decomposition&#39;</span><span class="p">)</span>

        <span class="c1"># GET EDGE CONTRACTION ORDER</span>
        <span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">Fname</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">=</span><span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">Fname</span><span class="p">)</span>
        <span class="n">bags</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">tree</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;c&#39;</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;s&#39;</span><span class="p">:</span>
                <span class="n">data</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                <span class="n">tree</span><span class="o">=</span><span class="p">[[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]))]</span>
                <span class="n">TreeWidthSize</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;b&#39;</span><span class="p">:</span>
                <span class="n">data</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                <span class="n">d</span><span class="o">=</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">:]]</span>
                <span class="n">bags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="n">data</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>

            <span class="n">tree</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">tree</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># get the pathwidth optimized order</span>
        <span class="n">order</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">ContractionOrdering</span><span class="o">.</span><span class="n">ContractionOrder</span><span class="p">(</span><span class="n">bags</span><span class="p">,</span><span class="n">tree</span><span class="p">)</span>

        <span class="n">NodeOrder</span><span class="p">,</span><span class="n">PathWidthSize</span><span class="o">=</span><span class="n">ContractionOrdering</span><span class="o">.</span><span class="n">GetNodeOrdering</span><span class="p">(</span><span class="n">order</span><span class="p">,</span><span class="n">bags</span><span class="p">,</span><span class="n">tree</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">Gix</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ix</span><span class="p">,</span><span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">NodeOrder</span><span class="p">):</span>
            <span class="n">Gix</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=</span><span class="n">ix</span>

        <span class="n">ELin</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">EdgeList</span><span class="p">:</span>
            <span class="n">Edge</span><span class="o">=</span><span class="p">[</span><span class="n">Gix</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span><span class="n">Gix</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]]]</span>
            <span class="n">Edge</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="n">ELin</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">Edge</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">Edge</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
        <span class="n">ELin</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

        <span class="n">EP</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">ix</span><span class="p">,</span><span class="n">e</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ELin</span><span class="p">):</span>
            <span class="n">ELin</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">EP</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

        <span class="n">ELin</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ELin</span><span class="p">)</span>
        <span class="n">EP</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">EP</span><span class="p">)</span>

        <span class="c1"># start wall clock time</span>
        <span class="n">t</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="c1"># call main calculation function</span>
        <span class="n">REL</span><span class="p">,</span><span class="n">SetixTotal</span><span class="p">,</span><span class="n">SetixMax</span><span class="o">=</span><span class="n">ATRnumbaTrie</span><span class="o">.</span><span class="n">ATR</span><span class="p">(</span><span class="n">ELin</span><span class="p">,</span><span class="n">EP</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="n">ATRverbose</span><span class="p">)</span>

    <span class="c1"># if treewidth calculation time set to zero,</span>
    <span class="c1"># assume the edgelist is already in an optimal order</span>
    <span class="c1"># some classes of graphs such as grids have easy to specify optimal orders</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ELin</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">EdgeList</span><span class="p">:</span>
            <span class="n">Edge</span><span class="o">=</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">Edge</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="n">ELin</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">Edge</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">Edge</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
        <span class="n">ELin</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

        <span class="n">EP</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">ix</span><span class="p">,</span><span class="n">e</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ELin</span><span class="p">):</span>
            <span class="n">ELin</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">EP</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

        <span class="n">ELin</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ELin</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
        <span class="n">EP</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">EP</span><span class="p">)</span>

        <span class="c1"># start wall clock time</span>
        <span class="n">t</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="c1"># call main calculation function</span>
        <span class="n">REL</span><span class="p">,</span><span class="n">SetixTotal</span><span class="p">,</span><span class="n">SetixMax</span><span class="o">=</span><span class="n">ATRnumbaTrie</span><span class="o">.</span><span class="n">ATR</span><span class="p">(</span><span class="n">ELin</span><span class="p">,</span><span class="n">EP</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="n">ATRverbose</span><span class="p">)</span>

    <span class="n">RELtime</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t</span>
    <span class="n">Result</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>
    <span class="n">Result</span><span class="p">[</span><span class="s1">&#39;REL&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">REL</span>
    <span class="n">Result</span><span class="p">[</span><span class="s1">&#39;CalculationEffort&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">SetixTotal</span>
    <span class="n">Result</span><span class="p">[</span><span class="s1">&#39;RELtime&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">RELtime</span>
    <span class="n">Result</span><span class="p">[</span><span class="s1">&#39;TreeWidthSize&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">TreeWidthSize</span>
    <span class="n">Result</span><span class="p">[</span><span class="s1">&#39;PathWidthSize&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">PathWidthSize</span>
    <span class="k">return</span> <span class="n">Result</span>

<span class="k">def</span> <span class="nf">EdgeCover</span><span class="p">(</span><span class="n">EdgeList</span><span class="p">,</span><span class="n">ECverbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">TreeWidthCalcTime</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">ID</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This function determines the Edge Cover of a given graph, the probability the remaining edges cover all nodes in the graph. It calls the functions to optimize the edge contraction order, and calls the tensor network contraction function to calculate the Edge Cover.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    EdgeList : list of tuples, (int,int,float)</span>
<span class="sd">        EdgeList[i] is the ith edge of the graph.</span>
<span class="sd">        EdgeList[i][0] and EdgeList[i][1] are the node labels that the edge connects.</span>
<span class="sd">        EdgeList[i][2] is the probability of the edge not failing, the edge reliability.</span>

<span class="sd">    ECverbose : bool</span>
<span class="sd">        bool controlling the amount of text output to the console</span>

<span class="sd">    TreeWidthCalcTime : int</span>
<span class="sd">        length of time in seconds to compute the tree decomposition of the graph. First this length of time is used to attempt to exactly solve for a tree decomposition. If the solver does not finish in time, an approximate solver is used for this length of time.</span>

<span class="sd">    ID : string</span>
<span class="sd">        When this function is called in a parallel application, a unique ID should be passed so the tree decomposition programs do not overwrite each others output</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Result : dictionary</span>
<span class="sd">        Result[&#39;EC&#39;]=Edge Cover probability of the graph</span>
<span class="sd">        Result[&#39;CalculationEffort&#39;]=Total subgraphs computed</span>
<span class="sd">        Result[&#39;ECtime&#39;]=Wall clock computation time</span>
<span class="sd">        Result[&#39;LineGraphWidth&#39;]=Line Graph Treewidth</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    When the reliability calculation is first executed, numba performs jit compilation. This causes the first execution to take several seconds to run, but the compilation is cached and future runs with different inputs do not need to recompile.</span>

<span class="sd">    Each run is not identical, the treewidth solvers use their own internal Pseudo-RNG and do not expose a way to set this seed. Therefore, while Result[&#39;REL&#39;] should be the same each time, the computational effort may not be the same on each run.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; EdgeList=[  (0,1,.5),</span>
<span class="sd">                    (0,2,.5),</span>
<span class="sd">                    (0,3,.5),</span>
<span class="sd">                    (1,2,.5),</span>
<span class="sd">                    (1,3,.5),</span>
<span class="sd">                    (2,3,.5)]</span>
<span class="sd">    &gt;&gt;&gt; TreeWidthCalcTime=60</span>
<span class="sd">    &gt;&gt;&gt; ID=&#39;64&#39;</span>
<span class="sd">    &gt;&gt;&gt; Results=EdgeCover(EdgeList,TreeWidthCalcTime=6,ID=ID)</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">LineGraphWidth</span><span class="o">=</span><span class="kc">None</span>
    <span class="k">if</span> <span class="n">TreeWidthCalcTime</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">Gline</span><span class="o">=</span><span class="n">general_utilities</span><span class="o">.</span><span class="n">_EdgeListtoLine</span><span class="p">(</span><span class="n">EdgeList</span><span class="p">)</span>
        <span class="n">Gix</span><span class="p">,</span><span class="n">ixTdict</span><span class="p">,</span><span class="n">dictTix</span><span class="o">=</span><span class="n">general_utilities</span><span class="o">.</span><span class="n">_DictToix</span><span class="p">(</span><span class="n">Gline</span><span class="p">)</span>
        <span class="n">EdgeListLine</span><span class="o">=</span><span class="n">general_utilities</span><span class="o">.</span><span class="n">_ixDictToEdgeList</span><span class="p">(</span><span class="n">Gix</span><span class="p">)</span>
        <span class="n">Fname</span><span class="o">=</span><span class="n">TreeWidth</span><span class="o">.</span><span class="n">TreeWidthExact</span><span class="p">(</span><span class="n">EdgeListLine</span><span class="p">,</span><span class="n">seconds</span><span class="o">=</span><span class="n">TreeWidthCalcTime</span><span class="p">,</span><span class="n">ID</span><span class="o">=</span><span class="n">ID</span><span class="o">+</span><span class="s1">&#39;EC&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Obtained Tree Decomposition&#39;</span><span class="p">)</span>

        <span class="c1">#### GET EDGE CONTRACTION ORDER</span>
        <span class="c1"># read tree decomposition</span>
        <span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">Fname</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">=</span><span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">Fname</span><span class="p">)</span>
        <span class="n">bags</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">tree</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;c&#39;</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;s&#39;</span><span class="p">:</span>
                <span class="n">data</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                <span class="n">tree</span><span class="o">=</span><span class="p">[[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]))]</span>
                <span class="n">LineGraphWidth</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;b&#39;</span><span class="p">:</span>
                <span class="n">data</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                <span class="n">d</span><span class="o">=</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">:]]</span>
                <span class="n">bags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="n">data</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>

            <span class="n">tree</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">tree</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Get True Bags</span>
        <span class="n">EdgeBags</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">bags</span><span class="p">:</span>
            <span class="n">BB</span><span class="o">=</span><span class="p">[]</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">b</span><span class="p">:</span>
                <span class="n">BB</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ixTdict</span><span class="p">[</span><span class="n">n</span><span class="p">])</span>
            <span class="n">EdgeBags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">BB</span><span class="p">)</span>

        <span class="c1"># contract in tree decomposition, leafs inward</span>
        <span class="n">EdgeOrder</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">MutTree</span><span class="o">=</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">tree</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">tree</span><span class="p">))]</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">MutTree</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">EC</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">EdgeBags</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">EdgeBags</span><span class="p">[</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]]))</span>
                    <span class="n">EdgeOrder</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">EC</span><span class="p">)</span>
                    <span class="n">MutTree</span><span class="p">[</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                    <span class="n">MutTree</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="k">break</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">MutTree</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">EC</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">EdgeBags</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">EdgeBags</span><span class="p">[</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]]))</span>
                <span class="n">EdgeOrder</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">EC</span><span class="p">)</span>
                <span class="k">break</span>

        <span class="c1"># create Node Tensors</span>
        <span class="n">G</span><span class="o">=</span><span class="n">general_utilities</span><span class="o">.</span><span class="n">_EdgeListtoG</span><span class="p">(</span><span class="n">EdgeList</span><span class="p">)</span>
        <span class="n">Nodes</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">G</span><span class="p">:</span>
            <span class="n">TT</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="nb">len</span><span class="p">(</span><span class="n">G</span><span class="p">[</span><span class="n">n</span><span class="p">]))</span>
            <span class="n">TT</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
            <span class="n">Edges</span><span class="o">=</span><span class="p">[]</span>
            <span class="c1"># for e in G[n]:</span>
            <span class="c1">#     EE=[n,e]</span>
            <span class="c1">#     EE.sort()</span>
            <span class="c1">#     EE=tuple(EE)</span>
            <span class="c1">#     Edges.append(EE)</span>
            <span class="n">Nodes</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">TT</span><span class="p">,</span><span class="nb">tuple</span><span class="p">(</span><span class="n">G</span><span class="p">[</span><span class="n">n</span><span class="p">])))</span>

        <span class="c1"># REL,SetixTotal,SetixMax=tensor_network_contraction.ATR(ELin,EP,verbose=ATRverbose)</span>
        <span class="n">t</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">EC</span><span class="p">,</span><span class="n">CalculationEffort</span><span class="o">=</span><span class="n">tensor_network_contraction</span><span class="o">.</span><span class="n">Main</span><span class="p">(</span><span class="n">Nodes</span><span class="p">,</span><span class="n">EdgeOrder</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="n">ECverbose</span><span class="p">)</span>
        <span class="c1"># print(EC)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># create Node Tensors</span>
        <span class="n">G</span><span class="o">=</span><span class="n">general_utilities</span><span class="o">.</span><span class="n">_EdgeListtoG</span><span class="p">(</span><span class="n">EdgeList</span><span class="p">)</span>
        <span class="n">Nodes</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">G</span><span class="p">:</span>
            <span class="n">TT</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="nb">len</span><span class="p">(</span><span class="n">G</span><span class="p">[</span><span class="n">n</span><span class="p">]))</span>
            <span class="n">TT</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
            <span class="n">Edges</span><span class="o">=</span><span class="p">[]</span>
            <span class="c1"># for e in G[n]:</span>
            <span class="c1">#     EE=[n,e]</span>
            <span class="c1">#     EE.sort()</span>
            <span class="c1">#     EE=tuple(EE)</span>
            <span class="c1">#     Edges.append(EE)</span>
            <span class="n">Nodes</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">TT</span><span class="p">,</span><span class="nb">tuple</span><span class="p">(</span><span class="n">G</span><span class="p">[</span><span class="n">n</span><span class="p">])))</span>

        <span class="c1"># REL,SetixTotal,SetixMax=tensor_network_contraction.ATR(ELin,EP,verbose=ATRverbose)</span>
        <span class="n">t</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">EC</span><span class="p">,</span><span class="n">CalculationEffort</span><span class="o">=</span><span class="n">tensor_network_contraction</span><span class="o">.</span><span class="n">Main</span><span class="p">(</span><span class="n">Nodes</span><span class="p">,</span><span class="n">EdgeList</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="n">ECverbose</span><span class="p">)</span>
        <span class="c1"># print(EC)</span>

    <span class="n">ECtime</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t</span>
    <span class="n">Result</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>
    <span class="n">Result</span><span class="p">[</span><span class="s1">&#39;EC&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">EC</span>
    <span class="n">Result</span><span class="p">[</span><span class="s1">&#39;CalculationEffort&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">CalculationEffort</span>
    <span class="n">Result</span><span class="p">[</span><span class="s1">&#39;ECtime&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">ECtime</span>
    <span class="n">Result</span><span class="p">[</span><span class="s1">&#39;LineGraphWidth&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">LineGraphWidth</span>
    <span class="k">return</span> <span class="n">Result</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="c1"># example for the graph K4,</span>
    <span class="c1"># each edge probability of existing=0.5</span>
    <span class="n">EdgeList</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">EdgeList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">.5</span><span class="p">))</span>
    <span class="n">EdgeList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mf">.5</span><span class="p">))</span>
    <span class="n">EdgeList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">.5</span><span class="p">))</span>
    <span class="n">EdgeList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mf">.5</span><span class="p">))</span>
    <span class="n">EdgeList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">.5</span><span class="p">))</span>
    <span class="n">EdgeList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">.5</span><span class="p">))</span>

    <span class="c1">############ Complete Graph Test</span>
    <span class="c1"># n=5</span>
    <span class="c1"># EdgeList=[]</span>
    <span class="c1"># for k1 in range(0,n-1):</span>
    <span class="c1">#     for k2 in range(k1+1,n):</span>
    <span class="c1">#         EdgeList.append((k1,k2,.5))</span>
    <span class="c1"># ATR(EdgeList,ATRverbose=True)</span>
    <span class="c1">############ Complete Graph Test END</span>

    <span class="c1">############ Grid Graph Test</span>
    <span class="n">n</span><span class="o">=</span><span class="mi">21</span>
    <span class="n">EdgeList</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">k1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">k2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">EdgeList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">n</span><span class="o">*</span><span class="n">k1</span><span class="o">+</span><span class="n">k2</span><span class="p">,</span><span class="n">n</span><span class="o">*</span><span class="n">k1</span><span class="o">+</span><span class="n">k2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mf">.5</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">k1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">k2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
            <span class="n">EdgeList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">n</span><span class="o">*</span><span class="n">k1</span><span class="o">+</span><span class="n">k2</span><span class="p">,</span><span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="n">k1</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">k2</span><span class="p">,</span><span class="mf">.5</span><span class="p">))</span>

    <span class="c1"># EdgeList=numpy.array(EdgeList)</span>
    <span class="c1"># ix=numpy.argsort(EdgeList[:,0])</span>
    <span class="c1"># EdgeList=EdgeList[ix,:]</span>
    <span class="n">EdgeList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="n">EC</span><span class="o">=</span><span class="n">EdgeCover</span><span class="p">(</span><span class="n">EdgeList</span><span class="p">,</span><span class="n">TreeWidthCalcTime</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">EC</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
    <span class="c1"># ATR(EdgeList,ATRverbose=True,TreeWidthCalcTime=0)</span>
    <span class="c1">############ Grid Graph Test END</span>

    <span class="c1">############ Random Cubic Graph Test</span>
    <span class="n">n</span><span class="o">=</span><span class="mi">60</span>
    <span class="n">seed</span><span class="o">=</span><span class="mi">1</span>
    <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">EdgeList</span><span class="o">=</span><span class="n">cubic_graph_utilities</span><span class="o">.</span><span class="n">ConnectedRandomCubic</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">EP</span><span class="o">=</span><span class="mf">.5</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">EdgeList</span><span class="p">)</span>
    <span class="n">EC</span><span class="o">=</span><span class="n">EdgeCover</span><span class="p">(</span><span class="n">EdgeList</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
    <span class="n">Gline</span><span class="o">=</span><span class="n">general_utilities</span><span class="o">.</span><span class="n">_EdgeListtoLine</span><span class="p">(</span><span class="n">EdgeList</span><span class="p">)</span>
    <span class="n">G</span><span class="p">,</span><span class="n">ixTdict</span><span class="p">,</span><span class="n">dictTix</span><span class="o">=</span><span class="n">general_utilities</span><span class="o">.</span><span class="n">_DictToix</span><span class="p">(</span><span class="n">Gline</span><span class="p">)</span>
    <span class="n">EdgeListLine</span><span class="o">=</span><span class="n">general_utilities</span><span class="o">.</span><span class="n">_ixDictToEdgeList</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">Gline</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">EdgeListLine</span><span class="p">)</span>
    <span class="nb">input</span><span class="p">()</span>

    <span class="n">REL</span><span class="o">=</span><span class="n">ATR</span><span class="p">(</span><span class="n">EdgeList</span><span class="p">,</span><span class="n">ATRverbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">REL</span><span class="p">)</span>

    <span class="n">EdgeList</span><span class="o">=</span><span class="n">cubic_graph_utilities</span><span class="o">.</span><span class="n">ConnectedRandomCubic</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">EP</span><span class="o">=</span><span class="mf">.5</span><span class="p">)</span>
    <span class="n">REL</span><span class="o">=</span><span class="n">ATR</span><span class="p">(</span><span class="n">EdgeList</span><span class="p">,</span><span class="n">ATRverbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">REL</span><span class="p">)</span>
    <span class="c1">############ Random Cubic Graph End</span>
</pre></div>

        </details>

            <div class="docstring"><p>This module calculates the reliability of undirected graphs.
Using tree decomposition algorithms, these functions optimize the edge factor ordering before the reliability calculations are performed.</p>

<h6 id="functions">Functions</h6>

<p><strong>ATR(EdgeList,ATRverbose=False,TreeWidthCalcTime=6) :</strong>
    Calculates the All Terminal Reliability of a undirected graph defined by EdgeList.</p>

<p><strong>EdgeCover(EdgeList,ECverbose=False,TreeWidthCalcTime=6) :</strong>
    Calculates the Edge Cover of a undirected graph defined by EdgeList.</p>

<h6 id="notes">Notes</h6>

<p>When the reliability calculation is first executed, numba performs jit compilation. This causes the first execution to take several seconds to run, but the compilation is cached and future runs with different inputs do not need to recompile.</p>

<p>The tree decomposition algorithms are written for UNIX operating environments, so windows environments must have the ability to run "wsl.exe" to properly execute these code packages.</p>

<p>Currently just for All Terminal Reliability. K-Terminal Reliability can be implemented in the future.</p>

<h6 id="examples">Examples</h6>

<div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">reliability</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="o">=</span><span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EdgeList</span><span class="o">=</span><span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">k1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">for</span> <span class="n">k2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k1</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">EdgeList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">k1</span><span class="p">,</span><span class="n">k2</span><span class="p">))</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">EdgeList</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">EdgeList</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EP</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">EdgeList</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mf">.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">REL</span><span class="p">,</span><span class="n">SetixTotal</span><span class="p">,</span><span class="n">SetixMax</span><span class="o">=</span><span class="n">reliability</span><span class="o">.</span><span class="n">ATR</span><span class="p">(</span><span class="n">EdgeList</span><span class="p">,</span><span class="n">EP</span><span class="p">)</span>
</code></pre></div>
</div>


                </section>
                <section id="script">
                                <div class="attr module"><a class="headerlink" href="#script">#&nbsp;&nbsp</a>
<span class="name"><a href="ICOSSAR_2021/script.html">ICOSSAR_2021.script</a></span></div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">This script executes all the code needed to generate the figures and tables in &quot;Tensor Network Contraction For Network Reliability Estimates&quot;</span>

<span class="sd">Analysis and computation is performed by calling functions from ICOSSAR_2021_analysis.</span>

<span class="sd">The plots are generated by calling functions from generate_figures</span>

<span class="sd">Notes</span>
<span class="sd">-----</span>
<span class="sd">This script takes ~24 hours to run.</span>

<span class="sd">When some of these functions are first executed, numba performs jit compilation. This causes the first execution of that function to take several seconds to run, but the compilation is cached and future runs with different inputs do not need to recompile.</span>

<span class="sd">Examples</span>
<span class="sd">--------</span>
<span class="sd">&gt;&gt;&gt; python script.py</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="c1"># ensures local modules are imported properly</span>
<span class="n">cwd</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">cwd</span><span class="p">)</span>
<span class="c1"># must use ubuntu 18.04, for p17 to compile and work correctly</span>
<span class="c1"># sudo apt-get install make</span>
<span class="c1"># sudo apt-get install autotools-dev</span>
<span class="c1"># sudo apt-get install automake</span>
<span class="c1"># sudo apt-get install libtool</span>
<span class="c1">## sudo apt-get install libtool-bin</span>
<span class="c1"># sudo apt-get install libboost-all-dev</span>
<span class="c1"># sudo apt install g++</span>
<span class="c1"># sudo apt install stx-btree-dev</span>
<span class="c1"># https://ubuntu.pkgs.org/18.04/ubuntu-universe-amd64/stx-btree-dev_0.9-2build2_all.deb.html</span>
<span class="c1"># make --always-make</span>

<span class="c1"># GridGraphComputeTime8</span>
<span class="c1"># RcubicWidth_short</span>
<span class="c1"># misplaced \noalign</span>

<span class="kn">import</span> <span class="nn">ICOSSAR_2021_analysis</span>
<span class="kn">import</span> <span class="nn">generate_figures</span>
<span class="kn">import</span> <span class="nn">cubic_graph_utilities</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="c1">### create figure showing #MonteCarloTrials ~ 1/p</span>
    <span class="c1"># ICOSSAR_2021_analysis.MCtrials_vs_e()</span>
    <span class="n">generate_figures</span><span class="o">.</span><span class="n">MCtrials_vs_e_Figure</span><span class="p">()</span>

    <span class="c1">### create figure showing the tensor contraction process</span>
    <span class="n">generate_figures</span><span class="o">.</span><span class="n">TensorGraphFigure</span><span class="p">()</span>

    <span class="c1">### perform analysis on the grid graphs</span>
    <span class="c1"># ICOSSAR_2021_analysis.GridRel_vs_n()</span>
    <span class="c1"># ICOSSAR_2021_analysis.GridRel_vs_n_MCtrials()</span>
    <span class="c1"># ICOSSAR_2021_analysis.GridRel_vs_len()</span>
    <span class="c1"># ICOSSAR_2021_analysis.GridRel_vs_len_MCtrials()</span>
    <span class="n">generate_figures</span><span class="o">.</span><span class="n">GridGraphComplexityFigure</span><span class="p">()</span>

    <span class="c1">### generate list of random connected cubic graphs</span>
    <span class="c1"># Create list of large cubic graphs for treewidth analysis</span>
    <span class="c1"># cubic_graph_utilities.GenConnectedRandomCubic(ID0=0,ID1=10000,Vmin=20,Vmax=400,seed=42)</span>
    <span class="c1"># measure the treewidths of these graphs</span>
    <span class="n">filename1</span><span class="o">=</span><span class="s2">&quot;data/ConnectedRandomCubic-0-10000-Vmin-20-Vmax-400-seed-42&quot;</span>
    <span class="c1"># ICOSSAR_2021_analysis.CubicGraphTreeWidths(filename1)</span>

    <span class="c1"># Create list of smaller cubic graphs for reliability and</span>
    <span class="c1"># edge cover analysis</span>
    <span class="c1"># cubic_graph_utilities.GenConnectedRandomCubic(ID0=0,ID1=10000,Vmin=20,Vmax=50,seed=64)</span>

    <span class="c1">### perform analysis on the cubic graphs</span>
    <span class="n">filename2</span><span class="o">=</span><span class="s2">&quot;data/ConnectedRandomCubic-0-10000-Vmin-20-Vmax-50-seed-64&quot;</span>
    <span class="c1"># get cubic graph reliability, set edge reliability to .99</span>
    <span class="c1"># ICOSSAR_2021_analysis.RandomCubicRel(filename2,edge_reliability=.99)</span>
    <span class="c1"># ICOSSAR_2021_analysis.RandomCubicRel_MCtrials(filename2)</span>
    <span class="n">generate_figures</span><span class="o">.</span><span class="n">RandomCubicWidthFigure_short</span><span class="p">()</span>
    <span class="n">generate_figures</span><span class="o">.</span><span class="n">RandomCubicMonteCarlo</span><span class="p">()</span>

    <span class="c1">### perform analysis on the power grids</span>
    <span class="c1"># ICOSSAR_2021_analysis.PowerGridsREL()</span>
    <span class="c1"># ICOSSAR_2021_analysis.PowerGridsREL_MCtrials()</span>
    <span class="n">generate_figures</span><span class="o">.</span><span class="n">TreewidthCompare</span><span class="p">()</span>
    <span class="n">generate_figures</span><span class="o">.</span><span class="n">PowerGridMonteCarlo</span><span class="p">()</span>
    <span class="n">generate_figures</span><span class="o">.</span><span class="n">PowerGridTable</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>This script executes all the code needed to generate the figures and tables in "Tensor Network Contraction For Network Reliability Estimates"</p>

<p>Analysis and computation is performed by calling functions from ICOSSAR_2021_analysis.</p>

<p>The plots are generated by calling functions from generate_figures</p>

<h6 id="notes">Notes</h6>

<p>This script takes ~24 hours to run.</p>

<p>When some of these functions are first executed, numba performs jit compilation. This causes the first execution of that function to take several seconds to run, but the compilation is cached and future runs with different inputs do not need to recompile.</p>

<h6 id="examples">Examples</h6>

<div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">python</span> <span class="n">script</span><span class="o">.</span><span class="n">py</span>
</code></pre></div>
</div>


                </section>
                <section id="setup">
                                <div class="attr module"><a class="headerlink" href="#setup">#&nbsp;&nbsp</a>
<span class="name"><a href="ICOSSAR_2021/setup.html">ICOSSAR_2021.setup</a></span></div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">setuptools</span>
<span class="kn">from</span> <span class="nn">setuptools</span> <span class="kn">import</span> <span class="n">setup</span><span class="p">,</span> <span class="n">find_packages</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="c1"># date=datetime.date.today().timetuple()</span>
<span class="c1"># version=&#39;1.&#39;+str(date.tm_year-2019).zfill(2)+&#39;.&#39;+str(date.tm_yday).zfill(3)</span>
<span class="c1"># pip install wheel</span>
<span class="c1"># pip install pipreqs</span>
<span class="c1"># pip install pdoc</span>
<span class="c1"># git init</span>

<span class="n">PackageName</span><span class="o">=</span><span class="s1">&#39;ICOSSAR_2021&#39;</span>
<span class="n">pipignore</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;p17&#39;</span><span class="p">]</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="c1"># if the command &quot;python setup.py bdist_wheel&quot; is run,</span>
    <span class="c1"># to generate the distribution wheel</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
        <span class="n">date</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">timetuple</span><span class="p">()</span>
        <span class="n">version</span><span class="o">=</span><span class="s1">&#39;1.&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">tm_year</span><span class="o">-</span><span class="mi">2019</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">tm_yday</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;wsl.exe rm -vrf ./build ./dist ./*.pyc ./*.tgz ./*.egg-info&#39;</span><span class="p">)</span>
        <span class="n">command</span><span class="o">=</span><span class="s1">&#39;pipreqs --force ../&#39;</span><span class="o">+</span><span class="n">PackageName</span>
        <span class="k">for</span> <span class="n">ign</span> <span class="ow">in</span> <span class="n">pipignore</span><span class="p">:</span>
            <span class="n">command</span><span class="o">=</span><span class="n">command</span><span class="o">+</span><span class="s1">&#39; --ignore &#39;</span><span class="o">+</span><span class="n">ign</span>
        <span class="n">ErrorCode</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ErrorCode</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
        <span class="c1"># open the requirements file, replacing version equality signs</span>
        <span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;requirements.txt&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">requirements</span><span class="o">=</span><span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">requirements</span><span class="p">)):</span>
            <span class="n">requirements</span><span class="p">[</span><span class="n">r</span><span class="p">]</span><span class="o">=</span><span class="n">requirements</span><span class="p">[</span><span class="n">r</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;==&#39;</span><span class="p">,</span><span class="s1">&#39;&gt;=&#39;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">packages</span><span class="o">=</span><span class="n">find_packages</span><span class="p">()</span>
        <span class="n">packages</span><span class="o">=</span><span class="p">[</span><span class="n">PackageName</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">packages</span><span class="p">]</span>
        <span class="n">setup</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">PackageName</span><span class="p">,</span>
              <span class="n">version</span><span class="o">=</span><span class="n">version</span><span class="p">,</span>
              <span class="n">description</span><span class="o">=</span><span class="s1">&#39;CodeBase for ICOSSAR_2021&#39;</span><span class="p">,</span>
              <span class="n">url</span><span class="o">=</span><span class="s1">&#39;https://duenas-osorio.rice.edu/sisrra&#39;</span><span class="p">,</span>
              <span class="n">author</span><span class="o">=</span><span class="s1">&#39;Kyle Shepherd&#39;</span><span class="p">,</span>
              <span class="n">author_email</span><span class="o">=</span><span class="s1">&#39;kas20@rice.com&#39;</span><span class="p">,</span>
              <span class="n">license</span><span class="o">=</span><span class="s1">&#39;GNU&#39;</span><span class="p">,</span>
              <span class="n">package_dir</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="s1">&#39;..&#39;</span><span class="p">},</span>
              <span class="n">packages</span><span class="o">=</span><span class="n">packages</span><span class="p">,</span>
              <span class="n">install_requires</span><span class="o">=</span><span class="n">requirements</span><span class="p">,</span>
              <span class="n">zip_safe</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;pip install --no-deps --force-reinstall ./dist/&#39;</span><span class="o">+</span><span class="n">PackageName</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="n">version</span><span class="o">+</span><span class="s1">&#39;-py3-none-any.whl&#39;</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;wsl.exe rm -vrf ./build ./*.pyc ./*.tgz ./*.egg-info&#39;</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">)</span>
        <span class="c1"># result=os.system(&#39;pdoc --html --force &#39;+str(PackageName)+&#39; --output-dir &#39;+str(PackageName)+&#39;/documentation&#39;)</span>
        <span class="n">result</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;pdoc --docformat numpy -o ./&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">PackageName</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;/documentation ./&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">PackageName</span><span class="p">))</span>
        <span class="c1"># os.chdir(PackageName)</span>
        <span class="k">if</span> <span class="n">result</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s1">&#39;Documentation ERROR&#39;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">PackageName</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;/commit_message&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">text</span><span class="o">=</span><span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">text</span><span class="o">!=</span><span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;git add ./&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">PackageName</span><span class="p">))</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;git commit -m &quot;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">text</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;git push -u https://github.com/KyleAnthonyShepherd/SISRRA_tensor_contraction.git main&#39;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;commit_message&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">wheel</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">&#39;dist&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;pip install --no-deps --force-reinstall ./dist/&#39;</span><span class="o">+</span><span class="n">wheel</span><span class="p">)</span>
        <span class="c1"># pack=sys.argv[2]</span>
        <span class="c1"># sys.argv.remove(pack)</span>
        <span class="c1"># file=open(str(pack)+&#39;/requirements.txt&#39;,&#39;r&#39;)</span>
        <span class="c1"># requirements=file.readlines()</span>
        <span class="c1"># for r in range(0,len(requirements)):</span>
        <span class="c1">#     requirements[r]=requirements[r][:-1].replace(&#39;==&#39;,&#39;&gt;=&#39;)</span>
        <span class="c1"># file.close()</span>
        <span class="c1"># # print(pack)</span>
        <span class="c1"># packages=find_packages(pack)</span>
        <span class="c1"># packages=[pack+&#39;.&#39;+p for p in packages]</span>
        <span class="c1"># # print(packages)</span>
        <span class="c1"># # input()</span>
        <span class="c1"># setup(name=pack,</span>
        <span class="c1">#       version=version,</span>
        <span class="c1">#       description=&#39;CodeBase for HARVEY analysis&#39;,</span>
        <span class="c1">#       url=&#39;KyleAnthonyShepherd.com&#39;,</span>
        <span class="c1">#       author=&#39;Kyle Shepherd&#39;,</span>
        <span class="c1">#       author_email=&#39;KyleAnthonyShepherd@example.com&#39;,</span>
        <span class="c1">#       license=&#39;GNU&#39;,</span>
        <span class="c1">#       packages=packages,</span>
        <span class="c1">#       # packages=[&#39;HARVEY&#39;],</span>
        <span class="c1">#       install_requires=requirements,</span>
        <span class="c1">#       zip_safe=False</span>
        <span class="c1">#     )</span>
        <span class="c1"># os.system(&#39;pip install --no-deps --force-reinstall ./dist/&#39;+pack+&#39;-&#39;+version+&#39;-py3-none-any.whl&#39;)</span>
        <span class="c1"># os.system(&#39;rm -vrf ./build ./*.pyc ./*.tgz ./*.egg-info&#39;)</span>
        <span class="c1"># result=os.system(&#39;pdoc --html --force &#39;+str(pack)+&#39; --output-dir HARVEY/results&#39;)</span>
        <span class="c1"># if result==1:</span>
        <span class="c1">#     sys.exit(&#39;Documentation ERROR&#39;)</span>
</pre></div>

        </details>

    

                </section>
                <section id="tensor_network_contraction">
                                <div class="attr module"><a class="headerlink" href="#tensor_network_contraction">#&nbsp;&nbsp</a>
<span class="name"><a href="ICOSSAR_2021/tensor_network_contraction.html">ICOSSAR_2021.tensor_network_contraction</a></span></div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">This module contains functions to perform miscellaneous tasks on cubic graphs. Mostly for generating uniform connected random cubic graphs.</span>

<span class="sd">Functions</span>
<span class="sd">---------</span>
<span class="sd">**Main(Nodes,EdgeOrder,pf=.5,verbose=True) :**  </span>
<span class="sd">    Main function called by user to calculate the tensor network contraction defined by the list of Nodes (tensors and their indices).</span>

<span class="sd">**CoreLoop(T1,T1ix,T2,T2ix,Toutix) :**  </span>
<span class="sd">    Performs the tensor contraction.</span>

<span class="sd">**CoreLoopScalar(T1,T1ix,T2,T2ix) :**  </span>
<span class="sd">    Performs the final tensor contraction down to a scalar.</span>

<span class="sd">Notes</span>
<span class="sd">-----</span>
<span class="sd">When the tensor network contraction is first executed, numba performs jit compilation. This causes the first execution to take several seconds to run, but the compilation is cached and future runs with different inputs do not need to recompile.</span>

<span class="sd">While the tensor network contraction for Source-Terminal reliability is discussed in the ICOSSAR 2021 paper and has an exact solution for directed acyclic networks, it is not implemented in this module.</span>
<span class="sd">Proof-of-concept code has been written to verify the S-T tensor construction.</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">time</span>

<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span>

<span class="c1"># each node defined by a tuple</span>
<span class="c1"># (Tensor, edges)</span>
<span class="c1"># Nodes is list of these tuples</span>
<span class="c1"># EdgeOrder is list of tuples (e1,e2)</span>

<span class="c1"># Sizeix=10</span>
<span class="c1"># BitArray=numpy.zeros(Sizeix,dtype=numpy.int8)</span>
<span class="c1"># for k in range(0,2**Sizeix):</span>
<span class="c1">#     for b in range(0,Sizeix):</span>
<span class="c1">#         BitArray[b]=bool((1&lt;&lt;b)&amp;k)</span>
<span class="c1">#     print(BitArray)</span>
<span class="c1">#     input()</span>
<span class="c1"># sys.exit()</span>

<span class="nd">@jit</span><span class="p">(</span><span class="n">nopython</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">cache</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">CoreLoop</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span><span class="n">T1ix</span><span class="p">,</span><span class="n">T2</span><span class="p">,</span><span class="n">T2ix</span><span class="p">,</span><span class="n">Toutix</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This function performs the tensor product to contract, merge, two tensors.</span>
<span class="sd">    Numba complied for extra speed, much better at for loops then plain python or numpy.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    T1 : 1D numpy array of 2^(T1ix.shape), float</span>
<span class="sd">        Multi dimensional tensor flattened to a vector.</span>

<span class="sd">    T1ix : 1D numpy array of size n, int</span>
<span class="sd">        Tensor indices for T1. T1 is addressed by:</span>
<span class="sd">        f(T1ix[0])*2^0+f(T1ix[1])*2^1+f(T1ix[2])*2^2+...+f(T1ix[n-1])*2^(n-1)</span>
<span class="sd">        where f is some function that returns the value of index k.</span>

<span class="sd">    T2 : 1D numpy array of 2^(T2ix.shape), float</span>
<span class="sd">        Multi dimensional tensor flattened to a vector.</span>

<span class="sd">    T2ix : 1D numpy array of size n, int</span>
<span class="sd">        Tensor indices for T2. T2 is addressed by:</span>
<span class="sd">        f(T2ix[0])*2^0+f(T2ix[1])*2^1+f(T2ix[2])*2^2+...+f(T2ix[n-1])*2^(n-1)</span>
<span class="sd">        where f is some function that returns the value of index k.</span>

<span class="sd">    Toutix : 1D numpy array of size n, int</span>
<span class="sd">        Tensor indices for Tout</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Tout : 1D numpy array of 2^(Toutix.shape), float</span>
<span class="sd">        The result of the tensor product</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    When the reliability calculation is first executed, numba performs jit compilation. This causes the first execution to take several seconds to run, but the compilation is cached and future runs with different inputs do not need to recompile.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; T1=[1,2,3,4,5,6,7,8]</span>
<span class="sd">    &gt;&gt;&gt; T1ix=[0,1,2]</span>
<span class="sd">    &gt;&gt;&gt; T2=[1,2,4,8,16,32,64,128]</span>
<span class="sd">    &gt;&gt;&gt; T2ix=[2,3,4]</span>
<span class="sd">    &gt;&gt;&gt; Toutix=[0,1,3,4]</span>
<span class="sd">    &gt;&gt;&gt; Tout=CoreLoop(T1,T1ix,T2,T2ix,Toutix)</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># determine size of bit array to iterate through</span>
    <span class="n">Sizeix</span><span class="o">=</span><span class="nb">max</span><span class="p">((</span><span class="n">numpy</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">T1ix</span><span class="p">),</span><span class="n">numpy</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">T2ix</span><span class="p">)))</span><span class="o">+</span><span class="mi">1</span>

    <span class="c1"># get number of indices</span>
    <span class="n">T1s</span><span class="o">=</span><span class="n">T1ix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">T2s</span><span class="o">=</span><span class="n">T2ix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">Touts</span><span class="o">=</span><span class="n">Toutix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># allocate output tensor</span>
    <span class="n">Tout</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">Touts</span><span class="p">)</span>

    <span class="c1"># allocate bit array</span>
    <span class="c1"># is really an array for determining if index j is 1,</span>
    <span class="c1"># how much should the tensor vector index shift?</span>
    <span class="n">BitArray</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="n">Sizeix</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">zz</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">T1s</span><span class="p">):</span>
        <span class="n">BitArray</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">T1ix</span><span class="p">[</span><span class="n">zz</span><span class="p">]]</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">zz</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">zz</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">T2s</span><span class="p">):</span>
        <span class="n">BitArray</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">T2ix</span><span class="p">[</span><span class="n">zz</span><span class="p">]]</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">zz</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">zz</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Touts</span><span class="p">):</span>
        <span class="n">BitArray</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="n">Toutix</span><span class="p">[</span><span class="n">zz</span><span class="p">]]</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">zz</span><span class="p">)</span>

    <span class="c1"># loop over all permutations of the tensor indices</span>
    <span class="c1"># k is used as a bit mask</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">**</span><span class="n">Sizeix</span><span class="p">):</span>
        <span class="n">T1p</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">T2p</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">Toutp</span><span class="o">=</span><span class="mi">0</span>
        <span class="c1"># scan through the bit array,</span>
        <span class="c1"># applying the proper masking and index shifting</span>
        <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Sizeix</span><span class="p">):</span>
            <span class="n">TT</span><span class="o">=</span><span class="nb">bool</span><span class="p">((</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">b</span><span class="p">)</span><span class="o">&amp;</span><span class="n">k</span><span class="p">)</span>
            <span class="n">T1p</span><span class="o">=</span><span class="n">T1p</span><span class="o">+</span><span class="n">BitArray</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">b</span><span class="p">]</span><span class="o">*</span><span class="n">TT</span>
            <span class="n">T2p</span><span class="o">=</span><span class="n">T2p</span><span class="o">+</span><span class="n">BitArray</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">b</span><span class="p">]</span><span class="o">*</span><span class="n">TT</span>
            <span class="n">Toutp</span><span class="o">=</span><span class="n">Toutp</span><span class="o">+</span><span class="n">BitArray</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="n">b</span><span class="p">]</span><span class="o">*</span><span class="n">TT</span>

        <span class="c1"># perform the multiplication and addition to output tensor</span>
        <span class="n">Tout</span><span class="p">[</span><span class="n">Toutp</span><span class="p">]</span><span class="o">=</span><span class="n">Tout</span><span class="p">[</span><span class="n">Toutp</span><span class="p">]</span><span class="o">+</span><span class="n">T1</span><span class="p">[</span><span class="n">T1p</span><span class="p">]</span><span class="o">*</span><span class="n">T2</span><span class="p">[</span><span class="n">T2p</span><span class="p">]</span>


    <span class="k">return</span> <span class="n">Tout</span>

<span class="nd">@jit</span><span class="p">(</span><span class="n">nopython</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">cache</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">CoreLoopScalar</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span><span class="n">T1ix</span><span class="p">,</span><span class="n">T2</span><span class="p">,</span><span class="n">T2ix</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This function performs the tensor product to contract, merge, two tensors.</span>
<span class="sd">    Numba complied for extra speed, much better at for loops then plain python or numpy. This function is used when the output is a scalar, no tensor indices needed.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    T1 : 1D numpy array of 2^(T1ix.shape), float</span>
<span class="sd">        Multi dimensional tensor flattened to a vector.</span>

<span class="sd">    T1ix : 1D numpy array of size n, int</span>
<span class="sd">        Tensor indices for T1. T1 is addressed by:</span>
<span class="sd">        f(T1ix[0])*2^0+f(T1ix[1])*2^1+f(T1ix[2])*2^2+...+f(T1ix[n-1])*2^(n-1)</span>
<span class="sd">        where f is some function that returns the value of index k.</span>

<span class="sd">    T2 : 1D numpy array of 2^(T2ix.shape), float</span>
<span class="sd">        Multi dimensional tensor flattened to a vector.</span>

<span class="sd">    T2ix : 1D numpy array of size n, int</span>
<span class="sd">        Tensor indices for T2. T2 is addressed by:</span>
<span class="sd">        f(T2ix[0])*2^0+f(T2ix[1])*2^1+f(T2ix[2])*2^2+...+f(T2ix[n-1])*2^(n-1)</span>
<span class="sd">        where f is some function that returns the value of index k.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Tout : float</span>
<span class="sd">        The result of the tensor product</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    When the reliability calculation is first executed, numba performs jit compilation. This causes the first execution to take several seconds to run, but the compilation is cached and future runs with different inputs do not need to recompile.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; T1=[1,2,3,4,5,6,7,8]</span>
<span class="sd">    &gt;&gt;&gt; T1ix=[0,1,2]</span>
<span class="sd">    &gt;&gt;&gt; T2=[1,2,4,8,16,32,64,128]</span>
<span class="sd">    &gt;&gt;&gt; T2ix=[0,1,2]</span>
<span class="sd">    &gt;&gt;&gt; Tout=CoreLoopScalar(T1,T1ix,T2,T2ix)</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># determine size of bit array to iterate through</span>
    <span class="n">Sizeix</span><span class="o">=</span><span class="nb">max</span><span class="p">((</span><span class="n">numpy</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">T1ix</span><span class="p">),</span><span class="n">numpy</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">T2ix</span><span class="p">)))</span><span class="o">+</span><span class="mi">1</span>

    <span class="c1"># get number of indices</span>
    <span class="n">T1s</span><span class="o">=</span><span class="n">T1ix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">T2s</span><span class="o">=</span><span class="n">T2ix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># allocate output scalar</span>
    <span class="n">Tout</span><span class="o">=</span><span class="mi">0</span>

    <span class="c1"># allocate bit array</span>
    <span class="c1"># is really an array for determining if index j is 1,</span>
    <span class="c1"># how much should the tensor vector index shift?</span>
    <span class="n">BitArray</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="n">Sizeix</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">zz</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">T1s</span><span class="p">):</span>
        <span class="n">BitArray</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">T1ix</span><span class="p">[</span><span class="n">zz</span><span class="p">]]</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">zz</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">zz</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">T2s</span><span class="p">):</span>
        <span class="n">BitArray</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">T2ix</span><span class="p">[</span><span class="n">zz</span><span class="p">]]</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">zz</span><span class="p">)</span>

    <span class="c1"># loop over all permutations of the tensor indices</span>
    <span class="c1"># k is used as a bit mask</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">**</span><span class="n">Sizeix</span><span class="p">):</span>
        <span class="n">T1p</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">T2p</span><span class="o">=</span><span class="mi">0</span>
        <span class="c1"># scan through the bit array,</span>
        <span class="c1"># applying the proper masking and index shifting</span>
        <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Sizeix</span><span class="p">):</span>
            <span class="n">TT</span><span class="o">=</span><span class="nb">bool</span><span class="p">((</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">b</span><span class="p">)</span><span class="o">&amp;</span><span class="n">k</span><span class="p">)</span>
            <span class="n">T1p</span><span class="o">=</span><span class="n">T1p</span><span class="o">+</span><span class="n">BitArray</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">b</span><span class="p">]</span><span class="o">*</span><span class="n">TT</span>
            <span class="n">T2p</span><span class="o">=</span><span class="n">T2p</span><span class="o">+</span><span class="n">BitArray</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">b</span><span class="p">]</span><span class="o">*</span><span class="n">TT</span>

        <span class="c1"># perform the multiplication and addition to output scalar</span>
        <span class="n">Tout</span><span class="o">=</span><span class="n">Tout</span><span class="o">+</span><span class="n">T1</span><span class="p">[</span><span class="n">T1p</span><span class="p">]</span><span class="o">*</span><span class="n">T2</span><span class="p">[</span><span class="n">T2p</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">Tout</span>

<span class="nd">@jit</span><span class="p">(</span><span class="n">nopython</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">cache</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">EdgeWeight</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span><span class="n">pf</span><span class="p">,</span><span class="n">Eix</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This function contracts tensor T1 with a variable constraint tensor.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    T1 : 1D numpy array of 2^(T1ix.shape), float</span>
<span class="sd">        Multi dimensional tensor flattened to a vector.</span>

<span class="sd">    pf : float</span>
<span class="sd">        probability of the edge failing, edge unreliability</span>

<span class="sd">    Eix : int</span>
<span class="sd">        Tensor index being contracted with the variable constraint tensor.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Tout : float</span>
<span class="sd">        The result of the tensor product with the variable constraint tensor.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    When the reliability calculation is first executed, numba performs jit compilation. This causes the first execution to take several seconds to run, but the compilation is cached and future runs with different inputs do not need to recompile.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; T1=[1,2,3,4,5,6,7,8]</span>
<span class="sd">    &gt;&gt;&gt; pf=0.75</span>
<span class="sd">    &gt;&gt;&gt; Eix=2</span>
<span class="sd">    &gt;&gt;&gt; Tout=EdgeWeight(T1,pf,Eix)</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="c1"># allocate output tensor</span>
    <span class="n">Tout</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1"># loop over all permutations of the tensor indices</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">T1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>

        <span class="n">TT</span><span class="o">=</span><span class="nb">bool</span><span class="p">((</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">Eix</span><span class="p">)</span><span class="o">&amp;</span><span class="n">k</span><span class="p">)</span>
        <span class="c1"># when index Eix is 1, multiply by chance of edge not failing,</span>
        <span class="c1"># edge reliability</span>
        <span class="c1"># when index Eix is 0, multiply by chance of edge failing.</span>
        <span class="n">Tout</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="n">T1</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">TT</span><span class="o">-</span><span class="n">pf</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Tout</span>


<span class="k">def</span> <span class="nf">Main</span><span class="p">(</span><span class="n">Nodes</span><span class="p">,</span><span class="n">EdgeOrder</span><span class="p">,</span><span class="n">pf</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This main function performs the tensor network contraction.</span>
<span class="sd">    This outer loop is done in python, for ease of string, dictionary, list, and other mutable manipulation.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Nodes : list of tuples, (1D numpy array, (tuple of indices))</span>
<span class="sd">        Each node is a tensor in the tensor network. Nodes[i][0] defines the ith tensor, and Nodes[i][1] defines the indices of this tensor. Each index aligns with an edge, a properly specified tensor network will have just two occurrences of an index.</span>

<span class="sd">    EdgeOrder : list of tuples, int</span>
<span class="sd">        A list of the edges in the order they should be contracted.</span>

<span class="sd">    pf : float</span>
<span class="sd">        A uniform edge probability. If len(EdgeOrder[i])=3, then the edge specifies its probability of existing, its reliability, and will override this global value.</span>

<span class="sd">    verbose : bool</span>
<span class="sd">        boolean to control how much text is displayed to the console</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Tout : float</span>
<span class="sd">        The result of the tensor network contraction</span>

<span class="sd">    CalculationEffort : int</span>
<span class="sd">        The number of floating point operations used to perform the entire calculation.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    When the reliability calculation is first executed, numba performs jit compilation. This causes the first execution to take several seconds to run, but the compilation is cached and future runs with different inputs do not need to recompile.</span>

<span class="sd">    Currently the code assumes the edge cover problem, and adds in the variable constraint tensors as needed. This code could be modified to be more general purpose.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; T=[]</span>
<span class="sd">    &gt;&gt;&gt; for k in range(2,5):</span>
<span class="sd">    &gt;&gt;&gt;     TT=numpy.ones(2**k)</span>
<span class="sd">    &gt;&gt;&gt;     TT[0]=0</span>
<span class="sd">    &gt;&gt;&gt;     T.append(TT)</span>

<span class="sd">    &gt;&gt;&gt; Nodes=[]</span>
<span class="sd">    &gt;&gt;&gt; Nodes.append((T[0],(1,3)))</span>
<span class="sd">    &gt;&gt;&gt; Nodes.append((T[1],(1,4,2)))</span>
<span class="sd">    &gt;&gt;&gt; Nodes.append((T[0],(2,5)))</span>
<span class="sd">    &gt;&gt;&gt; Nodes.append((T[1],(3,6,8)))</span>
<span class="sd">    &gt;&gt;&gt; Nodes.append((T[2],(4,6,7,9)))</span>
<span class="sd">    &gt;&gt;&gt; Nodes.append((T[1],(5,7,10)))</span>
<span class="sd">    &gt;&gt;&gt; Nodes.append((T[0],(8,11)))</span>
<span class="sd">    &gt;&gt;&gt; Nodes.append((T[1],(11,9,12)))</span>
<span class="sd">    &gt;&gt;&gt; Nodes.append((T[0],(12,10)))</span>
<span class="sd">    &gt;&gt;&gt; EdgeOrder=list(range(1,13))</span>

<span class="sd">    &gt;&gt;&gt; Tout,CalculationEffort = Main(Nodes,EdgeOrder,pf=.9)</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># initialize variables</span>
    <span class="n">Tout</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">CalculationEffort</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">EdgeToNode</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>
    <span class="n">NodeToEdge</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>
    <span class="n">NodeToEdgeix</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">Nodes</span><span class="p">)</span>

    <span class="c1"># given an edge, determine the nodes it is connected too</span>
    <span class="k">for</span> <span class="n">loc</span><span class="p">,</span><span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Nodes</span><span class="p">):</span>

        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">n</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">e</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">EdgeToNode</span><span class="p">:</span>
                <span class="n">EdgeToNode</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">=</span><span class="p">[]</span>
            <span class="n">EdgeToNode</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>

    <span class="c1"># loop over each edge</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">EdgeOrder</span><span class="p">)):</span>
        <span class="n">ee</span><span class="o">=</span><span class="n">EdgeOrder</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">ee</span><span class="p">)</span>

        <span class="n">Cnodes</span><span class="o">=</span><span class="p">[]</span>
        <span class="c1"># determine the tensors connected to the edge</span>
        <span class="n">Cnodes</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">EdgeToNode</span><span class="p">[</span><span class="n">ee</span><span class="p">])</span>

        <span class="c1"># if no connected tensors, that means the edge was already contracted</span>
        <span class="c1"># in a parallel process</span>
        <span class="k">if</span> <span class="n">Cnodes</span><span class="o">==</span><span class="p">[]:</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Edge Already Contracted&#39;</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="c1"># if the two connected tensors are the same, the edge is a loop</span>
        <span class="k">if</span> <span class="n">Cnodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">Cnodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">NN</span><span class="o">=</span><span class="n">Cnodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">Cnodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">Nodes</span><span class="p">[</span><span class="n">NN</span><span class="p">]</span>
            <span class="n">Cnodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">Nodes</span><span class="p">[</span><span class="n">NN</span><span class="p">]</span>

            <span class="n">Nodes</span><span class="p">[</span><span class="n">NN</span><span class="p">]</span><span class="o">=</span><span class="p">[]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># load tensor into local memory</span>
            <span class="n">NN</span><span class="o">=</span><span class="n">Cnodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">Cnodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">Nodes</span><span class="p">[</span><span class="n">NN</span><span class="p">]</span>
            <span class="n">Nodes</span><span class="p">[</span><span class="n">NN</span><span class="p">]</span><span class="o">=</span><span class="p">[]</span>

            <span class="n">NN</span><span class="o">=</span><span class="n">Cnodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">Cnodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">Nodes</span><span class="p">[</span><span class="n">NN</span><span class="p">]</span>
            <span class="n">Nodes</span><span class="p">[</span><span class="n">NN</span><span class="p">]</span><span class="o">=</span><span class="p">[]</span>

        <span class="c1"># determine the indices that will be contracted</span>
        <span class="n">Cedges</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">Cnodes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">Cnodes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])))</span>

        <span class="c1"># pf=.01</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ee</span><span class="p">)</span><span class="o">==</span><span class="mi">3</span><span class="p">:</span>
            <span class="c1"># override global pf if the edge specifies the edge reliability</span>
            <span class="n">pf</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">ee</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="c1"># for every index about to be contracted</span>
        <span class="c1"># make sure to merge in the degree 2 variable constraint tensors for</span>
        <span class="c1"># the edge cover problem</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">Cedges</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Cnodes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&lt;</span><span class="n">Cnodes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">Eix</span><span class="o">=</span><span class="n">Cnodes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                <span class="n">Cnodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">EdgeWeight</span><span class="p">(</span><span class="n">Cnodes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">pf</span><span class="p">,</span><span class="n">Eix</span><span class="p">),</span><span class="n">Cnodes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">Eix</span><span class="o">=</span><span class="n">Cnodes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                <span class="n">Cnodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">EdgeWeight</span><span class="p">(</span><span class="n">Cnodes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">pf</span><span class="p">,</span><span class="n">Eix</span><span class="p">),</span><span class="n">Cnodes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># get list of all participating indicies in the contraction</span>
        <span class="n">Tix</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">Tix</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">Cnodes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">Cnodes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]))))</span>

        <span class="c1"># reindex edges from 0 to n</span>
        <span class="n">NodeTix</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>
        <span class="n">ixTnode</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>
        <span class="n">zz</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="n">Tix</span><span class="p">:</span>
            <span class="n">NodeTix</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">=</span><span class="n">zz</span>
            <span class="n">ixTnode</span><span class="p">[</span><span class="n">zz</span><span class="p">]</span><span class="o">=</span><span class="n">ix</span>
            <span class="n">zz</span><span class="o">=</span><span class="n">zz</span><span class="o">+</span><span class="mi">1</span>

        <span class="n">T1ix</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="n">Cnodes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">T1ix</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">NodeTix</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span>
        <span class="n">T1ix</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">T1ix</span><span class="p">)</span>

        <span class="n">T2ix</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="n">Cnodes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">T2ix</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">NodeTix</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span>
        <span class="n">T2ix</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">T2ix</span><span class="p">)</span>

        <span class="c1"># find indices participating but not being contracted.</span>
        <span class="n">Toutix</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">T1ix</span><span class="p">)</span><span class="o">.</span><span class="n">symmetric_difference</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">T2ix</span><span class="p">)))</span>

        <span class="c1"># remove the tensors from being considered in the future</span>
        <span class="n">MergeNodes</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">EdgeToNode</span><span class="p">[</span><span class="n">ee</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">Cnodes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">symmetric_difference</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">Cnodes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]))):</span>
            <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">MergeNodes</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">EdgeToNode</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="k">pass</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">Cnodes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">Cnodes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]))):</span>
            <span class="n">EdgeToNode</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">=</span><span class="p">[]</span>

        <span class="c1"># calculate the calculation effort</span>
        <span class="n">CalculationEffort</span><span class="o">=</span><span class="n">CalculationEffort</span><span class="o">+</span><span class="mi">2</span><span class="o">**</span><span class="nb">len</span><span class="p">(</span><span class="n">NodeTix</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">NodeTix</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">CalculationEffort</span><span class="p">)</span>

        <span class="c1"># determine if the output is a tensor or scalar</span>
        <span class="c1"># then call the correct function</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Toutix</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">Tout</span><span class="o">=</span><span class="n">CoreLoopScalar</span><span class="p">(</span><span class="n">Cnodes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">T1ix</span><span class="p">,</span><span class="n">Cnodes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">T2ix</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Tout</span><span class="o">=</span><span class="n">CoreLoop</span><span class="p">(</span><span class="n">Cnodes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">T1ix</span><span class="p">,</span><span class="n">Cnodes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">T2ix</span><span class="p">,</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Toutix</span><span class="p">))</span>

        <span class="c1"># convert the computational basis indices into real indices</span>
        <span class="k">for</span> <span class="n">loc</span><span class="p">,</span><span class="n">ix</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">Toutix</span><span class="p">)):</span>
            <span class="n">Toutix</span><span class="p">[</span><span class="n">loc</span><span class="p">]</span><span class="o">=</span><span class="n">ixTnode</span><span class="p">[</span><span class="n">Toutix</span><span class="p">[</span><span class="n">loc</span><span class="p">]]</span>
        <span class="n">Nodes</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">Tout</span><span class="p">,</span><span class="n">Toutix</span><span class="p">))</span>

        <span class="c1"># add the new tensor on the list of tensors that can be contracted</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">Nodes</span><span class="p">[</span><span class="n">NodeToEdgeix</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">e</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">EdgeToNode</span><span class="p">:</span>
                <span class="n">EdgeToNode</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">=</span><span class="p">[]</span>
            <span class="n">EdgeToNode</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">NodeToEdgeix</span><span class="p">)</span>

        <span class="n">NodeToEdgeix</span><span class="o">=</span><span class="n">NodeToEdgeix</span><span class="o">+</span><span class="mi">1</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CalculationEffort&#39;</span><span class="p">,</span><span class="n">CalculationEffort</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Tout</span><span class="p">,</span><span class="n">CalculationEffort</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="c1">### Generate Grids</span>
    <span class="n">NN</span><span class="o">=</span><span class="mi">3</span>

    <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span>
        <span class="n">TT</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">k</span><span class="p">)</span>
        <span class="n">TT</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">T</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">TT</span><span class="p">)</span>

    <span class="n">Nodes</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">k1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">NN</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">k2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">NN</span><span class="p">):</span>
            <span class="n">ix</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">ix</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">k1</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">NN</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">k2</span>
            <span class="n">ix</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">k1</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">NN</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">k2</span><span class="o">-</span><span class="mi">1</span>
            <span class="n">ix</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="n">k1</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">NN</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">k2</span><span class="o">+</span><span class="n">NN</span><span class="o">-</span><span class="mi">1</span>
            <span class="n">ix</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">=</span><span class="n">k1</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">NN</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">k2</span><span class="o">-</span><span class="n">NN</span>
            <span class="k">if</span> <span class="n">k2</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">ix</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">k1</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">NN</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">k2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">k2</span><span class="o">==</span><span class="n">NN</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">ix</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">k1</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">NN</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">k2</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">k1</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">ix</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">k1</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">NN</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">k2</span><span class="o">-</span><span class="n">NN</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">k1</span><span class="o">==</span><span class="n">NN</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">ix</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">k1</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">NN</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">k2</span><span class="o">+</span><span class="n">NN</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">Nodes</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">T</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">ix</span><span class="p">)],</span><span class="nb">tuple</span><span class="p">(</span><span class="n">ix</span><span class="p">)))</span>

    <span class="n">EdgeOrder</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,(</span><span class="n">NN</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">NN</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">Nodes</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">EdgeOrder</span><span class="p">)</span>
    <span class="c1"># input()</span>
    <span class="n">t</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">Tout</span><span class="p">,</span><span class="n">CalculationEffort</span><span class="o">=</span><span class="n">Main</span><span class="p">(</span><span class="n">Nodes</span><span class="p">,</span><span class="n">EdgeOrder</span><span class="p">,</span><span class="mf">.5</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">Tout</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>

    <span class="n">T</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span>
        <span class="n">TT</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">k</span><span class="p">)</span>
        <span class="n">TT</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">T</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">TT</span><span class="p">)</span>

    <span class="n">Nodes</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">Nodes</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
    <span class="n">Nodes</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
    <span class="n">Nodes</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],(</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">)))</span>
    <span class="n">Nodes</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],(</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">)))</span>
    <span class="n">Nodes</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">],(</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">)))</span>
    <span class="n">Nodes</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],(</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">10</span><span class="p">)))</span>
    <span class="n">Nodes</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],(</span><span class="mi">8</span><span class="p">,</span><span class="mi">11</span><span class="p">)))</span>
    <span class="n">Nodes</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],(</span><span class="mi">11</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">12</span><span class="p">)))</span>
    <span class="n">Nodes</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],(</span><span class="mi">12</span><span class="p">,</span><span class="mi">10</span><span class="p">)))</span>

    <span class="n">Main</span><span class="p">(</span><span class="n">Nodes</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">13</span><span class="p">)))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
    <span class="n">T1</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
    <span class="n">T2</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
    <span class="n">T1ix</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">T2ix</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
    <span class="c1"># Toutix=(0,2)</span>
    <span class="c1"># CoreLoop(T1,T1ix,T2,T2ix,Toutix)</span>
    <span class="n">Nodes</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">Nodes</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">T1</span><span class="p">,</span><span class="n">T1ix</span><span class="p">))</span>
    <span class="n">Nodes</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">T2</span><span class="p">,</span><span class="n">T2ix</span><span class="p">))</span>
    <span class="n">Main</span><span class="p">(</span><span class="n">Nodes</span><span class="p">,[</span><span class="mi">4</span><span class="p">])</span>




    <span class="c1"># sys.exit()</span>
</pre></div>

        </details>

            <div class="docstring"><p>This module contains functions to perform miscellaneous tasks on cubic graphs. Mostly for generating uniform connected random cubic graphs.</p>

<h6 id="functions">Functions</h6>

<p><strong>Main(Nodes,EdgeOrder,pf=.5,verbose=True) :</strong> <br />
    Main function called by user to calculate the tensor network contraction defined by the list of Nodes (tensors and their indices).</p>

<p><strong>CoreLoop(T1,T1ix,T2,T2ix,Toutix) :</strong> <br />
    Performs the tensor contraction.</p>

<p><strong>CoreLoopScalar(T1,T1ix,T2,T2ix) :</strong> <br />
    Performs the final tensor contraction down to a scalar.</p>

<h6 id="notes">Notes</h6>

<p>When the tensor network contraction is first executed, numba performs jit compilation. This causes the first execution to take several seconds to run, but the compilation is cached and future runs with different inputs do not need to recompile.</p>

<p>While the tensor network contraction for Source-Terminal reliability is discussed in the ICOSSAR 2021 paper and has an exact solution for directed acyclic networks, it is not implemented in this module.
Proof-of-concept code has been written to verify the S-T tensor construction.</p>
</div>


                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.type) {
                    case "function":
                        heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span><span class="signature">(${doc.parameters.join(", ")})</span>`;
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.type}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>